{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { merge, extend, isNullOrUndefined, setValue, getValue } from '@syncfusion/ej2-base';\nimport { DataUtil } from './util';\nimport { Query, Predicate } from './query';\nvar consts = {\n  GroupGuid: '{271bbba0-1ee7}'\n};\n/**\n * Adaptors are specific data source type aware interfaces that are used by DataManager to communicate with DataSource.\n * This is the base adaptor class that other adaptors can extend.\n * @hidden\n */\n\nvar Adaptor =\n/** @class */\nfunction () {\n  /**\n   * Constructor for Adaptor class\n   * @param  {DataOptions} ds?\n   * @hidden\n   * @returns aggregates\n   */\n  function Adaptor(ds) {\n    // common options for all the adaptors \n    this.options = {\n      from: 'table',\n      requestType: 'json',\n      sortBy: 'sorted',\n      select: 'select',\n      skip: 'skip',\n      group: 'group',\n      take: 'take',\n      search: 'search',\n      count: 'requiresCounts',\n      where: 'where',\n      aggregates: 'aggregates',\n      expand: 'expand'\n    };\n    /**\n     * Specifies the type of adaptor.\n     * @default Adaptor\n     */\n\n    this.type = Adaptor;\n    this.dataSource = ds;\n    this.pvt = {};\n  }\n  /**\n   * Returns the data from the query processing.\n   * @param  {Object} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @returns Object\n   */\n\n\n  Adaptor.prototype.processResponse = function (data, ds, query, xhr) {\n    return data;\n  };\n\n  return Adaptor;\n}();\n\nexport { Adaptor };\n/**\n * JsonAdaptor is used to process JSON data. It contains methods to process the given JSON data based on the queries.\n * @hidden\n */\n\nvar JsonAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(JsonAdaptor, _super);\n\n  function JsonAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Process the JSON data based on the provided queries.\n   * @param  {DataManager} dataManager\n   * @param  {Query} query\n   * @returns Object\n   */\n\n\n  JsonAdaptor.prototype.processQuery = function (dataManager, query) {\n    var result = dataManager.dataSource.json.slice(0);\n    var count = result.length;\n    var countFlg = true;\n    var ret;\n    var key;\n    var lazyLoad = {};\n    var keyCount = 0;\n    var group = [];\n    var page;\n\n    for (var i = 0; i < query.lazyLoad.length; i++) {\n      keyCount++;\n      lazyLoad[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n    }\n\n    var agg = {};\n\n    for (var i = 0; i < query.queries.length; i++) {\n      key = query.queries[i];\n\n      if ((key.fn === 'onPage' || key.fn === 'onGroup') && query.lazyLoad.length) {\n        if (key.fn === 'onGroup') {\n          group.push(key.e);\n        }\n\n        if (key.fn === 'onPage') {\n          page = key.e;\n        }\n\n        continue;\n      }\n\n      ret = this[key.fn].call(this, result, key.e, query);\n\n      if (key.fn === 'onAggregates') {\n        agg[key.e.field + ' - ' + key.e.type] = ret;\n      } else {\n        result = ret !== undefined ? ret : result;\n      }\n\n      if (key.fn === 'onPage' || key.fn === 'onSkip' || key.fn === 'onTake' || key.fn === 'onRange') {\n        countFlg = false;\n      }\n\n      if (countFlg) {\n        count = result.length;\n      }\n    }\n\n    if (keyCount) {\n      var args = {\n        query: query,\n        lazyLoad: lazyLoad,\n        result: result,\n        group: group,\n        page: page\n      };\n      var lazyLoadData = this.lazyLoadGroup(args);\n      result = lazyLoadData.result;\n      count = lazyLoadData.count;\n    }\n\n    if (query.isCountRequired) {\n      result = {\n        result: result,\n        count: count,\n        aggregates: agg\n      };\n    }\n\n    return result;\n  };\n  /**\n   * Perform lazy load grouping in JSON array based on the given query and lazy load details.\n   * @param  {LazyLoadGroupArgs} args\n   */\n\n\n  JsonAdaptor.prototype.lazyLoadGroup = function (args) {\n    var count = 0;\n    var agg = this.getAggregate(args.query);\n    var result = args.result;\n\n    if (!isNullOrUndefined(args.lazyLoad.onDemandGroupInfo)) {\n      var req = args.lazyLoad.onDemandGroupInfo;\n\n      for (var i = req.where.length - 1; i >= 0; i--) {\n        result = this.onWhere(result, req.where[i]);\n      }\n\n      if (args.group.length !== req.level) {\n        var field = args.group[req.level].fieldName;\n        result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n      }\n\n      count = result.length;\n      var data = result;\n      result = result.slice(req.skip);\n      result = result.slice(0, req.take);\n\n      if (args.group.length !== req.level) {\n        this.formGroupResult(result, data);\n      }\n    } else {\n      var field = args.group[0].fieldName;\n      result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n      count = result.length;\n      var data = result;\n\n      if (args.page) {\n        result = this.onPage(result, args.page, args.query);\n      }\n\n      this.formGroupResult(result, data);\n    }\n\n    return {\n      result: result,\n      count: count\n    };\n  };\n\n  JsonAdaptor.prototype.formGroupResult = function (result, data) {\n    if (result.length && data.length) {\n      var uid = 'GroupGuid';\n      var childLevel = 'childLevels';\n      var level = 'level';\n      var records = 'records';\n      result[uid] = data[uid];\n      result[childLevel] = data[childLevel];\n      result[level] = data[level];\n      result[records] = data[records];\n    }\n\n    return result;\n  };\n  /**\n   * Separate the aggregate query from the given queries\n   * @param  {Query} query\n   */\n\n\n  JsonAdaptor.prototype.getAggregate = function (query) {\n    var aggQuery = Query.filterQueries(query.queries, 'onAggregates');\n    var agg = [];\n\n    if (aggQuery.length) {\n      var tmp = void 0;\n\n      for (var i = 0; i < aggQuery.length; i++) {\n        tmp = aggQuery[i].e;\n        agg.push({\n          type: tmp.type,\n          field: DataUtil.getValue(tmp.field, query)\n        });\n      }\n    }\n\n    return agg;\n  };\n  /**\n   * Performs batch update in the JSON array which add, remove and update records.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   */\n\n\n  JsonAdaptor.prototype.batchRequest = function (dm, changes, e) {\n    var i;\n    var deletedRecordsLen = changes.deletedRecords.length;\n\n    for (i = 0; i < changes.addedRecords.length; i++) {\n      this.insert(dm, changes.addedRecords[i]);\n    }\n\n    for (i = 0; i < changes.changedRecords.length; i++) {\n      this.update(dm, e.key, changes.changedRecords[i]);\n    }\n\n    for (i = 0; i < deletedRecordsLen; i++) {\n      this.remove(dm, e.key, changes.deletedRecords[i]);\n    }\n\n    return changes;\n  };\n  /**\n   * Performs filter operation with the given data and where query.\n   * @param  {Object[]} ds\n   * @param  {{validate:Function}} e\n   */\n\n\n  JsonAdaptor.prototype.onWhere = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.filter(function (obj) {\n      if (e) {\n        return e.validate(obj);\n      }\n    });\n  };\n  /**\n   * Returns aggregate function based on the aggregate type.\n   * @param  {Object[]} ds\n   * @param  {{field:string} e\n   * @param  {string}} type\n   */\n\n\n  JsonAdaptor.prototype.onAggregates = function (ds, e) {\n    var fn = DataUtil.aggregates[e.type];\n\n    if (!ds || !fn || ds.length === 0) {\n      return null;\n    }\n\n    return fn(ds, e.field);\n  };\n  /**\n   * Performs search operation based on the given query.\n   * @param  {Object[]} ds\n   * @param  {QueryOptions} e\n   */\n\n\n  JsonAdaptor.prototype.onSearch = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    if (e.fieldNames.length === 0) {\n      DataUtil.getFieldList(ds[0], e.fieldNames);\n    }\n\n    return ds.filter(function (obj) {\n      for (var j = 0; j < e.fieldNames.length; j++) {\n        if (e.comparer.call(obj, DataUtil.getObject(e.fieldNames[j], obj), e.searchKey, e.ignoreCase, e.ignoreAccent)) {\n          return true;\n        }\n      }\n\n      return false;\n    });\n  };\n  /**\n   * Sort the data with given direction and field.\n   * @param  {Object[]} ds\n   * @param  {{comparer:(a:Object} e\n   * @param  {Object} b\n   */\n\n\n  JsonAdaptor.prototype.onSortBy = function (ds, e, query) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    var fnCompare;\n    var field = DataUtil.getValue(e.fieldName, query);\n\n    if (!field) {\n      return ds.sort(e.comparer);\n    }\n\n    if (field instanceof Array) {\n      field = field.slice(0);\n\n      for (var i = field.length - 1; i >= 0; i--) {\n        if (!field[i]) {\n          continue;\n        }\n\n        fnCompare = e.comparer;\n\n        if (DataUtil.endsWith(field[i], ' desc')) {\n          fnCompare = DataUtil.fnSort('descending');\n          field[i] = field[i].replace(' desc', '');\n        }\n\n        ds = DataUtil.sort(ds, field[i], fnCompare);\n      }\n\n      return ds;\n    }\n\n    return DataUtil.sort(ds, field, e.comparer);\n  };\n  /**\n   * Group the data based on the given query.\n   * @param  {Object[]} ds\n   * @param  {QueryOptions} e\n   * @param  {Query} query\n   */\n\n\n  JsonAdaptor.prototype.onGroup = function (ds, e, query) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    var agg = this.getAggregate(query);\n    return DataUtil.group(ds, DataUtil.getValue(e.fieldName, query), agg, null, null, e.comparer);\n  };\n  /**\n   * Retrieves records based on the given page index and size.\n   * @param  {Object[]} ds\n   * @param  {{pageSize:number} e\n   * @param  {number}} pageIndex\n   * @param  {Query} query\n   */\n\n\n  JsonAdaptor.prototype.onPage = function (ds, e, query) {\n    var size = DataUtil.getValue(e.pageSize, query);\n    var start = (DataUtil.getValue(e.pageIndex, query) - 1) * size;\n    var end = start + size;\n\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(start, end);\n  };\n  /**\n   * Retrieves records based on the given start and end index from query.\n   * @param  {Object[]} ds\n   * @param  {{start:number} e\n   * @param  {number}} end\n   */\n\n\n  JsonAdaptor.prototype.onRange = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(DataUtil.getValue(e.start), DataUtil.getValue(e.end));\n  };\n  /**\n   * Picks the given count of records from the top of the datasource.\n   * @param  {Object[]} ds\n   * @param  {{nos:number}} e\n   */\n\n\n  JsonAdaptor.prototype.onTake = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(0, DataUtil.getValue(e.nos));\n  };\n  /**\n   * Skips the given count of records from the data source.\n   * @param  {Object[]} ds\n   * @param  {{nos:number}} e\n   */\n\n\n  JsonAdaptor.prototype.onSkip = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(DataUtil.getValue(e.nos));\n  };\n  /**\n   * Selects specified columns from the data source.\n   * @param  {Object[]} ds\n   * @param  {{fieldNames:string}} e\n   */\n\n\n  JsonAdaptor.prototype.onSelect = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return DataUtil.select(ds, DataUtil.getValue(e.fieldNames));\n  };\n  /**\n   * Inserts new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {number} position\n   */\n\n\n  JsonAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n    if (isNullOrUndefined(position)) {\n      return dm.dataSource.json.push(data);\n    } else {\n      return dm.dataSource.json.splice(position, 0, data);\n    }\n  };\n  /**\n   * Remove the data from the dataSource based on the key field value.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   * @returns null\n   */\n\n\n  JsonAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    var ds = dm.dataSource.json;\n    var i;\n\n    if (typeof value === 'object' && !(value instanceof Date)) {\n      value = DataUtil.getObject(keyField, value);\n    }\n\n    for (i = 0; i < ds.length; i++) {\n      if (DataUtil.getObject(keyField, ds[i]) === value) {\n        break;\n      }\n    }\n\n    return i !== ds.length ? ds.splice(i, 1) : null;\n  };\n  /**\n   * Updates existing record and saves the changes to the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   * @returns null\n   */\n\n\n  JsonAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n    var ds = dm.dataSource.json;\n    var i;\n    var key;\n\n    if (!isNullOrUndefined(keyField)) {\n      key = getValue(keyField, value);\n    }\n\n    for (i = 0; i < ds.length; i++) {\n      if (!isNullOrUndefined(keyField) && getValue(keyField, ds[i]) === key) {\n        break;\n      }\n    }\n\n    return i < ds.length ? merge(ds[i], value) : null;\n  };\n\n  return JsonAdaptor;\n}(Adaptor);\n\nexport { JsonAdaptor };\n/**\n * URL Adaptor of DataManager can be used when you are required to use remote service to retrieve data.\n * It interacts with server-side for all DataManager Queries and CRUD operations.\n * @hidden\n */\n\nvar UrlAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(UrlAdaptor, _super);\n\n  function UrlAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Process the query to generate request body.\n   * @param  {DataManager} dm\n   * @param  {Query} query\n   * @param  {Object[]} hierarchyFilters?\n   * @returns p\n   */\n  // tslint:disable-next-line:max-func-body-length\n\n\n  UrlAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n    var queries = this.getQueryRequest(query);\n    var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n    var params = query.params;\n    var url = dm.dataSource.url;\n    var temp;\n    var skip;\n    var take = null;\n    var options = this.options;\n    var request = {\n      sorts: [],\n      groups: [],\n      filters: [],\n      searches: [],\n      aggregates: []\n    }; // calc Paging & Range\n\n    if ('onPage' in singles) {\n      temp = singles.onPage;\n      skip = DataUtil.getValue(temp.pageIndex, query);\n      take = DataUtil.getValue(temp.pageSize, query);\n      skip = (skip - 1) * take;\n    } else if ('onRange' in singles) {\n      temp = singles.onRange;\n      skip = temp.start;\n      take = temp.end - temp.start;\n    } // Sorting\n\n\n    for (var i = 0; i < queries.sorts.length; i++) {\n      temp = DataUtil.getValue(queries.sorts[i].e.fieldName, query);\n      request.sorts.push(DataUtil.callAdaptorFunction(this, 'onEachSort', {\n        name: temp,\n        direction: queries.sorts[i].e.direction\n      }, query));\n    } // hierarchy\n\n\n    if (hierarchyFilters) {\n      temp = this.getFiltersFrom(hierarchyFilters, query);\n\n      if (temp) {\n        request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', temp.toJson(), query));\n      }\n    } // Filters\n\n\n    for (var i = 0; i < queries.filters.length; i++) {\n      request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', queries.filters[i].e.toJson(), query));\n      var keys_3 = typeof request.filters[i] === 'object' ? Object.keys(request.filters[i]) : [];\n\n      for (var _i = 0, keys_1 = keys_3; _i < keys_1.length; _i++) {\n        var prop = keys_1[_i];\n\n        if (DataUtil.isNull(request[prop])) {\n          delete request[prop];\n        }\n      }\n    } // Searches\n\n\n    for (var i = 0; i < queries.searches.length; i++) {\n      temp = queries.searches[i].e;\n      request.searches.push(DataUtil.callAdaptorFunction(this, 'onEachSearch', {\n        fields: temp.fieldNames,\n        operator: temp.operator,\n        key: temp.searchKey,\n        ignoreCase: temp.ignoreCase\n      }, query));\n    } // Grouping\n\n\n    for (var i = 0; i < queries.groups.length; i++) {\n      request.groups.push(DataUtil.getValue(queries.groups[i].e.fieldName, query));\n    } // aggregates\n\n\n    for (var i = 0; i < queries.aggregates.length; i++) {\n      temp = queries.aggregates[i].e;\n      request.aggregates.push({\n        type: temp.type,\n        field: DataUtil.getValue(temp.field, query)\n      });\n    }\n\n    var req = {};\n    this.getRequestQuery(options, query, singles, request, req); // Params\n\n    DataUtil.callAdaptorFunction(this, 'addParams', {\n      dm: dm,\n      query: query,\n      params: params,\n      reqParams: req\n    });\n\n    if (query.lazyLoad.length) {\n      for (var i = 0; i < query.lazyLoad.length; i++) {\n        req[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n      }\n    } // cleanup\n\n\n    var keys = Object.keys(req);\n\n    for (var _a = 0, keys_2 = keys; _a < keys_2.length; _a++) {\n      var prop = keys_2[_a];\n\n      if (DataUtil.isNull(req[prop]) || req[prop] === '' || req[prop].length === 0) {\n        delete req[prop];\n      }\n    }\n\n    if (!(options.skip in req && options.take in req) && take !== null) {\n      req[options.skip] = DataUtil.callAdaptorFunction(this, 'onSkip', skip, query);\n      req[options.take] = DataUtil.callAdaptorFunction(this, 'onTake', take, query);\n    }\n\n    var p = this.pvt;\n    this.pvt = {};\n\n    if (this.options.requestType === 'json') {\n      return {\n        data: JSON.stringify(req, DataUtil.parse.jsonDateReplacer),\n        url: url,\n        pvtData: p,\n        type: 'POST',\n        contentType: 'application/json; charset=utf-8'\n      };\n    }\n\n    temp = this.convertToQueryString(req, query, dm);\n    temp = (dm.dataSource.url.indexOf('?') !== -1 ? '&' : '/') + temp;\n    return {\n      type: 'GET',\n      url: temp.length ? url.replace(/\\/*$/, temp) : url,\n      pvtData: p\n    };\n  };\n\n  UrlAdaptor.prototype.getRequestQuery = function (options, query, singles, request, request1) {\n    var param = 'param';\n    var req = request1;\n    req[options.from] = query.fromTable;\n\n    if (options.apply && query.distincts.length) {\n      req[options.apply] = 'onDistinct' in this ? DataUtil.callAdaptorFunction(this, 'onDistinct', query.distincts) : '';\n    }\n\n    if (!query.distincts.length && options.expand) {\n      req[options.expand] = 'onExpand' in this && 'onSelect' in singles ? DataUtil.callAdaptorFunction(this, 'onExpand', {\n        selects: DataUtil.getValue(singles.onSelect.fieldNames, query),\n        expands: query.expands\n      }, query) : query.expands;\n    }\n\n    req[options.select] = 'onSelect' in singles && !query.distincts.length ? DataUtil.callAdaptorFunction(this, 'onSelect', DataUtil.getValue(singles.onSelect.fieldNames, query), query) : '';\n    req[options.count] = query.isCountRequired ? DataUtil.callAdaptorFunction(this, 'onCount', query.isCountRequired, query) : '';\n    req[options.search] = request.searches.length ? DataUtil.callAdaptorFunction(this, 'onSearch', request.searches, query) : '';\n    req[options.skip] = 'onSkip' in singles ? DataUtil.callAdaptorFunction(this, 'onSkip', DataUtil.getValue(singles.onSkip.nos, query), query) : '';\n    req[options.take] = 'onTake' in singles ? DataUtil.callAdaptorFunction(this, 'onTake', DataUtil.getValue(singles.onTake.nos, query), query) : '';\n    req[options.where] = request.filters.length || request.searches.length ? DataUtil.callAdaptorFunction(this, 'onWhere', request.filters, query) : '';\n    req[options.sortBy] = request.sorts.length ? DataUtil.callAdaptorFunction(this, 'onSortBy', request.sorts, query) : '';\n    req[options.group] = request.groups.length ? DataUtil.callAdaptorFunction(this, 'onGroup', request.groups, query) : '';\n    req[options.aggregates] = request.aggregates.length ? DataUtil.callAdaptorFunction(this, 'onAggregates', request.aggregates, query) : '';\n    req[param] = [];\n  };\n  /**\n   * Convert the object from processQuery to string which can be added query string.\n   * @param  {Object} req\n   * @param  {Query} query\n   * @param  {DataManager} dm\n   */\n\n\n  UrlAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n    return ''; // this needs to be overridden\n  };\n  /**\n   * Return the data from the data manager processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Object} request?\n   * @param  {CrudOptions} changes?\n   */\n\n\n  UrlAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('application/json') !== -1) {\n      var handleTimeZone = DataUtil.timeZoneHandling;\n\n      if (ds && !ds.timeZoneHandling) {\n        DataUtil.timeZoneHandling = false;\n      }\n\n      data = DataUtil.parse.parseJson(data);\n      DataUtil.timeZoneHandling = handleTimeZone;\n    }\n\n    var requests = request;\n    var pvt = requests.pvtData || {};\n    var groupDs = data ? data.groupDs : [];\n\n    if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n      return query.isCountRequired ? {\n        result: [],\n        count: 0\n      } : [];\n    }\n\n    var d = JSON.parse(requests.data);\n\n    if (d && d.action === 'batch' && data && data.addedRecords) {\n      changes.addedRecords = data.addedRecords;\n      return changes;\n    }\n\n    if (data && data.d) {\n      data = data.d;\n    }\n\n    var args = {};\n\n    if (data && 'count' in data) {\n      args.count = data.count;\n    }\n\n    args.result = data && data.result ? data.result : data;\n    var isExpand = false;\n\n    if (Array.isArray(data.result) && data.result.length) {\n      var key = 'key';\n      var val = 'value';\n      var level = 'level';\n\n      if (!isNullOrUndefined(data.result[0][key])) {\n        args.result = this.formRemoteGroupedData(args.result, 1, pvt.groups.length - 1);\n      }\n\n      if (query && query.lazyLoad.length && pvt.groups.length) {\n        for (var i = 0; i < query.lazyLoad.length; i++) {\n          if (query.lazyLoad[i][key] === 'onDemandGroupInfo') {\n            var value = query.lazyLoad[i][val][level];\n\n            if (pvt.groups.length === value) {\n              isExpand = true;\n            }\n          }\n        }\n      }\n    }\n\n    if (!isExpand) {\n      this.getAggregateResult(pvt, data, args, groupDs, query);\n    }\n\n    return DataUtil.isNull(args.count) ? args.result : {\n      result: args.result,\n      count: args.count,\n      aggregates: args.aggregates\n    };\n  };\n\n  UrlAdaptor.prototype.formRemoteGroupedData = function (data, level, childLevel) {\n    for (var i = 0; i < data.length; i++) {\n      if (data[i].items.length && Object.keys(data[i].items[0]).indexOf('key') > -1) {\n        this.formRemoteGroupedData(data[i].items, level + 1, childLevel - 1);\n      }\n    }\n\n    var uid = 'GroupGuid';\n    var childLvl = 'childLevels';\n    var lvl = 'level';\n    var records = 'records';\n    data[uid] = consts[uid];\n    data[lvl] = level;\n    data[childLvl] = childLevel;\n    data[records] = data[0].items.length ? this.getGroupedRecords(data, !isNullOrUndefined(data[0].items[records])) : [];\n    return data;\n  };\n\n  UrlAdaptor.prototype.getGroupedRecords = function (data, hasRecords) {\n    var childGroupedRecords = [];\n    var records = 'records';\n\n    for (var i = 0; i < data.length; i++) {\n      if (!hasRecords) {\n        for (var j = 0; j < data[i].items.length; j++) {\n          childGroupedRecords.push(data[i].items[j]);\n        }\n      } else {\n        childGroupedRecords = childGroupedRecords.concat(data[i].items[records]);\n      }\n    }\n\n    return childGroupedRecords;\n  };\n  /**\n   * Add the group query to the adaptor`s option.\n   * @param  {Object[]} e\n   * @returns void\n   */\n\n\n  UrlAdaptor.prototype.onGroup = function (e) {\n    this.pvt.groups = e;\n    return e;\n  };\n  /**\n   * Add the aggregate query to the adaptor`s option.\n   * @param  {Aggregates[]} e\n   * @returns void\n   */\n\n\n  UrlAdaptor.prototype.onAggregates = function (e) {\n    this.pvt.aggregates = e;\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {Object} e\n   */\n\n\n  UrlAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n    var url;\n    var key;\n    return {\n      type: 'POST',\n      url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.removeUrl || dm.dataSource.url,\n      contentType: 'application/json; charset=utf-8',\n      dataType: 'json',\n      data: JSON.stringify(extend({}, {\n        changed: changes.changedRecords,\n        added: changes.addedRecords,\n        deleted: changes.deletedRecords,\n        action: 'batch',\n        table: e[url],\n        key: e[key]\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @returns void\n   */\n\n\n  UrlAdaptor.prototype.beforeSend = function (dm, request) {// need to extend this method\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName\n   */\n\n\n  UrlAdaptor.prototype.insert = function (dm, data, tableName, query) {\n    return {\n      url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: data,\n        table: tableName,\n        action: 'insert'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {number|string} value\n   * @param  {string} tableName\n   */\n\n\n  UrlAdaptor.prototype.remove = function (dm, keyField, value, tableName, query) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        key: value,\n        keyColumn: keyField,\n        table: tableName,\n        action: 'remove'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * Prepare and return request body which is used to update record.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName\n   */\n\n\n  UrlAdaptor.prototype.update = function (dm, keyField, value, tableName, query) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: value,\n        action: 'update',\n        keyColumn: keyField,\n        key: DataUtil.getObject(keyField, value),\n        table: tableName\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * To generate the predicate based on the filtered query.\n   * @param  {Object[]|string[]|number[]} data\n   * @param  {Query} query\n   * @hidden\n   */\n\n\n  UrlAdaptor.prototype.getFiltersFrom = function (data, query) {\n    var key = query.fKey;\n    var value;\n    var prop = key;\n    var pKey = query.key;\n    var predicats = [];\n\n    if (typeof data[0] !== 'object') {\n      prop = null;\n    }\n\n    for (var i = 0; i < data.length; i++) {\n      if (typeof data[0] === 'object') {\n        value = DataUtil.getObject(pKey || prop, data[i]);\n      } else {\n        value = data[i];\n      }\n\n      predicats.push(new Predicate(key, 'equal', value));\n    }\n\n    return Predicate.or(predicats);\n  };\n\n  UrlAdaptor.prototype.getAggregateResult = function (pvt, data, args, groupDs, query) {\n    var pData = data;\n\n    if (data && data.result) {\n      pData = data.result;\n    }\n\n    if (pvt && pvt.aggregates && pvt.aggregates.length) {\n      var agg = pvt.aggregates;\n      var fn = void 0;\n      var aggregateData = pData;\n      var res = {};\n\n      if (data.aggregate) {\n        aggregateData = data.aggregate;\n      }\n\n      for (var i = 0; i < agg.length; i++) {\n        fn = DataUtil.aggregates[agg[i].type];\n\n        if (fn) {\n          res[agg[i].field + ' - ' + agg[i].type] = fn(aggregateData, agg[i].field);\n        }\n      }\n\n      args.aggregates = res;\n    }\n\n    var key = 'key';\n    var isServerGrouping = Array.isArray(data.result) && data.result.length && !isNullOrUndefined(data.result[0][key]);\n\n    if (pvt && pvt.groups && pvt.groups.length && !isServerGrouping) {\n      var groups = pvt.groups;\n\n      for (var i = 0; i < groups.length; i++) {\n        var level = null;\n\n        if (!isNullOrUndefined(groupDs)) {\n          groupDs = DataUtil.group(groupDs, groups[i]);\n        }\n\n        var groupQuery = Query.filterQueries(query.queries, 'onGroup')[i].e;\n        pData = DataUtil.group(pData, groups[i], pvt.aggregates, level, groupDs, groupQuery.comparer);\n      }\n\n      args.result = pData;\n    }\n\n    return args;\n  };\n\n  UrlAdaptor.prototype.getQueryRequest = function (query) {\n    var req = {\n      sorts: [],\n      groups: [],\n      filters: [],\n      searches: [],\n      aggregates: []\n    };\n    req.sorts = Query.filterQueries(query.queries, 'onSortBy');\n    req.groups = Query.filterQueries(query.queries, 'onGroup');\n    req.filters = Query.filterQueries(query.queries, 'onWhere');\n    req.searches = Query.filterQueries(query.queries, 'onSearch');\n    req.aggregates = Query.filterQueries(query.queries, 'onAggregates');\n    return req;\n  };\n\n  UrlAdaptor.prototype.addParams = function (options) {\n    var req = options.reqParams;\n\n    if (options.params.length) {\n      req.params = {};\n    }\n\n    for (var _i = 0, _a = options.params; _i < _a.length; _i++) {\n      var tmp = _a[_i];\n\n      if (req[tmp.key]) {\n        throw new Error('Query() - addParams: Custom Param is conflicting other request arguments');\n      }\n\n      req[tmp.key] = tmp.value;\n\n      if (tmp.fn) {\n        req[tmp.key] = tmp.fn.call(options.query, tmp.key, options.query, options.dm);\n      }\n\n      req.params[tmp.key] = req[tmp.key];\n    }\n  };\n\n  return UrlAdaptor;\n}(Adaptor);\n\nexport { UrlAdaptor };\n/**\n * OData Adaptor that is extended from URL Adaptor, is used for consuming data through OData Service.\n * @hidden\n */\n\nvar ODataAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(ODataAdaptor, _super);\n\n  function ODataAdaptor(props) {\n    var _this = _super.call(this) || this; // options replaced the default adaptor options\n\n\n    _this.options = extend({}, _this.options, {\n      requestType: 'get',\n      accept: 'application/json;odata=light;q=1,application/json;odata=verbose;q=0.5',\n      multipartAccept: 'multipart/mixed',\n      sortBy: '$orderby',\n      select: '$select',\n      skip: '$skip',\n      take: '$top',\n      count: '$inlinecount',\n      where: '$filter',\n      expand: '$expand',\n      batch: '$batch',\n      changeSet: '--changeset_',\n      batchPre: 'batch_',\n      contentId: 'Content-Id: ',\n      batchContent: 'Content-Type: multipart/mixed; boundary=',\n      changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n      batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n      updateType: 'PUT'\n    });\n    extend(_this.options, props || {});\n    return _this;\n  }\n\n  ODataAdaptor.prototype.getModuleName = function () {\n    return 'ODataAdaptor';\n  };\n  /**\n   * Generate request string based on the filter criteria from query.\n   * @param  {Predicate} pred\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataAdaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n    var returnValue = '';\n    var operator;\n    var guid;\n    var val = predicate.value;\n    var type = typeof val;\n    var field = predicate.field ? ODataAdaptor.getField(predicate.field) : null;\n\n    if (val instanceof Date) {\n      val = 'datetime\\'' + DataUtil.parse.replacer(val) + '\\'';\n    }\n\n    if (type === 'string') {\n      val = encodeURIComponent(val);\n      val = '\\'' + val + '\\'';\n\n      if (requiresCast) {\n        field = 'cast(' + field + ', \\'Edm.String\\')';\n      }\n\n      if (DataUtil.parse.isGuid(val)) {\n        guid = 'guid';\n      }\n\n      if (predicate.ignoreCase) {\n        if (!guid) {\n          field = 'tolower(' + field + ')';\n        }\n\n        val = val.toLowerCase();\n      }\n    }\n\n    operator = DataUtil.odBiOperator[predicate.operator];\n\n    if (operator) {\n      returnValue += field;\n      returnValue += operator;\n\n      if (guid) {\n        returnValue += guid;\n      }\n\n      return returnValue + val;\n    }\n\n    if (!isNullOrUndefined(this.getModuleName) && this.getModuleName() === 'ODataV4Adaptor') {\n      operator = DataUtil.odv4UniOperator[predicate.operator];\n    } else {\n      operator = DataUtil.odUniOperator[predicate.operator];\n    }\n\n    if (operator === 'substringof') {\n      var temp = val;\n      val = field;\n      field = temp;\n    }\n\n    returnValue += operator + '(';\n    returnValue += field + ',';\n\n    if (guid) {\n      returnValue += guid;\n    }\n\n    returnValue += val + ')';\n    return returnValue;\n  };\n\n  ODataAdaptor.prototype.addParams = function (options) {\n    _super.prototype.addParams.call(this, options);\n\n    delete options.reqParams.params;\n  };\n  /**\n   * Generate request string based on the multiple filter criteria from query.\n   * @param  {Predicate} pred\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataAdaptor.prototype.onComplexPredicate = function (predicate, query, requiresCast) {\n    var res = [];\n\n    for (var i = 0; i < predicate.predicates.length; i++) {\n      res.push('(' + this.onEachWhere(predicate.predicates[i], query, requiresCast) + ')');\n    }\n\n    return res.join(' ' + predicate.condition + ' ');\n  };\n  /**\n   * Generate query string based on the multiple filter criteria from query.\n   * @param  {Predicate} filter\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataAdaptor.prototype.onEachWhere = function (filter, query, requiresCast) {\n    return filter.isComplex ? this.onComplexPredicate(filter, query, requiresCast) : this.onPredicate(filter, query, requiresCast);\n  };\n  /**\n   * Generate query string based on the multiple filter criteria from query.\n   * @param  {string[]} filters\n   */\n\n\n  ODataAdaptor.prototype.onWhere = function (filters) {\n    if (this.pvt.search) {\n      filters.push(this.onEachWhere(this.pvt.search, null, true));\n    }\n\n    return filters.join(' and ');\n  };\n  /**\n   * Generate query string based on the multiple search criteria from query.\n   * @param  {{fields:string[]} e\n   * @param  {string} operator\n   * @param  {string} key\n   * @param  {boolean}} ignoreCase\n   */\n\n\n  ODataAdaptor.prototype.onEachSearch = function (e) {\n    if (e.fields && e.fields.length === 0) {\n      DataUtil.throwError('Query() - Search : oData search requires list of field names to search');\n    }\n\n    var filter = this.pvt.search || [];\n\n    for (var i = 0; i < e.fields.length; i++) {\n      filter.push(new Predicate(e.fields[i], e.operator, e.key, e.ignoreCase));\n    }\n\n    this.pvt.search = filter;\n  };\n  /**\n   * Generate query string based on the search criteria from query.\n   * @param  {Object} e\n   */\n\n\n  ODataAdaptor.prototype.onSearch = function (e) {\n    this.pvt.search = Predicate.or(this.pvt.search);\n    return '';\n  };\n  /**\n   * Generate query string based on multiple sort criteria from query.\n   * @param  {QueryOptions} e\n   */\n\n\n  ODataAdaptor.prototype.onEachSort = function (e) {\n    var res = [];\n\n    if (e.name instanceof Array) {\n      for (var i = 0; i < e.name.length; i++) {\n        res.push(ODataAdaptor.getField(e.name[i]) + (e.direction === 'descending' ? ' desc' : ''));\n      }\n    } else {\n      res.push(ODataAdaptor.getField(e.name) + (e.direction === 'descending' ? ' desc' : ''));\n    }\n\n    return res.join(',');\n  };\n  /**\n   * Returns sort query string.\n   * @param  {string[]} e\n   */\n\n\n  ODataAdaptor.prototype.onSortBy = function (e) {\n    return e.reverse().join(',');\n  };\n  /**\n   * Adds the group query to the adaptor option.\n   * @param  {Object[]} e\n   * @returns string\n   */\n\n\n  ODataAdaptor.prototype.onGroup = function (e) {\n    this.pvt.groups = e;\n    return [];\n  };\n  /**\n   * Returns the select query string.\n   * @param  {string[]} e\n   */\n\n\n  ODataAdaptor.prototype.onSelect = function (e) {\n    for (var i = 0; i < e.length; i++) {\n      e[i] = ODataAdaptor.getField(e[i]);\n    }\n\n    return e.join(',');\n  };\n  /**\n   * Add the aggregate query to the adaptor option.\n   * @param  {Object[]} e\n   * @returns string\n   */\n\n\n  ODataAdaptor.prototype.onAggregates = function (e) {\n    this.pvt.aggregates = e;\n    return '';\n  };\n  /**\n   * Returns the query string which requests total count from the data source.\n   * @param  {boolean} e\n   * @returns string\n   */\n\n\n  ODataAdaptor.prototype.onCount = function (e) {\n    return e === true ? 'allpages' : '';\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings?\n   */\n\n\n  ODataAdaptor.prototype.beforeSend = function (dm, request, settings) {\n    if (DataUtil.endsWith(settings.url, this.options.batch) && settings.type.toLowerCase() === 'post') {\n      request.setRequestHeader('Accept', this.options.multipartAccept);\n      request.setRequestHeader('DataServiceVersion', '2.0');\n      request.overrideMimeType('text/plain; charset=x-user-defined');\n    } else {\n      request.setRequestHeader('Accept', this.options.accept);\n    }\n\n    request.setRequestHeader('DataServiceVersion', '2.0');\n    request.setRequestHeader('MaxDataServiceVersion', '2.0');\n  };\n  /**\n   * Returns the data from the query processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   * @returns aggregateResult\n   */\n\n\n  ODataAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    var metaCheck = 'odata.metadata';\n\n    if (request && request.type === 'GET' && !this.rootUrl && data[metaCheck]) {\n      var dataUrls = data[metaCheck].split('/$metadata#');\n      this.rootUrl = dataUrls[0];\n      this.resourceTableName = dataUrls[1];\n    }\n\n    var pvtData = 'pvtData';\n\n    if (!isNullOrUndefined(data.d)) {\n      var dataCopy = query && query.isCountRequired ? data.d.results : data.d;\n      var metaData = '__metadata';\n\n      if (!isNullOrUndefined(dataCopy)) {\n        for (var i = 0; i < dataCopy.length; i++) {\n          if (!isNullOrUndefined(dataCopy[i][metaData])) {\n            delete dataCopy[i][metaData];\n          }\n        }\n      }\n    }\n\n    var pvt = request && request[pvtData];\n    var emptyAndBatch = this.processBatchResponse(data, query, xhr, request, changes);\n\n    if (emptyAndBatch) {\n      return emptyAndBatch;\n    }\n\n    var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n    var count = null;\n    var version = versionCheck && parseInt(versionCheck, 10) || 2;\n\n    if (query && query.isCountRequired) {\n      var oDataCount = '__count';\n\n      if (data[oDataCount] || data['odata.count']) {\n        count = data[oDataCount] || data['odata.count'];\n      }\n\n      if (data.d) {\n        data = data.d;\n      }\n\n      if (data[oDataCount] || data['odata.count']) {\n        count = data[oDataCount] || data['odata.count'];\n      }\n    }\n\n    if (version === 3 && data.value) {\n      data = data.value;\n    }\n\n    if (data.d) {\n      data = data.d;\n    }\n\n    if (version < 3 && data.results) {\n      data = data.results;\n    }\n\n    var args = {};\n    args.count = count;\n    args.result = data;\n    this.getAggregateResult(pvt, data, args, null, query);\n    return DataUtil.isNull(count) ? args.result : {\n      result: args.result,\n      count: args.count,\n      aggregates: args.aggregates\n    };\n  };\n  /**\n   * Converts the request object to query string.\n   * @param  {Object} req\n   * @param  {Query} query\n   * @param  {DataManager} dm\n   * @returns tableName\n   */\n\n\n  ODataAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n    var res = [];\n    var table = 'table';\n    var tableName = request[table] || '';\n    var format = '$format';\n    delete request[table];\n\n    if (dm.dataSource.requiresFormat) {\n      request[format] = 'json';\n    }\n\n    var keys = Object.keys(request);\n\n    for (var _i = 0, keys_4 = keys; _i < keys_4.length; _i++) {\n      var prop = keys_4[_i];\n      res.push(prop + '=' + request[prop]);\n    }\n\n    res = res.join('&');\n\n    if (dm.dataSource.url && dm.dataSource.url.indexOf('?') !== -1 && !tableName) {\n      return res;\n    }\n\n    return res.length ? tableName + '?' + res : tableName || '';\n  };\n\n  ODataAdaptor.prototype.localTimeReplacer = function (key, convertObj) {\n    for (var _i = 0, _a = !isNullOrUndefined(convertObj) ? Object.keys(convertObj) : []; _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      if (convertObj[prop] instanceof Date) {\n        convertObj[prop] = DataUtil.dateParse.toLocalTime(convertObj[prop]);\n      }\n    }\n\n    return convertObj;\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName?\n   */\n\n\n  ODataAdaptor.prototype.insert = function (dm, data, tableName) {\n    return {\n      url: (dm.dataSource.insertUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : ''),\n      data: JSON.stringify(data, this.options.localTime ? this.localTimeReplacer : null)\n    };\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {number} value\n   * @param  {string} tableName?\n   */\n\n\n  ODataAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    var url;\n\n    if (typeof value === 'string' && !DataUtil.parse.isGuid(value)) {\n      url = \"('\" + value + \"')\";\n    } else {\n      url = \"(\" + value + \")\";\n    }\n\n    return {\n      type: 'DELETE',\n      url: (dm.dataSource.removeUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url\n    };\n  };\n  /**\n   * Updates existing record and saves the changes to the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   * @returns this\n   */\n\n\n  ODataAdaptor.prototype.update = function (dm, keyField, value, tableName, query, original) {\n    if (this.options.updateType === 'PATCH' && !isNullOrUndefined(original)) {\n      value = this.compareAndRemove(value, original, keyField);\n    }\n\n    var url;\n\n    if (typeof value[keyField] === 'string' && !DataUtil.parse.isGuid(value[keyField])) {\n      url = \"('\" + value[keyField] + \"')\";\n    } else {\n      url = \"(\" + value[keyField] + \")\";\n    }\n\n    return {\n      type: this.options.updateType,\n      url: (dm.dataSource.updateUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url,\n      data: JSON.stringify(value, this.options.localTime ? this.localTimeReplacer : null),\n      accept: this.options.accept\n    };\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   * @returns {Object}\n   */\n\n\n  ODataAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n    var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n    var url = this.rootUrl ? this.rootUrl + '/' + this.options.batch : dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n    e.url = this.resourceTableName ? this.resourceTableName : e.url;\n    var args = {\n      url: e.url,\n      key: e.key,\n      cid: 1,\n      cSet: DataUtil.getGuid(this.options.changeSet)\n    };\n    var req = '--' + initialGuid + '\\n';\n    req += 'Content-Type: multipart/mixed; boundary=' + args.cSet.replace('--', '') + '\\n';\n    this.pvt.changeSet = 0;\n    req += this.generateInsertRequest(changes.addedRecords, args, dm);\n    req += this.generateUpdateRequest(changes.changedRecords, args, dm, original ? original.changedRecords : []);\n    req += this.generateDeleteRequest(changes.deletedRecords, args, dm);\n    req += args.cSet + '--\\n';\n    req += '--' + initialGuid + '--';\n    return {\n      type: 'POST',\n      url: url,\n      dataType: 'json',\n      contentType: 'multipart/mixed; charset=UTF-8;boundary=' + initialGuid,\n      data: req\n    };\n  };\n  /**\n   * Generate the string content from the removed records.\n   * The result will be send during batch update.\n   * @param  {Object[]} arr\n   * @param  {RemoteArgs} e\n   * @returns this\n   */\n\n\n  ODataAdaptor.prototype.generateDeleteRequest = function (arr, e, dm) {\n    if (!arr) {\n      return '';\n    }\n\n    var req = '';\n    var stat = {\n      'method': 'DELETE ',\n      'url': function (data, i, key) {\n        var url = DataUtil.getObject(key, data[i]);\n\n        if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n          return '(' + url + ')';\n        } else if (url instanceof Date) {\n          var dateTime = data[i][key];\n          return '(' + dateTime.toJSON() + ')';\n        } else {\n          return \"('\" + url + \"')\";\n        }\n      },\n      'data': function (data, i) {\n        return '';\n      }\n    };\n    req = this.generateBodyContent(arr, e, stat, dm);\n    return req + '\\n';\n  };\n  /**\n   * Generate the string content from the inserted records.\n   * The result will be send during batch update.\n   * @param  {Object[]} arr\n   * @param  {RemoteArgs} e\n   */\n\n\n  ODataAdaptor.prototype.generateInsertRequest = function (arr, e, dm) {\n    if (!arr) {\n      return '';\n    }\n\n    var req = '';\n    var stat = {\n      'method': 'POST ',\n      'url': function (data, i, key) {\n        return '';\n      },\n      'data': function (data, i) {\n        return JSON.stringify(data[i]) + '\\n\\n';\n      }\n    };\n    req = this.generateBodyContent(arr, e, stat, dm);\n    return req;\n  };\n  /**\n   * Generate the string content from the updated records.\n   * The result will be send during batch update.\n   * @param  {Object[]} arr\n   * @param  {RemoteArgs} e\n   */\n\n\n  ODataAdaptor.prototype.generateUpdateRequest = function (arr, e, dm, org) {\n    var _this = this;\n\n    if (!arr) {\n      return '';\n    }\n\n    var req = '';\n    arr.forEach(function (change) {\n      return change = _this.compareAndRemove(change, org.filter(function (o) {\n        return DataUtil.getObject(e.key, o) === DataUtil.getObject(e.key, change);\n      })[0], e.key);\n    });\n    var stat = {\n      'method': this.options.updateType + ' ',\n      'url': function (data, i, key) {\n        if (typeof data[i][key] === 'number' || DataUtil.parse.isGuid(data[i][key])) {\n          return '(' + data[i][key] + ')';\n        } else if (data[i][key] instanceof Date) {\n          var date = data[i][key];\n          return '(' + date.toJSON() + ')';\n        } else {\n          return \"('\" + data[i][key] + \"')\";\n        }\n      },\n      'data': function (data, i) {\n        return JSON.stringify(data[i]) + '\\n\\n';\n      }\n    };\n    req = this.generateBodyContent(arr, e, stat, dm);\n    return req;\n  };\n\n  ODataAdaptor.getField = function (prop) {\n    return prop.replace(/\\./g, '/');\n  };\n\n  ODataAdaptor.prototype.generateBodyContent = function (arr, e, stat, dm) {\n    var req = '';\n\n    for (var i = 0; i < arr.length; i++) {\n      req += '\\n' + e.cSet + '\\n';\n      req += this.options.changeSetContent + '\\n\\n';\n      req += stat.method;\n\n      if (stat.method === 'POST ') {\n        req += (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n      } else if (stat.method === 'PUT ' || stat.method === 'PATCH ') {\n        req += (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n      } else if (stat.method === 'DELETE ') {\n        req += (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n      }\n\n      req += 'Accept: ' + this.options.accept + '\\n';\n      req += 'Content-Id: ' + this.pvt.changeSet++ + '\\n';\n      req += this.options.batchChangeSetContentType + '\\n';\n\n      if (!isNullOrUndefined(arr[i]['@odata.etag'])) {\n        req += 'If-Match: ' + arr[i]['@odata.etag'] + '\\n\\n';\n        delete arr[i]['@odata.etag'];\n      } else {\n        req += '\\n';\n      }\n\n      req += stat.data(arr, i);\n    }\n\n    return req;\n  };\n\n  ODataAdaptor.prototype.processBatchResponse = function (data, query, xhr, request, changes) {\n    if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n      return query.isCountRequired ? {\n        result: [],\n        count: 0\n      } : [];\n    }\n\n    if (request && this.options.batch && DataUtil.endsWith(request.url, this.options.batch) && request.type.toLowerCase() === 'post') {\n      var guid = xhr.getResponseHeader('Content-Type');\n      var cIdx = void 0;\n      var jsonObj = void 0;\n      var d = data + '';\n      guid = guid.substring(guid.indexOf('=batchresponse') + 1);\n      d = d.split(guid);\n\n      if (d.length < 2) {\n        return {};\n      }\n\n      d = d[1];\n      var exVal = /(?:\\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(d);\n\n      if (exVal) {\n        d.replace(exVal[0], '');\n      }\n\n      var changeGuid = exVal ? exVal[1] : '';\n      d = d.split(changeGuid);\n\n      for (var i = d.length; i > -1; i--) {\n        if (!/\\bContent-ID:/i.test(d[i]) || !/\\bHTTP.+201/.test(d[i])) {\n          continue;\n        }\n\n        cIdx = parseInt(/\\bContent-ID: (\\d+)/i.exec(d[i])[1], 10);\n\n        if (changes.addedRecords[cIdx]) {\n          jsonObj = DataUtil.parse.parseJson(/^\\{.+\\}/m.exec(d[i])[0]);\n          extend({}, changes.addedRecords[cIdx], this.processResponse(jsonObj));\n        }\n      }\n\n      return changes;\n    }\n\n    return null;\n  };\n\n  ODataAdaptor.prototype.compareAndRemove = function (data, original, key) {\n    var _this = this;\n\n    if (isNullOrUndefined(original)) {\n      return data;\n    }\n\n    Object.keys(data).forEach(function (prop) {\n      if (prop !== key && prop !== '@odata.etag') {\n        if (DataUtil.isPlainObject(data[prop])) {\n          _this.compareAndRemove(data[prop], original[prop]);\n\n          var final = Object.keys(data[prop]).filter(function (data) {\n            return data !== '@odata.etag';\n          });\n\n          if (final.length === 0) {\n            delete data[prop];\n          }\n        } else if (data[prop] === original[prop]) {\n          delete data[prop];\n        } else if (data[prop] && original[prop] && data[prop].valueOf() === original[prop].valueOf()) {\n          delete data[prop];\n        }\n      }\n    });\n    return data;\n  };\n\n  return ODataAdaptor;\n}(UrlAdaptor);\n\nexport { ODataAdaptor };\n/**\n * The OData v4 is an improved version of OData protocols.\n * The DataManager uses the ODataV4Adaptor to consume OData v4 services.\n * @hidden\n */\n\nvar ODataV4Adaptor =\n/** @class */\nfunction (_super) {\n  __extends(ODataV4Adaptor, _super);\n\n  function ODataV4Adaptor(props) {\n    var _this = _super.call(this, props) || this; // options replaced the default adaptor options\n\n\n    _this.options = extend({}, _this.options, {\n      requestType: 'get',\n      accept: 'application/json, text/javascript, */*; q=0.01',\n      multipartAccept: 'multipart/mixed',\n      sortBy: '$orderby',\n      select: '$select',\n      skip: '$skip',\n      take: '$top',\n      count: '$count',\n      search: '$search',\n      where: '$filter',\n      expand: '$expand',\n      batch: '$batch',\n      changeSet: '--changeset_',\n      batchPre: 'batch_',\n      contentId: 'Content-Id: ',\n      batchContent: 'Content-Type: multipart/mixed; boundary=',\n      changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n      batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n      updateType: 'PATCH',\n      localTime: false,\n      apply: '$apply'\n    });\n    extend(_this.options, props || {});\n    return _this;\n  }\n  /**\n   * @hidden\n   */\n\n\n  ODataV4Adaptor.prototype.getModuleName = function () {\n    return 'ODataV4Adaptor';\n  };\n  /**\n   * Returns the query string which requests total count from the data source.\n   * @param  {boolean} e\n   * @returns string\n   */\n\n\n  ODataV4Adaptor.prototype.onCount = function (e) {\n    return e === true ? 'true' : '';\n  };\n  /**\n   * Generate request string based on the filter criteria from query.\n   * @param  {Predicate} pred\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataV4Adaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n    var returnValue = '';\n    var val = predicate.value;\n    var isDate = val instanceof Date;\n\n    if (query instanceof Query) {\n      var queries = this.getQueryRequest(query);\n\n      for (var i = 0; i < queries.filters.length; i++) {\n        if (queries.filters[i].e.key === predicate.value) {\n          requiresCast = true;\n        }\n      }\n    }\n\n    returnValue = _super.prototype.onPredicate.call(this, predicate, query, requiresCast);\n\n    if (isDate) {\n      returnValue = returnValue.replace(/datetime'(.*)'$/, '$1');\n    }\n\n    if (DataUtil.parse.isGuid(val)) {\n      returnValue = returnValue.replace('guid', '').replace(/'/g, '');\n    }\n\n    return returnValue;\n  };\n  /**\n   *  Generate query string based on the multiple search criteria from query.\n   * @param  {{fields:string[]} e\n   * @param  {string} operator\n   * @param  {string} key\n   * @param  {boolean}} ignoreCase\n   */\n\n\n  ODataV4Adaptor.prototype.onEachSearch = function (e) {\n    var search = this.pvt.searches || [];\n    search.push(e.key);\n    this.pvt.searches = search;\n  };\n  /**\n   *  Generate query string based on the search criteria from query.\n   * @param  {Object} e\n   */\n\n\n  ODataV4Adaptor.prototype.onSearch = function (e) {\n    return this.pvt.searches.join(' OR ');\n  };\n  /**\n   * Returns the expand query string.\n   * @param  {string} e\n   */\n\n\n  ODataV4Adaptor.prototype.onExpand = function (e) {\n    var _this = this;\n\n    var selected = {};\n    var expanded = {};\n    var expands = e.expands.slice();\n    var exArr = [];\n    var selects = e.selects.filter(function (item) {\n      return item.indexOf('.') > -1;\n    });\n    selects.forEach(function (select) {\n      var splits = select.split('.');\n\n      if (!(splits[0] in selected)) {\n        selected[splits[0]] = [];\n      }\n\n      selected[splits[0]].push(splits[1]);\n    }); //Auto expand from select query\n\n    Object.keys(selected).forEach(function (expand) {\n      if (expands.indexOf(expand) === -1) {\n        expands.push(expand);\n      }\n    });\n    expands.forEach(function (expand) {\n      expanded[expand] = expand in selected ? expand + \"(\" + _this.options.select + \"=\" + selected[expand].join(',') + \")\" : expand;\n    });\n    Object.keys(expanded).forEach(function (ex) {\n      return exArr.push(expanded[ex]);\n    });\n    return exArr.join(',');\n  };\n  /**\n   * Returns the groupby query string.\n   * @param  {string} e\n   */\n\n\n  ODataV4Adaptor.prototype.onDistinct = function (distinctFields) {\n    var fields = distinctFields.map(function (field) {\n      return ODataAdaptor.getField(field);\n    }).join(',');\n    return \"groupby((\" + fields + \"))\";\n  };\n  /**\n   * Returns the select query string.\n   * @param  {string[]} e\n   */\n\n\n  ODataV4Adaptor.prototype.onSelect = function (e) {\n    return _super.prototype.onSelect.call(this, e.filter(function (item) {\n      return item.indexOf('.') === -1;\n    }));\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings\n   * @returns void\n   */\n\n\n  ODataV4Adaptor.prototype.beforeSend = function (dm, request, settings) {\n    if (settings.type === 'POST' || settings.type === 'PUT' || settings.type === 'PATCH') {\n      request.setRequestHeader('Prefer', 'return=representation');\n    }\n\n    request.setRequestHeader('Accept', this.options.accept);\n  };\n  /**\n   * Returns the data from the query processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   * @returns aggregateResult\n   */\n\n\n  ODataV4Adaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    var metaName = '@odata.context';\n\n    if (request && request.type === 'GET' && !this.rootUrl && data[metaName]) {\n      var dataUrl = data[metaName].split('/$metadata#');\n      this.rootUrl = dataUrl[0];\n      this.resourceTableName = dataUrl[1];\n    }\n\n    var pvtData = 'pvtData';\n    var pvt = request && request[pvtData];\n\n    var emptyAndBatch = _super.prototype.processBatchResponse.call(this, data, query, xhr, request, changes);\n\n    if (emptyAndBatch) {\n      return emptyAndBatch;\n    }\n\n    var count = null;\n    var dataCount = '@odata.count';\n\n    if (query && query.isCountRequired) {\n      if (dataCount in data) {\n        count = data[dataCount];\n      }\n    }\n\n    data = !isNullOrUndefined(data.value) ? data.value : data;\n    var args = {};\n    args.count = count;\n    args.result = data;\n    this.getAggregateResult(pvt, data, args, null, query);\n    return DataUtil.isNull(count) ? args.result : {\n      result: args.result,\n      count: count,\n      aggregates: args.aggregates\n    };\n  };\n\n  return ODataV4Adaptor;\n}(ODataAdaptor);\n\nexport { ODataV4Adaptor };\n/**\n * The Web API is a programmatic interface to define the request and response messages system that is mostly exposed in JSON or XML.\n * The DataManager uses the WebApiAdaptor to consume Web API.\n * Since this adaptor is targeted to interact with Web API created using OData endpoint, it is extended from ODataAdaptor\n * @hidden\n */\n\nvar WebApiAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(WebApiAdaptor, _super);\n\n  function WebApiAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  WebApiAdaptor.prototype.getModuleName = function () {\n    return 'WebApiAdaptor';\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName?\n   */\n\n\n  WebApiAdaptor.prototype.insert = function (dm, data, tableName) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.url,\n      data: JSON.stringify(data)\n    };\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {number} value\n   * @param  {string} tableName?\n   */\n\n\n  WebApiAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    return {\n      type: 'DELETE',\n      url: dm.dataSource.url + '/' + value,\n      data: JSON.stringify(value)\n    };\n  };\n  /**\n   * Prepare and return request body which is used to update record.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   */\n\n\n  WebApiAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n    return {\n      type: 'PUT',\n      url: dm.dataSource.url,\n      data: JSON.stringify(value)\n    };\n  };\n\n  WebApiAdaptor.prototype.batchRequest = function (dm, changes, e) {\n    var _this = this;\n\n    var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n    var url = dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n    e.url = this.resourceTableName ? this.resourceTableName : e.url;\n    var req = [];\n\n    var _loop_1 = function (i, x) {\n      changes.addedRecords.forEach(function (j, d) {\n        var stat = {\n          'method': 'POST ',\n          'url': function (data, i, key) {\n            return '';\n          },\n          'data': function (data, i) {\n            return JSON.stringify(data[i]) + '\\n\\n';\n          }\n        };\n        req.push('--' + initialGuid);\n        req.push('Content-Type: application/http; msgtype=request', '');\n        req.push('POST ' + '/api/' + (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url) + stat.url(changes.addedRecords, i, e.key) + ' HTTP/1.1');\n        req.push('Content-Type: ' + 'application/json; charset=utf-8');\n        req.push('Host: ' + location.host);\n        req.push('', j ? JSON.stringify(j) : '');\n      });\n    }; //insertion\n\n\n    for (var i = 0, x = changes.addedRecords.length; i < x; i++) {\n      _loop_1(i, x);\n    }\n\n    var _loop_2 = function (i, x) {\n      changes.changedRecords.forEach(function (j, d) {\n        var stat = {\n          'method': _this.options.updateType + ' ',\n          'url': function (data, i, key) {\n            return '';\n          },\n          'data': function (data, i) {\n            return JSON.stringify(data[i]) + '\\n\\n';\n          }\n        };\n        req.push('--' + initialGuid);\n        req.push('Content-Type: application/http; msgtype=request', '');\n        req.push('PUT ' + '/api/' + (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url) + stat.url(changes.changedRecords, i, e.key) + ' HTTP/1.1');\n        req.push('Content-Type: ' + 'application/json; charset=utf-8');\n        req.push('Host: ' + location.host);\n        req.push('', j ? JSON.stringify(j) : '');\n      });\n    }; //updation \n\n\n    for (var i = 0, x = changes.changedRecords.length; i < x; i++) {\n      _loop_2(i, x);\n    }\n\n    var _loop_3 = function (i, x) {\n      changes.deletedRecords.forEach(function (j, d) {\n        var state = {\n          'mtd': 'DELETE ',\n          'url': function (data, i, key) {\n            var url = DataUtil.getObject(key, data[i]);\n\n            if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n              return '/' + url;\n            } else if (url instanceof Date) {\n              var datTime = data[i][key];\n              return '/' + datTime.toJSON();\n            } else {\n              return \"/'\" + url + \"'\";\n            }\n          },\n          'data': function (data, i) {\n            return '';\n          }\n        };\n        req.push('--' + initialGuid);\n        req.push('Content-Type: application/http; msgtype=request', '');\n        req.push('DELETE ' + '/api/' + (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url) + state.url(changes.deletedRecords, i, e.key) + ' HTTP/1.1');\n        req.push('Content-Type: ' + 'application/json; charset=utf-8');\n        req.push('Host: ' + location.host);\n        req.push('', j ? JSON.stringify(j) : '');\n      });\n    }; //deletion\n\n\n    for (var i = 0, x = changes.deletedRecords.length; i < x; i++) {\n      _loop_3(i, x);\n    }\n\n    req.push('--' + initialGuid + '--', '');\n    return {\n      type: 'POST',\n      url: url,\n      contentType: 'multipart/mixed; boundary=' + initialGuid,\n      data: req.join('\\r\\n')\n    };\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings\n   * @returns void\n   */\n\n\n  WebApiAdaptor.prototype.beforeSend = function (dm, request, settings) {\n    request.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');\n  };\n  /**\n   * Returns the data from the query processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   * @returns aggregateResult\n   */\n\n\n  WebApiAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    var pvtData = 'pvtData';\n    var pvt = request && request[pvtData];\n    var count = null;\n    var args = {};\n\n    if (request && request.type.toLowerCase() !== 'post') {\n      var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n      var version = versionCheck && parseInt(versionCheck, 10) || 2;\n\n      if (query && query.isCountRequired) {\n        if (!DataUtil.isNull(data.Count)) {\n          count = data.Count;\n        }\n      }\n\n      if (version < 3 && data.Items) {\n        data = data.Items;\n      }\n\n      args.count = count;\n      args.result = data;\n      this.getAggregateResult(pvt, data, args, null, query);\n    }\n\n    args.result = args.result || data;\n    return DataUtil.isNull(count) ? args.result : {\n      result: args.result,\n      count: args.count,\n      aggregates: args.aggregates\n    };\n  };\n\n  return WebApiAdaptor;\n}(ODataAdaptor);\n\nexport { WebApiAdaptor };\n/**\n * WebMethodAdaptor can be used by DataManager to interact with web method.\n * @hidden\n */\n\nvar WebMethodAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(WebMethodAdaptor, _super);\n\n  function WebMethodAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Prepare the request body based on the query.\n   * The query information can be accessed at the WebMethod using variable named `value`.\n   * @param  {DataManager} dm\n   * @param  {Query} query\n   * @param  {Object[]} hierarchyFilters?\n   * @returns application\n   */\n\n\n  WebMethodAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n    var obj = new UrlAdaptor().processQuery(dm, query, hierarchyFilters);\n    var getData = 'data';\n    var data = DataUtil.parse.parseJson(obj[getData]);\n    var result = {};\n    var value = 'value';\n\n    if (data.param) {\n      for (var i = 0; i < data.param.length; i++) {\n        var param = data.param[i];\n        var key = Object.keys(param)[0];\n        result[key] = param[key];\n      }\n    }\n\n    result[value] = data;\n    var pvtData = 'pvtData';\n    var url = 'url';\n    return {\n      data: JSON.stringify(result),\n      url: obj[url],\n      pvtData: obj[pvtData],\n      type: 'POST',\n      contentType: 'application/json; charset=utf-8'\n    };\n  };\n\n  return WebMethodAdaptor;\n}(UrlAdaptor);\n\nexport { WebMethodAdaptor };\n/**\n * RemoteSaveAdaptor, extended from JsonAdaptor and it is used for binding local data and performs all DataManager queries in client-side.\n * It interacts with server-side only for CRUD operations.\n * @hidden\n */\n\nvar RemoteSaveAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(RemoteSaveAdaptor, _super);\n  /**\n   * @hidden\n   */\n\n\n  function RemoteSaveAdaptor() {\n    var _this = _super.call(this) || this;\n\n    setValue('beforeSend', UrlAdaptor.prototype.beforeSend, _this);\n    return _this;\n  }\n\n  RemoteSaveAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n    this.pvt.position = position;\n    this.updateType = 'add';\n    return {\n      url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: data,\n        table: tableName,\n        action: 'insert'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.remove = function (dm, keyField, val, tableName, query) {\n    _super.prototype.remove.call(this, dm, keyField, val);\n\n    return {\n      type: 'POST',\n      url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        key: val,\n        keyColumn: keyField,\n        table: tableName,\n        action: 'remove'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.update = function (dm, keyField, val, tableName, query) {\n    this.updateType = 'update';\n    this.updateKey = keyField;\n    return {\n      type: 'POST',\n      url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: val,\n        action: 'update',\n        keyColumn: keyField,\n        key: val[keyField],\n        table: tableName\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes, e) {\n    var i;\n    data = request ? JSON.parse(request.data) : data;\n\n    if (this.updateType === 'add') {\n      _super.prototype.insert.call(this, ds, data, null, null, this.pvt.position);\n    }\n\n    if (this.updateType === 'update') {\n      _super.prototype.update.call(this, ds, this.updateKey, data);\n    }\n\n    this.updateType = undefined;\n\n    if (data.added) {\n      for (i = 0; i < data.added.length; i++) {\n        _super.prototype.insert.call(this, ds, data.added[i]);\n      }\n    }\n\n    if (data.changed) {\n      for (i = 0; i < data.changed.length; i++) {\n        _super.prototype.update.call(this, ds, e.key, data.changed[i]);\n      }\n    }\n\n    if (data.deleted) {\n      for (i = 0; i < data.deleted.length; i++) {\n        _super.prototype.remove.call(this, ds, e.key, data.deleted[i]);\n      }\n    }\n\n    return data;\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * Also perform the changes in the locally cached data to sync with the remote data.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   */\n\n\n  RemoteSaveAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      contentType: 'application/json; charset=utf-8',\n      dataType: 'json',\n      data: JSON.stringify(extend({}, {\n        changed: changes.changedRecords,\n        added: changes.addedRecords,\n        deleted: changes.deletedRecords,\n        action: 'batch',\n        table: e.url,\n        key: e.key\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.addParams = function (options) {\n    var urlParams = new UrlAdaptor();\n    urlParams.addParams(options);\n  };\n\n  return RemoteSaveAdaptor;\n}(JsonAdaptor);\n\nexport { RemoteSaveAdaptor };\n/**\n * Ajax Adaptor that is extended from URL Adaptor, is used for handle data operations with user defined functions.\n * @hidden\n */\n\nvar AjaxAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(AjaxAdaptor, _super);\n\n  function AjaxAdaptor(props) {\n    var _this = _super.call(this) || this; // options replaced the default adaptor options\n\n\n    _this.options = extend({}, _this.options, {\n      getData: new Function(),\n      addRecord: new Function(),\n      updateRecord: new Function(),\n      deleteRecord: new Function(),\n      batchUpdate: new Function()\n    });\n    extend(_this.options, props || {});\n    return _this;\n  }\n\n  AjaxAdaptor.prototype.getModuleName = function () {\n    return 'AjaxAdaptor';\n  };\n\n  return AjaxAdaptor;\n}(UrlAdaptor);\n\nexport { AjaxAdaptor };\n/**\n * Cache Adaptor is used to cache the data of the visited pages. It prevents new requests for the previously visited pages.\n * You can configure cache page size and duration of caching by using cachingPageSize and timeTillExpiration properties of the DataManager\n * @hidden\n */\n\nvar CacheAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(CacheAdaptor, _super);\n  /**\n   * Constructor for CacheAdaptor class.\n   * @param  {CacheAdaptor} adaptor?\n   * @param  {number} timeStamp?\n   * @param  {number} pageSize?\n   * @hidden\n   */\n\n\n  function CacheAdaptor(adaptor, timeStamp, pageSize) {\n    var _this = _super.call(this) || this;\n\n    _this.isCrudAction = false;\n    _this.isInsertAction = false;\n\n    if (!isNullOrUndefined(adaptor)) {\n      _this.cacheAdaptor = adaptor;\n    }\n\n    _this.pageSize = pageSize;\n    _this.guidId = DataUtil.getGuid('cacheAdaptor');\n    var obj = {\n      keys: [],\n      results: []\n    };\n    window.localStorage.setItem(_this.guidId, JSON.stringify(obj));\n    var guid = _this.guidId;\n\n    if (!isNullOrUndefined(timeStamp)) {\n      setInterval(function () {\n        var data;\n        data = DataUtil.parse.parseJson(window.localStorage.getItem(guid));\n        var forDel = [];\n\n        for (var i = 0; i < data.results.length; i++) {\n          var currentTime = +new Date();\n          var requestTime = +new Date(data.results[i].timeStamp);\n          data.results[i].timeStamp = currentTime - requestTime;\n\n          if (currentTime - requestTime > timeStamp) {\n            forDel.push(i);\n          }\n        }\n\n        for (var i = 0; i < forDel.length; i++) {\n          data.results.splice(forDel[i], 1);\n          data.keys.splice(forDel[i], 1);\n        }\n\n        window.localStorage.removeItem(guid);\n        window.localStorage.setItem(guid, JSON.stringify(data));\n      }, timeStamp);\n    }\n\n    return _this;\n  }\n  /**\n   * It will generate the key based on the URL when we send a request to server.\n   * @param  {string} url\n   * @param  {Query} query?\n   * @hidden\n   */\n\n\n  CacheAdaptor.prototype.generateKey = function (url, query) {\n    var queries = this.getQueryRequest(query);\n    var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n    var key = url;\n    var page = 'onPage';\n\n    if (page in singles) {\n      key += singles[page].pageIndex;\n    }\n\n    queries.sorts.forEach(function (obj) {\n      key += obj.e.direction + obj.e.fieldName;\n    });\n    queries.groups.forEach(function (obj) {\n      key += obj.e.fieldName;\n    });\n    queries.searches.forEach(function (obj) {\n      key += obj.e.searchKey;\n    });\n\n    for (var filter = 0; filter < queries.filters.length; filter++) {\n      var currentFilter = queries.filters[filter];\n\n      if (currentFilter.e.isComplex) {\n        var newQuery = query.clone();\n        newQuery.queries = [];\n\n        for (var i = 0; i < currentFilter.e.predicates.length; i++) {\n          newQuery.queries.push({\n            fn: 'onWhere',\n            e: currentFilter.e.predicates[i],\n            filter: query.queries.filter\n          });\n        }\n\n        key += currentFilter.e.condition + this.generateKey(url, newQuery);\n      } else {\n        key += currentFilter.e.field + currentFilter.e.operator + currentFilter.e.value;\n      }\n    }\n\n    return key;\n  };\n  /**\n   * Process the query to generate request body.\n   * If the data is already cached, it will return the cached data.\n   * @param  {DataManager} dm\n   * @param  {Query} query?\n   * @param  {Object[]} hierarchyFilters?\n   */\n\n\n  CacheAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n    var key = this.generateKey(dm.dataSource.url, query);\n    var cachedItems;\n    cachedItems = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n    var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(key)] : null;\n\n    if (data != null && !this.isCrudAction && !this.isInsertAction) {\n      return data;\n    }\n\n    this.isCrudAction = null;\n    this.isInsertAction = null;\n    return this.cacheAdaptor.processQuery.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n  };\n  /**\n   * Returns the data from the query processing.\n   * It will also cache the data for later usage.\n   * @param  {DataResult} data\n   * @param  {DataManager} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   */\n\n\n  CacheAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    if (this.isInsertAction || request && this.cacheAdaptor.options.batch && DataUtil.endsWith(request.url, this.cacheAdaptor.options.batch) && request.type.toLowerCase() === 'post') {\n      return this.cacheAdaptor.processResponse(data, ds, query, xhr, request, changes);\n    }\n\n    data = this.cacheAdaptor.processResponse.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n    var key = query ? this.generateKey(ds.dataSource.url, query) : ds.dataSource.url;\n    var obj = {};\n    obj = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n    var index = obj.keys.indexOf(key);\n\n    if (index !== -1) {\n      obj.results.splice(index, 1);\n      obj.keys.splice(index, 1);\n    }\n\n    obj.results[obj.keys.push(key) - 1] = {\n      keys: key,\n      result: data.result,\n      timeStamp: new Date(),\n      count: data.count\n    };\n\n    while (obj.results.length > this.pageSize) {\n      obj.results.splice(0, 1);\n      obj.keys.splice(0, 1);\n    }\n\n    window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n    return data;\n  };\n  /**\n   * Method will trigger before send the request to server side. Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings?\n   */\n\n\n  CacheAdaptor.prototype.beforeSend = function (dm, request, settings) {\n    if (!isNullOrUndefined(this.cacheAdaptor.options.batch) && DataUtil.endsWith(settings.url, this.cacheAdaptor.options.batch) && settings.type.toLowerCase() === 'post') {\n      request.setRequestHeader('Accept', this.cacheAdaptor.options.multipartAccept);\n    }\n\n    if (!dm.dataSource.crossDomain) {\n      request.setRequestHeader('Accept', this.cacheAdaptor.options.accept);\n    }\n  };\n  /**\n   * Updates existing record and saves the changes to the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName\n   */\n\n\n  CacheAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n    this.isCrudAction = true;\n    return this.cacheAdaptor.update(dm, keyField, value, tableName);\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName?\n   */\n\n\n  CacheAdaptor.prototype.insert = function (dm, data, tableName) {\n    this.isInsertAction = true;\n    return this.cacheAdaptor.insert(dm, data, tableName);\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   */\n\n\n  CacheAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    this.isCrudAction = true;\n    return this.cacheAdaptor.remove(dm, keyField, value, tableName);\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   */\n\n\n  CacheAdaptor.prototype.batchRequest = function (dm, changes, e) {\n    return this.cacheAdaptor.batchRequest(dm, changes, e);\n  };\n\n  return CacheAdaptor;\n}(UrlAdaptor);\n\nexport { CacheAdaptor };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","merge","extend","isNullOrUndefined","setValue","getValue","DataUtil","Query","Predicate","consts","GroupGuid","Adaptor","ds","options","from","requestType","sortBy","select","skip","group","take","search","count","where","aggregates","expand","type","dataSource","pvt","processResponse","data","query","xhr","JsonAdaptor","_super","apply","arguments","processQuery","dataManager","result","json","slice","length","countFlg","ret","key","lazyLoad","keyCount","page","i","value","agg","queries","fn","push","e","call","field","undefined","args","lazyLoadData","lazyLoadGroup","isCountRequired","getAggregate","onDemandGroupInfo","req","onWhere","level","fieldName","comparer","formGroupResult","onPage","uid","childLevel","records","aggQuery","filterQueries","tmp","batchRequest","dm","changes","deletedRecordsLen","deletedRecords","addedRecords","insert","changedRecords","update","remove","filter","obj","validate","onAggregates","onSearch","fieldNames","getFieldList","j","getObject","searchKey","ignoreCase","ignoreAccent","onSortBy","fnCompare","sort","endsWith","fnSort","replace","onGroup","size","pageSize","start","pageIndex","end","onRange","onTake","nos","onSkip","onSelect","tableName","position","splice","keyField","Date","UrlAdaptor","hierarchyFilters","getQueryRequest","singles","filterQueryLists","params","url","temp","request","sorts","groups","filters","searches","callAdaptorFunction","name","direction","getFiltersFrom","toJson","keys_3","keys","_i","keys_1","prop","isNull","fields","operator","getRequestQuery","reqParams","_a","keys_2","JSON","stringify","parse","jsonDateReplacer","pvtData","contentType","convertToQueryString","indexOf","request1","param","fromTable","distincts","selects","expands","getResponseHeader","handleTimeZone","timeZoneHandling","parseJson","requests","groupDs","action","isExpand","isArray","val","formRemoteGroupedData","getAggregateResult","items","childLvl","lvl","getGroupedRecords","hasRecords","childGroupedRecords","concat","original","batchUrl","crudUrl","removeUrl","dataType","changed","added","deleted","table","getAddParams","beforeSend","insertUrl","keyColumn","updateUrl","fKey","pKey","predicats","or","pData","aggregateData","res","aggregate","isServerGrouping","groupQuery","addParams","Error","ODataAdaptor","props","_this","accept","multipartAccept","batch","changeSet","batchPre","contentId","batchContent","changeSetContent","batchChangeSetContentType","updateType","getModuleName","onPredicate","predicate","requiresCast","returnValue","guid","getField","replacer","encodeURIComponent","isGuid","toLowerCase","odBiOperator","odv4UniOperator","odUniOperator","onComplexPredicate","predicates","onEachWhere","join","condition","isComplex","onEachSearch","throwError","onEachSort","reverse","onCount","settings","setRequestHeader","overrideMimeType","metaCheck","rootUrl","dataUrls","split","resourceTableName","dataCopy","results","metaData","emptyAndBatch","processBatchResponse","versionCheck","version","parseInt","oDataCount","format","requiresFormat","keys_4","localTimeReplacer","convertObj","dateParse","toLocalTime","localTime","compareAndRemove","initialGuid","getGuid","cid","cSet","generateInsertRequest","generateUpdateRequest","generateDeleteRequest","arr","stat","dateTime","toJSON","generateBodyContent","org","forEach","change","o","date","method","cIdx","jsonObj","substring","exVal","exec","changeGuid","test","isPlainObject","final","valueOf","ODataV4Adaptor","isDate","onExpand","selected","expanded","exArr","item","splits","ex","onDistinct","distinctFields","map","metaName","dataUrl","dataCount","WebApiAdaptor","_loop_1","x","location","host","_loop_2","_loop_3","state","datTime","Count","Items","WebMethodAdaptor","getData","RemoteSaveAdaptor","updateKey","urlParams","AjaxAdaptor","Function","addRecord","updateRecord","deleteRecord","batchUpdate","CacheAdaptor","adaptor","timeStamp","isCrudAction","isInsertAction","cacheAdaptor","guidId","window","localStorage","setItem","setInterval","getItem","forDel","currentTime","requestTime","removeItem","generateKey","currentFilter","newQuery","clone","cachedItems","index","crossDomain"],"sources":["D:/Theme/package/node_modules/@syncfusion/ej2-data/src/adaptors.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { merge, extend, isNullOrUndefined, setValue, getValue } from '@syncfusion/ej2-base';\nimport { DataUtil } from './util';\nimport { Query, Predicate } from './query';\nvar consts = { GroupGuid: '{271bbba0-1ee7}' };\n/**\n * Adaptors are specific data source type aware interfaces that are used by DataManager to communicate with DataSource.\n * This is the base adaptor class that other adaptors can extend.\n * @hidden\n */\nvar Adaptor = /** @class */ (function () {\n    /**\n     * Constructor for Adaptor class\n     * @param  {DataOptions} ds?\n     * @hidden\n     * @returns aggregates\n     */\n    function Adaptor(ds) {\n        // common options for all the adaptors \n        this.options = {\n            from: 'table',\n            requestType: 'json',\n            sortBy: 'sorted',\n            select: 'select',\n            skip: 'skip',\n            group: 'group',\n            take: 'take',\n            search: 'search',\n            count: 'requiresCounts',\n            where: 'where',\n            aggregates: 'aggregates',\n            expand: 'expand'\n        };\n        /**\n         * Specifies the type of adaptor.\n         * @default Adaptor\n         */\n        this.type = Adaptor;\n        this.dataSource = ds;\n        this.pvt = {};\n    }\n    /**\n     * Returns the data from the query processing.\n     * @param  {Object} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @returns Object\n     */\n    Adaptor.prototype.processResponse = function (data, ds, query, xhr) {\n        return data;\n    };\n    return Adaptor;\n}());\nexport { Adaptor };\n/**\n * JsonAdaptor is used to process JSON data. It contains methods to process the given JSON data based on the queries.\n * @hidden\n */\nvar JsonAdaptor = /** @class */ (function (_super) {\n    __extends(JsonAdaptor, _super);\n    function JsonAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Process the JSON data based on the provided queries.\n     * @param  {DataManager} dataManager\n     * @param  {Query} query\n     * @returns Object\n     */\n    JsonAdaptor.prototype.processQuery = function (dataManager, query) {\n        var result = dataManager.dataSource.json.slice(0);\n        var count = result.length;\n        var countFlg = true;\n        var ret;\n        var key;\n        var lazyLoad = {};\n        var keyCount = 0;\n        var group = [];\n        var page;\n        for (var i = 0; i < query.lazyLoad.length; i++) {\n            keyCount++;\n            lazyLoad[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n        }\n        var agg = {};\n        for (var i = 0; i < query.queries.length; i++) {\n            key = query.queries[i];\n            if ((key.fn === 'onPage' || key.fn === 'onGroup') && query.lazyLoad.length) {\n                if (key.fn === 'onGroup') {\n                    group.push(key.e);\n                }\n                if (key.fn === 'onPage') {\n                    page = key.e;\n                }\n                continue;\n            }\n            ret = this[key.fn].call(this, result, key.e, query);\n            if (key.fn === 'onAggregates') {\n                agg[key.e.field + ' - ' + key.e.type] = ret;\n            }\n            else {\n                result = ret !== undefined ? ret : result;\n            }\n            if (key.fn === 'onPage' || key.fn === 'onSkip' || key.fn === 'onTake' || key.fn === 'onRange') {\n                countFlg = false;\n            }\n            if (countFlg) {\n                count = result.length;\n            }\n        }\n        if (keyCount) {\n            var args = {\n                query: query, lazyLoad: lazyLoad, result: result, group: group, page: page\n            };\n            var lazyLoadData = this.lazyLoadGroup(args);\n            result = lazyLoadData.result;\n            count = lazyLoadData.count;\n        }\n        if (query.isCountRequired) {\n            result = {\n                result: result,\n                count: count,\n                aggregates: agg\n            };\n        }\n        return result;\n    };\n    /**\n     * Perform lazy load grouping in JSON array based on the given query and lazy load details.\n     * @param  {LazyLoadGroupArgs} args\n     */\n    JsonAdaptor.prototype.lazyLoadGroup = function (args) {\n        var count = 0;\n        var agg = this.getAggregate(args.query);\n        var result = args.result;\n        if (!isNullOrUndefined(args.lazyLoad.onDemandGroupInfo)) {\n            var req = args.lazyLoad.onDemandGroupInfo;\n            for (var i = req.where.length - 1; i >= 0; i--) {\n                result = this.onWhere(result, req.where[i]);\n            }\n            if (args.group.length !== req.level) {\n                var field = args.group[req.level].fieldName;\n                result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n            }\n            count = result.length;\n            var data = result;\n            result = result.slice(req.skip);\n            result = result.slice(0, req.take);\n            if (args.group.length !== req.level) {\n                this.formGroupResult(result, data);\n            }\n        }\n        else {\n            var field = args.group[0].fieldName;\n            result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n            count = result.length;\n            var data = result;\n            if (args.page) {\n                result = this.onPage(result, args.page, args.query);\n            }\n            this.formGroupResult(result, data);\n        }\n        return { result: result, count: count };\n    };\n    JsonAdaptor.prototype.formGroupResult = function (result, data) {\n        if (result.length && data.length) {\n            var uid = 'GroupGuid';\n            var childLevel = 'childLevels';\n            var level = 'level';\n            var records = 'records';\n            result[uid] = data[uid];\n            result[childLevel] = data[childLevel];\n            result[level] = data[level];\n            result[records] = data[records];\n        }\n        return result;\n    };\n    /**\n     * Separate the aggregate query from the given queries\n     * @param  {Query} query\n     */\n    JsonAdaptor.prototype.getAggregate = function (query) {\n        var aggQuery = Query.filterQueries(query.queries, 'onAggregates');\n        var agg = [];\n        if (aggQuery.length) {\n            var tmp = void 0;\n            for (var i = 0; i < aggQuery.length; i++) {\n                tmp = aggQuery[i].e;\n                agg.push({ type: tmp.type, field: DataUtil.getValue(tmp.field, query) });\n            }\n        }\n        return agg;\n    };\n    /**\n     * Performs batch update in the JSON array which add, remove and update records.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     */\n    JsonAdaptor.prototype.batchRequest = function (dm, changes, e) {\n        var i;\n        var deletedRecordsLen = changes.deletedRecords.length;\n        for (i = 0; i < changes.addedRecords.length; i++) {\n            this.insert(dm, changes.addedRecords[i]);\n        }\n        for (i = 0; i < changes.changedRecords.length; i++) {\n            this.update(dm, e.key, changes.changedRecords[i]);\n        }\n        for (i = 0; i < deletedRecordsLen; i++) {\n            this.remove(dm, e.key, changes.deletedRecords[i]);\n        }\n        return changes;\n    };\n    /**\n     * Performs filter operation with the given data and where query.\n     * @param  {Object[]} ds\n     * @param  {{validate:Function}} e\n     */\n    JsonAdaptor.prototype.onWhere = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.filter(function (obj) {\n            if (e) {\n                return e.validate(obj);\n            }\n        });\n    };\n    /**\n     * Returns aggregate function based on the aggregate type.\n     * @param  {Object[]} ds\n     * @param  {{field:string} e\n     * @param  {string}} type\n     */\n    JsonAdaptor.prototype.onAggregates = function (ds, e) {\n        var fn = DataUtil.aggregates[e.type];\n        if (!ds || !fn || ds.length === 0) {\n            return null;\n        }\n        return fn(ds, e.field);\n    };\n    /**\n     * Performs search operation based on the given query.\n     * @param  {Object[]} ds\n     * @param  {QueryOptions} e\n     */\n    JsonAdaptor.prototype.onSearch = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        if (e.fieldNames.length === 0) {\n            DataUtil.getFieldList(ds[0], e.fieldNames);\n        }\n        return ds.filter(function (obj) {\n            for (var j = 0; j < e.fieldNames.length; j++) {\n                if (e.comparer.call(obj, DataUtil.getObject(e.fieldNames[j], obj), e.searchKey, e.ignoreCase, e.ignoreAccent)) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    };\n    /**\n     * Sort the data with given direction and field.\n     * @param  {Object[]} ds\n     * @param  {{comparer:(a:Object} e\n     * @param  {Object} b\n     */\n    JsonAdaptor.prototype.onSortBy = function (ds, e, query) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        var fnCompare;\n        var field = DataUtil.getValue(e.fieldName, query);\n        if (!field) {\n            return ds.sort(e.comparer);\n        }\n        if (field instanceof Array) {\n            field = field.slice(0);\n            for (var i = field.length - 1; i >= 0; i--) {\n                if (!field[i]) {\n                    continue;\n                }\n                fnCompare = e.comparer;\n                if (DataUtil.endsWith(field[i], ' desc')) {\n                    fnCompare = DataUtil.fnSort('descending');\n                    field[i] = field[i].replace(' desc', '');\n                }\n                ds = DataUtil.sort(ds, field[i], fnCompare);\n            }\n            return ds;\n        }\n        return DataUtil.sort(ds, field, e.comparer);\n    };\n    /**\n     * Group the data based on the given query.\n     * @param  {Object[]} ds\n     * @param  {QueryOptions} e\n     * @param  {Query} query\n     */\n    JsonAdaptor.prototype.onGroup = function (ds, e, query) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        var agg = this.getAggregate(query);\n        return DataUtil.group(ds, DataUtil.getValue(e.fieldName, query), agg, null, null, e.comparer);\n    };\n    /**\n     * Retrieves records based on the given page index and size.\n     * @param  {Object[]} ds\n     * @param  {{pageSize:number} e\n     * @param  {number}} pageIndex\n     * @param  {Query} query\n     */\n    JsonAdaptor.prototype.onPage = function (ds, e, query) {\n        var size = DataUtil.getValue(e.pageSize, query);\n        var start = (DataUtil.getValue(e.pageIndex, query) - 1) * size;\n        var end = start + size;\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(start, end);\n    };\n    /**\n     * Retrieves records based on the given start and end index from query.\n     * @param  {Object[]} ds\n     * @param  {{start:number} e\n     * @param  {number}} end\n     */\n    JsonAdaptor.prototype.onRange = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(DataUtil.getValue(e.start), DataUtil.getValue(e.end));\n    };\n    /**\n     * Picks the given count of records from the top of the datasource.\n     * @param  {Object[]} ds\n     * @param  {{nos:number}} e\n     */\n    JsonAdaptor.prototype.onTake = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(0, DataUtil.getValue(e.nos));\n    };\n    /**\n     * Skips the given count of records from the data source.\n     * @param  {Object[]} ds\n     * @param  {{nos:number}} e\n     */\n    JsonAdaptor.prototype.onSkip = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(DataUtil.getValue(e.nos));\n    };\n    /**\n     * Selects specified columns from the data source.\n     * @param  {Object[]} ds\n     * @param  {{fieldNames:string}} e\n     */\n    JsonAdaptor.prototype.onSelect = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return DataUtil.select(ds, DataUtil.getValue(e.fieldNames));\n    };\n    /**\n     * Inserts new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {number} position\n     */\n    JsonAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n        if (isNullOrUndefined(position)) {\n            return dm.dataSource.json.push(data);\n        }\n        else {\n            return dm.dataSource.json.splice(position, 0, data);\n        }\n    };\n    /**\n     * Remove the data from the dataSource based on the key field value.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     * @returns null\n     */\n    JsonAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        var ds = dm.dataSource.json;\n        var i;\n        if (typeof value === 'object' && !(value instanceof Date)) {\n            value = DataUtil.getObject(keyField, value);\n        }\n        for (i = 0; i < ds.length; i++) {\n            if (DataUtil.getObject(keyField, ds[i]) === value) {\n                break;\n            }\n        }\n        return i !== ds.length ? ds.splice(i, 1) : null;\n    };\n    /**\n     * Updates existing record and saves the changes to the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     * @returns null\n     */\n    JsonAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n        var ds = dm.dataSource.json;\n        var i;\n        var key;\n        if (!isNullOrUndefined(keyField)) {\n            key = getValue(keyField, value);\n        }\n        for (i = 0; i < ds.length; i++) {\n            if (!isNullOrUndefined(keyField) && (getValue(keyField, ds[i])) === key) {\n                break;\n            }\n        }\n        return i < ds.length ? merge(ds[i], value) : null;\n    };\n    return JsonAdaptor;\n}(Adaptor));\nexport { JsonAdaptor };\n/**\n * URL Adaptor of DataManager can be used when you are required to use remote service to retrieve data.\n * It interacts with server-side for all DataManager Queries and CRUD operations.\n * @hidden\n */\nvar UrlAdaptor = /** @class */ (function (_super) {\n    __extends(UrlAdaptor, _super);\n    function UrlAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Process the query to generate request body.\n     * @param  {DataManager} dm\n     * @param  {Query} query\n     * @param  {Object[]} hierarchyFilters?\n     * @returns p\n     */\n    // tslint:disable-next-line:max-func-body-length\n    UrlAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n        var queries = this.getQueryRequest(query);\n        var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n        var params = query.params;\n        var url = dm.dataSource.url;\n        var temp;\n        var skip;\n        var take = null;\n        var options = this.options;\n        var request = { sorts: [], groups: [], filters: [], searches: [], aggregates: [] };\n        // calc Paging & Range\n        if ('onPage' in singles) {\n            temp = singles.onPage;\n            skip = DataUtil.getValue(temp.pageIndex, query);\n            take = DataUtil.getValue(temp.pageSize, query);\n            skip = (skip - 1) * take;\n        }\n        else if ('onRange' in singles) {\n            temp = singles.onRange;\n            skip = temp.start;\n            take = temp.end - temp.start;\n        }\n        // Sorting\n        for (var i = 0; i < queries.sorts.length; i++) {\n            temp = DataUtil.getValue(queries.sorts[i].e.fieldName, query);\n            request.sorts.push(DataUtil.callAdaptorFunction(this, 'onEachSort', { name: temp, direction: queries.sorts[i].e.direction }, query));\n        }\n        // hierarchy\n        if (hierarchyFilters) {\n            temp = this.getFiltersFrom(hierarchyFilters, query);\n            if (temp) {\n                request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', temp.toJson(), query));\n            }\n        }\n        // Filters\n        for (var i = 0; i < queries.filters.length; i++) {\n            request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', queries.filters[i].e.toJson(), query));\n            var keys_3 = typeof request.filters[i] === 'object' ? Object.keys(request.filters[i]) : [];\n            for (var _i = 0, keys_1 = keys_3; _i < keys_1.length; _i++) {\n                var prop = keys_1[_i];\n                if (DataUtil.isNull((request)[prop])) {\n                    delete request[prop];\n                }\n            }\n        }\n        // Searches\n        for (var i = 0; i < queries.searches.length; i++) {\n            temp = queries.searches[i].e;\n            request.searches.push(DataUtil.callAdaptorFunction(this, 'onEachSearch', {\n                fields: temp.fieldNames,\n                operator: temp.operator,\n                key: temp.searchKey,\n                ignoreCase: temp.ignoreCase\n            }, query));\n        }\n        // Grouping\n        for (var i = 0; i < queries.groups.length; i++) {\n            request.groups.push(DataUtil.getValue(queries.groups[i].e.fieldName, query));\n        }\n        // aggregates\n        for (var i = 0; i < queries.aggregates.length; i++) {\n            temp = queries.aggregates[i].e;\n            request.aggregates.push({ type: temp.type, field: DataUtil.getValue(temp.field, query) });\n        }\n        var req = {};\n        this.getRequestQuery(options, query, singles, request, req);\n        // Params\n        DataUtil.callAdaptorFunction(this, 'addParams', { dm: dm, query: query, params: params, reqParams: req });\n        if (query.lazyLoad.length) {\n            for (var i = 0; i < query.lazyLoad.length; i++) {\n                req[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n            }\n        }\n        // cleanup\n        var keys = Object.keys(req);\n        for (var _a = 0, keys_2 = keys; _a < keys_2.length; _a++) {\n            var prop = keys_2[_a];\n            if (DataUtil.isNull(req[prop]) || req[prop] === '' || req[prop].length === 0) {\n                delete req[prop];\n            }\n        }\n        if (!(options.skip in req && options.take in req) && take !== null) {\n            req[options.skip] = DataUtil.callAdaptorFunction(this, 'onSkip', skip, query);\n            req[options.take] = DataUtil.callAdaptorFunction(this, 'onTake', take, query);\n        }\n        var p = this.pvt;\n        this.pvt = {};\n        if (this.options.requestType === 'json') {\n            return {\n                data: JSON.stringify(req, DataUtil.parse.jsonDateReplacer),\n                url: url,\n                pvtData: p,\n                type: 'POST',\n                contentType: 'application/json; charset=utf-8'\n            };\n        }\n        temp = this.convertToQueryString(req, query, dm);\n        temp = (dm.dataSource.url.indexOf('?') !== -1 ? '&' : '/') + temp;\n        return {\n            type: 'GET', url: temp.length ? url.replace(/\\/*$/, temp) : url, pvtData: p\n        };\n    };\n    UrlAdaptor.prototype.getRequestQuery = function (options, query, singles, request, request1) {\n        var param = 'param';\n        var req = request1;\n        req[options.from] = query.fromTable;\n        if (options.apply && query.distincts.length) {\n            req[options.apply] = 'onDistinct' in this ? DataUtil.callAdaptorFunction(this, 'onDistinct', query.distincts) : '';\n        }\n        if (!query.distincts.length && options.expand) {\n            req[options.expand] = 'onExpand' in this && 'onSelect' in singles ?\n                DataUtil.callAdaptorFunction(this, 'onExpand', { selects: DataUtil.getValue(singles.onSelect.fieldNames, query), expands: query.expands }, query) : query.expands;\n        }\n        req[options.select] = 'onSelect' in singles && !query.distincts.length ?\n            DataUtil.callAdaptorFunction(this, 'onSelect', DataUtil.getValue(singles.onSelect.fieldNames, query), query) : '';\n        req[options.count] = query.isCountRequired ? DataUtil.callAdaptorFunction(this, 'onCount', query.isCountRequired, query) : '';\n        req[options.search] = request.searches.length ? DataUtil.callAdaptorFunction(this, 'onSearch', request.searches, query) : '';\n        req[options.skip] = 'onSkip' in singles ?\n            DataUtil.callAdaptorFunction(this, 'onSkip', DataUtil.getValue(singles.onSkip.nos, query), query) : '';\n        req[options.take] = 'onTake' in singles ?\n            DataUtil.callAdaptorFunction(this, 'onTake', DataUtil.getValue(singles.onTake.nos, query), query) : '';\n        req[options.where] = request.filters.length || request.searches.length ?\n            DataUtil.callAdaptorFunction(this, 'onWhere', request.filters, query) : '';\n        req[options.sortBy] = request.sorts.length ? DataUtil.callAdaptorFunction(this, 'onSortBy', request.sorts, query) : '';\n        req[options.group] = request.groups.length ? DataUtil.callAdaptorFunction(this, 'onGroup', request.groups, query) : '';\n        req[options.aggregates] = request.aggregates.length ?\n            DataUtil.callAdaptorFunction(this, 'onAggregates', request.aggregates, query) : '';\n        req[param] = [];\n    };\n    /**\n     * Convert the object from processQuery to string which can be added query string.\n     * @param  {Object} req\n     * @param  {Query} query\n     * @param  {DataManager} dm\n     */\n    UrlAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n        return '';\n        // this needs to be overridden\n    };\n    /**\n     * Return the data from the data manager processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Object} request?\n     * @param  {CrudOptions} changes?\n     */\n    UrlAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        if (xhr && xhr.getResponseHeader('Content-Type') &&\n            xhr.getResponseHeader('Content-Type').indexOf('application/json') !== -1) {\n            var handleTimeZone = DataUtil.timeZoneHandling;\n            if (ds && !ds.timeZoneHandling) {\n                DataUtil.timeZoneHandling = false;\n            }\n            data = DataUtil.parse.parseJson(data);\n            DataUtil.timeZoneHandling = handleTimeZone;\n        }\n        var requests = request;\n        var pvt = requests.pvtData || {};\n        var groupDs = data ? data.groupDs : [];\n        if (xhr && xhr.getResponseHeader('Content-Type') &&\n            xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n            return (query.isCountRequired ? { result: [], count: 0 } : []);\n        }\n        var d = JSON.parse(requests.data);\n        if (d && d.action === 'batch' && data && data.addedRecords) {\n            changes.addedRecords = data.addedRecords;\n            return changes;\n        }\n        if (data && data.d) {\n            data = data.d;\n        }\n        var args = {};\n        if (data && 'count' in data) {\n            args.count = data.count;\n        }\n        args.result = data && data.result ? data.result : data;\n        var isExpand = false;\n        if (Array.isArray(data.result) && data.result.length) {\n            var key = 'key';\n            var val = 'value';\n            var level = 'level';\n            if (!isNullOrUndefined(data.result[0][key])) {\n                args.result = this.formRemoteGroupedData(args.result, 1, pvt.groups.length - 1);\n            }\n            if (query && query.lazyLoad.length && pvt.groups.length) {\n                for (var i = 0; i < query.lazyLoad.length; i++) {\n                    if (query.lazyLoad[i][key] === 'onDemandGroupInfo') {\n                        var value = query.lazyLoad[i][val][level];\n                        if (pvt.groups.length === value) {\n                            isExpand = true;\n                        }\n                    }\n                }\n            }\n        }\n        if (!isExpand) {\n            this.getAggregateResult(pvt, data, args, groupDs, query);\n        }\n        return DataUtil.isNull(args.count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n    };\n    UrlAdaptor.prototype.formRemoteGroupedData = function (data, level, childLevel) {\n        for (var i = 0; i < data.length; i++) {\n            if (data[i].items.length && Object.keys(data[i].items[0]).indexOf('key') > -1) {\n                this.formRemoteGroupedData(data[i].items, level + 1, childLevel - 1);\n            }\n        }\n        var uid = 'GroupGuid';\n        var childLvl = 'childLevels';\n        var lvl = 'level';\n        var records = 'records';\n        data[uid] = consts[uid];\n        data[lvl] = level;\n        data[childLvl] = childLevel;\n        data[records] = data[0].items.length ? this.getGroupedRecords(data, !isNullOrUndefined(data[0].items[records])) : [];\n        return data;\n    };\n    UrlAdaptor.prototype.getGroupedRecords = function (data, hasRecords) {\n        var childGroupedRecords = [];\n        var records = 'records';\n        for (var i = 0; i < data.length; i++) {\n            if (!hasRecords) {\n                for (var j = 0; j < data[i].items.length; j++) {\n                    childGroupedRecords.push(data[i].items[j]);\n                }\n            }\n            else {\n                childGroupedRecords = childGroupedRecords.concat(data[i].items[records]);\n            }\n        }\n        return childGroupedRecords;\n    };\n    /**\n     * Add the group query to the adaptor`s option.\n     * @param  {Object[]} e\n     * @returns void\n     */\n    UrlAdaptor.prototype.onGroup = function (e) {\n        this.pvt.groups = e;\n        return e;\n    };\n    /**\n     * Add the aggregate query to the adaptor`s option.\n     * @param  {Aggregates[]} e\n     * @returns void\n     */\n    UrlAdaptor.prototype.onAggregates = function (e) {\n        this.pvt.aggregates = e;\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {Object} e\n     */\n    UrlAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n        var url;\n        var key;\n        return {\n            type: 'POST',\n            url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.removeUrl || dm.dataSource.url,\n            contentType: 'application/json; charset=utf-8',\n            dataType: 'json',\n            data: JSON.stringify(extend({}, {\n                changed: changes.changedRecords,\n                added: changes.addedRecords,\n                deleted: changes.deletedRecords,\n                action: 'batch',\n                table: e[url],\n                key: e[key]\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @returns void\n     */\n    UrlAdaptor.prototype.beforeSend = function (dm, request) {\n        // need to extend this method\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName\n     */\n    UrlAdaptor.prototype.insert = function (dm, data, tableName, query) {\n        return {\n            url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: data,\n                table: tableName,\n                action: 'insert'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {number|string} value\n     * @param  {string} tableName\n     */\n    UrlAdaptor.prototype.remove = function (dm, keyField, value, tableName, query) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                key: value,\n                keyColumn: keyField,\n                table: tableName,\n                action: 'remove'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * Prepare and return request body which is used to update record.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName\n     */\n    UrlAdaptor.prototype.update = function (dm, keyField, value, tableName, query) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: value,\n                action: 'update',\n                keyColumn: keyField,\n                key: DataUtil.getObject(keyField, value),\n                table: tableName\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * To generate the predicate based on the filtered query.\n     * @param  {Object[]|string[]|number[]} data\n     * @param  {Query} query\n     * @hidden\n     */\n    UrlAdaptor.prototype.getFiltersFrom = function (data, query) {\n        var key = query.fKey;\n        var value;\n        var prop = key;\n        var pKey = query.key;\n        var predicats = [];\n        if (typeof data[0] !== 'object') {\n            prop = null;\n        }\n        for (var i = 0; i < data.length; i++) {\n            if (typeof data[0] === 'object') {\n                value = DataUtil.getObject(pKey || prop, data[i]);\n            }\n            else {\n                value = data[i];\n            }\n            predicats.push(new Predicate(key, 'equal', value));\n        }\n        return Predicate.or(predicats);\n    };\n    UrlAdaptor.prototype.getAggregateResult = function (pvt, data, args, groupDs, query) {\n        var pData = data;\n        if (data && data.result) {\n            pData = data.result;\n        }\n        if (pvt && pvt.aggregates && pvt.aggregates.length) {\n            var agg = pvt.aggregates;\n            var fn = void 0;\n            var aggregateData = pData;\n            var res = {};\n            if (data.aggregate) {\n                aggregateData = data.aggregate;\n            }\n            for (var i = 0; i < agg.length; i++) {\n                fn = DataUtil.aggregates[agg[i].type];\n                if (fn) {\n                    res[agg[i].field + ' - ' + agg[i].type] = fn(aggregateData, agg[i].field);\n                }\n            }\n            args.aggregates = res;\n        }\n        var key = 'key';\n        var isServerGrouping = Array.isArray(data.result) && data.result.length && !isNullOrUndefined(data.result[0][key]);\n        if (pvt && pvt.groups && pvt.groups.length && !isServerGrouping) {\n            var groups = pvt.groups;\n            for (var i = 0; i < groups.length; i++) {\n                var level = null;\n                if (!isNullOrUndefined(groupDs)) {\n                    groupDs = DataUtil.group(groupDs, groups[i]);\n                }\n                var groupQuery = Query.filterQueries(query.queries, 'onGroup')[i].e;\n                pData = DataUtil.group(pData, groups[i], pvt.aggregates, level, groupDs, groupQuery.comparer);\n            }\n            args.result = pData;\n        }\n        return args;\n    };\n    UrlAdaptor.prototype.getQueryRequest = function (query) {\n        var req = { sorts: [], groups: [], filters: [], searches: [], aggregates: [] };\n        req.sorts = Query.filterQueries(query.queries, 'onSortBy');\n        req.groups = Query.filterQueries(query.queries, 'onGroup');\n        req.filters = Query.filterQueries(query.queries, 'onWhere');\n        req.searches = Query.filterQueries(query.queries, 'onSearch');\n        req.aggregates = Query.filterQueries(query.queries, 'onAggregates');\n        return req;\n    };\n    UrlAdaptor.prototype.addParams = function (options) {\n        var req = options.reqParams;\n        if (options.params.length) {\n            req.params = {};\n        }\n        for (var _i = 0, _a = options.params; _i < _a.length; _i++) {\n            var tmp = _a[_i];\n            if (req[tmp.key]) {\n                throw new Error('Query() - addParams: Custom Param is conflicting other request arguments');\n            }\n            req[tmp.key] = tmp.value;\n            if (tmp.fn) {\n                req[tmp.key] = tmp.fn.call(options.query, tmp.key, options.query, options.dm);\n            }\n            req.params[tmp.key] = req[tmp.key];\n        }\n    };\n    return UrlAdaptor;\n}(Adaptor));\nexport { UrlAdaptor };\n/**\n * OData Adaptor that is extended from URL Adaptor, is used for consuming data through OData Service.\n * @hidden\n */\nvar ODataAdaptor = /** @class */ (function (_super) {\n    __extends(ODataAdaptor, _super);\n    function ODataAdaptor(props) {\n        var _this = _super.call(this) || this;\n        // options replaced the default adaptor options\n        _this.options = extend({}, _this.options, {\n            requestType: 'get',\n            accept: 'application/json;odata=light;q=1,application/json;odata=verbose;q=0.5',\n            multipartAccept: 'multipart/mixed',\n            sortBy: '$orderby',\n            select: '$select',\n            skip: '$skip',\n            take: '$top',\n            count: '$inlinecount',\n            where: '$filter',\n            expand: '$expand',\n            batch: '$batch',\n            changeSet: '--changeset_',\n            batchPre: 'batch_',\n            contentId: 'Content-Id: ',\n            batchContent: 'Content-Type: multipart/mixed; boundary=',\n            changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n            batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n            updateType: 'PUT'\n        });\n        extend(_this.options, props || {});\n        return _this;\n    }\n    ODataAdaptor.prototype.getModuleName = function () {\n        return 'ODataAdaptor';\n    };\n    /**\n     * Generate request string based on the filter criteria from query.\n     * @param  {Predicate} pred\n     * @param  {boolean} requiresCast?\n     */\n    ODataAdaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n        var returnValue = '';\n        var operator;\n        var guid;\n        var val = predicate.value;\n        var type = typeof val;\n        var field = predicate.field ? ODataAdaptor.getField(predicate.field) : null;\n        if (val instanceof Date) {\n            val = 'datetime\\'' + DataUtil.parse.replacer(val) + '\\'';\n        }\n        if (type === 'string') {\n            val = encodeURIComponent(val);\n            val = '\\'' + val + '\\'';\n            if (requiresCast) {\n                field = 'cast(' + field + ', \\'Edm.String\\')';\n            }\n            if (DataUtil.parse.isGuid(val)) {\n                guid = 'guid';\n            }\n            if (predicate.ignoreCase) {\n                if (!guid) {\n                    field = 'tolower(' + field + ')';\n                }\n                val = val.toLowerCase();\n            }\n        }\n        operator = DataUtil.odBiOperator[predicate.operator];\n        if (operator) {\n            returnValue += field;\n            returnValue += operator;\n            if (guid) {\n                returnValue += guid;\n            }\n            return returnValue + val;\n        }\n        if (!isNullOrUndefined(this.getModuleName) && this.getModuleName() === 'ODataV4Adaptor') {\n            operator = DataUtil.odv4UniOperator[predicate.operator];\n        }\n        else {\n            operator = DataUtil.odUniOperator[predicate.operator];\n        }\n        if (operator === 'substringof') {\n            var temp = val;\n            val = field;\n            field = temp;\n        }\n        returnValue += operator + '(';\n        returnValue += field + ',';\n        if (guid) {\n            returnValue += guid;\n        }\n        returnValue += val + ')';\n        return returnValue;\n    };\n    ODataAdaptor.prototype.addParams = function (options) {\n        _super.prototype.addParams.call(this, options);\n        delete options.reqParams.params;\n    };\n    /**\n     * Generate request string based on the multiple filter criteria from query.\n     * @param  {Predicate} pred\n     * @param  {boolean} requiresCast?\n     */\n    ODataAdaptor.prototype.onComplexPredicate = function (predicate, query, requiresCast) {\n        var res = [];\n        for (var i = 0; i < predicate.predicates.length; i++) {\n            res.push('(' + this.onEachWhere(predicate.predicates[i], query, requiresCast) + ')');\n        }\n        return res.join(' ' + predicate.condition + ' ');\n    };\n    /**\n     * Generate query string based on the multiple filter criteria from query.\n     * @param  {Predicate} filter\n     * @param  {boolean} requiresCast?\n     */\n    ODataAdaptor.prototype.onEachWhere = function (filter, query, requiresCast) {\n        return filter.isComplex ? this.onComplexPredicate(filter, query, requiresCast) : this.onPredicate(filter, query, requiresCast);\n    };\n    /**\n     * Generate query string based on the multiple filter criteria from query.\n     * @param  {string[]} filters\n     */\n    ODataAdaptor.prototype.onWhere = function (filters) {\n        if (this.pvt.search) {\n            filters.push(this.onEachWhere(this.pvt.search, null, true));\n        }\n        return filters.join(' and ');\n    };\n    /**\n     * Generate query string based on the multiple search criteria from query.\n     * @param  {{fields:string[]} e\n     * @param  {string} operator\n     * @param  {string} key\n     * @param  {boolean}} ignoreCase\n     */\n    ODataAdaptor.prototype.onEachSearch = function (e) {\n        if (e.fields && e.fields.length === 0) {\n            DataUtil.throwError('Query() - Search : oData search requires list of field names to search');\n        }\n        var filter = this.pvt.search || [];\n        for (var i = 0; i < e.fields.length; i++) {\n            filter.push(new Predicate(e.fields[i], e.operator, e.key, e.ignoreCase));\n        }\n        this.pvt.search = filter;\n    };\n    /**\n     * Generate query string based on the search criteria from query.\n     * @param  {Object} e\n     */\n    ODataAdaptor.prototype.onSearch = function (e) {\n        this.pvt.search = Predicate.or(this.pvt.search);\n        return '';\n    };\n    /**\n     * Generate query string based on multiple sort criteria from query.\n     * @param  {QueryOptions} e\n     */\n    ODataAdaptor.prototype.onEachSort = function (e) {\n        var res = [];\n        if (e.name instanceof Array) {\n            for (var i = 0; i < e.name.length; i++) {\n                res.push(ODataAdaptor.getField(e.name[i]) + (e.direction === 'descending' ? ' desc' : ''));\n            }\n        }\n        else {\n            res.push(ODataAdaptor.getField(e.name) + (e.direction === 'descending' ? ' desc' : ''));\n        }\n        return res.join(',');\n    };\n    /**\n     * Returns sort query string.\n     * @param  {string[]} e\n     */\n    ODataAdaptor.prototype.onSortBy = function (e) {\n        return e.reverse().join(',');\n    };\n    /**\n     * Adds the group query to the adaptor option.\n     * @param  {Object[]} e\n     * @returns string\n     */\n    ODataAdaptor.prototype.onGroup = function (e) {\n        this.pvt.groups = e;\n        return [];\n    };\n    /**\n     * Returns the select query string.\n     * @param  {string[]} e\n     */\n    ODataAdaptor.prototype.onSelect = function (e) {\n        for (var i = 0; i < e.length; i++) {\n            e[i] = ODataAdaptor.getField(e[i]);\n        }\n        return e.join(',');\n    };\n    /**\n     * Add the aggregate query to the adaptor option.\n     * @param  {Object[]} e\n     * @returns string\n     */\n    ODataAdaptor.prototype.onAggregates = function (e) {\n        this.pvt.aggregates = e;\n        return '';\n    };\n    /**\n     * Returns the query string which requests total count from the data source.\n     * @param  {boolean} e\n     * @returns string\n     */\n    ODataAdaptor.prototype.onCount = function (e) {\n        return e === true ? 'allpages' : '';\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings?\n     */\n    ODataAdaptor.prototype.beforeSend = function (dm, request, settings) {\n        if (DataUtil.endsWith(settings.url, this.options.batch) && settings.type.toLowerCase() === 'post') {\n            request.setRequestHeader('Accept', this.options.multipartAccept);\n            request.setRequestHeader('DataServiceVersion', '2.0');\n            request.overrideMimeType('text/plain; charset=x-user-defined');\n        }\n        else {\n            request.setRequestHeader('Accept', this.options.accept);\n        }\n        request.setRequestHeader('DataServiceVersion', '2.0');\n        request.setRequestHeader('MaxDataServiceVersion', '2.0');\n    };\n    /**\n     * Returns the data from the query processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     * @returns aggregateResult\n     */\n    ODataAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        var metaCheck = 'odata.metadata';\n        if ((request && request.type === 'GET') && !this.rootUrl && data[metaCheck]) {\n            var dataUrls = data[metaCheck].split('/$metadata#');\n            this.rootUrl = dataUrls[0];\n            this.resourceTableName = dataUrls[1];\n        }\n        var pvtData = 'pvtData';\n        if (!isNullOrUndefined(data.d)) {\n            var dataCopy = ((query && query.isCountRequired) ? data.d.results : data.d);\n            var metaData = '__metadata';\n            if (!isNullOrUndefined(dataCopy)) {\n                for (var i = 0; i < dataCopy.length; i++) {\n                    if (!isNullOrUndefined(dataCopy[i][metaData])) {\n                        delete dataCopy[i][metaData];\n                    }\n                }\n            }\n        }\n        var pvt = request && request[pvtData];\n        var emptyAndBatch = this.processBatchResponse(data, query, xhr, request, changes);\n        if (emptyAndBatch) {\n            return emptyAndBatch;\n        }\n        var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n        var count = null;\n        var version = (versionCheck && parseInt(versionCheck, 10)) || 2;\n        if (query && query.isCountRequired) {\n            var oDataCount = '__count';\n            if (data[oDataCount] || data['odata.count']) {\n                count = data[oDataCount] || data['odata.count'];\n            }\n            if (data.d) {\n                data = data.d;\n            }\n            if (data[oDataCount] || data['odata.count']) {\n                count = data[oDataCount] || data['odata.count'];\n            }\n        }\n        if (version === 3 && data.value) {\n            data = data.value;\n        }\n        if (data.d) {\n            data = data.d;\n        }\n        if (version < 3 && data.results) {\n            data = data.results;\n        }\n        var args = {};\n        args.count = count;\n        args.result = data;\n        this.getAggregateResult(pvt, data, args, null, query);\n        return DataUtil.isNull(count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n    };\n    /**\n     * Converts the request object to query string.\n     * @param  {Object} req\n     * @param  {Query} query\n     * @param  {DataManager} dm\n     * @returns tableName\n     */\n    ODataAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n        var res = [];\n        var table = 'table';\n        var tableName = request[table] || '';\n        var format = '$format';\n        delete request[table];\n        if (dm.dataSource.requiresFormat) {\n            request[format] = 'json';\n        }\n        var keys = Object.keys(request);\n        for (var _i = 0, keys_4 = keys; _i < keys_4.length; _i++) {\n            var prop = keys_4[_i];\n            res.push(prop + '=' + request[prop]);\n        }\n        res = res.join('&');\n        if (dm.dataSource.url && dm.dataSource.url.indexOf('?') !== -1 && !tableName) {\n            return res;\n        }\n        return res.length ? tableName + '?' + res : tableName || '';\n    };\n    ODataAdaptor.prototype.localTimeReplacer = function (key, convertObj) {\n        for (var _i = 0, _a = !isNullOrUndefined(convertObj) ? Object.keys(convertObj) : []; _i < _a.length; _i++) {\n            var prop = _a[_i];\n            if ((convertObj[prop] instanceof Date)) {\n                convertObj[prop] = DataUtil.dateParse.toLocalTime(convertObj[prop]);\n            }\n        }\n        return convertObj;\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName?\n     */\n    ODataAdaptor.prototype.insert = function (dm, data, tableName) {\n        return {\n            url: (dm.dataSource.insertUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : ''),\n            data: JSON.stringify(data, this.options.localTime ? this.localTimeReplacer : null)\n        };\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {number} value\n     * @param  {string} tableName?\n     */\n    ODataAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        var url;\n        if (typeof value === 'string' && !DataUtil.parse.isGuid(value)) {\n            url = \"('\" + value + \"')\";\n        }\n        else {\n            url = \"(\" + value + \")\";\n        }\n        return {\n            type: 'DELETE',\n            url: (dm.dataSource.removeUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url\n        };\n    };\n    /**\n     * Updates existing record and saves the changes to the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     * @returns this\n     */\n    ODataAdaptor.prototype.update = function (dm, keyField, value, tableName, query, original) {\n        if (this.options.updateType === 'PATCH' && !isNullOrUndefined(original)) {\n            value = this.compareAndRemove(value, original, keyField);\n        }\n        var url;\n        if (typeof value[keyField] === 'string' && !DataUtil.parse.isGuid(value[keyField])) {\n            url = \"('\" + value[keyField] + \"')\";\n        }\n        else {\n            url = \"(\" + value[keyField] + \")\";\n        }\n        return {\n            type: this.options.updateType,\n            url: (dm.dataSource.updateUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url,\n            data: JSON.stringify(value, this.options.localTime ? this.localTimeReplacer : null),\n            accept: this.options.accept\n        };\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     * @returns {Object}\n     */\n    ODataAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n        var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n        var url = this.rootUrl ? this.rootUrl + '/' + this.options.batch :\n            dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n        e.url = this.resourceTableName ? this.resourceTableName : e.url;\n        var args = {\n            url: e.url,\n            key: e.key,\n            cid: 1,\n            cSet: DataUtil.getGuid(this.options.changeSet)\n        };\n        var req = '--' + initialGuid + '\\n';\n        req += 'Content-Type: multipart/mixed; boundary=' + args.cSet.replace('--', '') + '\\n';\n        this.pvt.changeSet = 0;\n        req += this.generateInsertRequest(changes.addedRecords, args, dm);\n        req += this.generateUpdateRequest(changes.changedRecords, args, dm, original ? original.changedRecords : []);\n        req += this.generateDeleteRequest(changes.deletedRecords, args, dm);\n        req += args.cSet + '--\\n';\n        req += '--' + initialGuid + '--';\n        return {\n            type: 'POST',\n            url: url,\n            dataType: 'json',\n            contentType: 'multipart/mixed; charset=UTF-8;boundary=' + initialGuid,\n            data: req\n        };\n    };\n    /**\n     * Generate the string content from the removed records.\n     * The result will be send during batch update.\n     * @param  {Object[]} arr\n     * @param  {RemoteArgs} e\n     * @returns this\n     */\n    ODataAdaptor.prototype.generateDeleteRequest = function (arr, e, dm) {\n        if (!arr) {\n            return '';\n        }\n        var req = '';\n        var stat = {\n            'method': 'DELETE ',\n            'url': function (data, i, key) {\n                var url = DataUtil.getObject(key, data[i]);\n                if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n                    return '(' + url + ')';\n                }\n                else if (url instanceof Date) {\n                    var dateTime = data[i][key];\n                    return '(' + dateTime.toJSON() + ')';\n                }\n                else {\n                    return \"('\" + url + \"')\";\n                }\n            },\n            'data': function (data, i) { return ''; }\n        };\n        req = this.generateBodyContent(arr, e, stat, dm);\n        return req + '\\n';\n    };\n    /**\n     * Generate the string content from the inserted records.\n     * The result will be send during batch update.\n     * @param  {Object[]} arr\n     * @param  {RemoteArgs} e\n     */\n    ODataAdaptor.prototype.generateInsertRequest = function (arr, e, dm) {\n        if (!arr) {\n            return '';\n        }\n        var req = '';\n        var stat = {\n            'method': 'POST ',\n            'url': function (data, i, key) { return ''; },\n            'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n        };\n        req = this.generateBodyContent(arr, e, stat, dm);\n        return req;\n    };\n    /**\n     * Generate the string content from the updated records.\n     * The result will be send during batch update.\n     * @param  {Object[]} arr\n     * @param  {RemoteArgs} e\n     */\n    ODataAdaptor.prototype.generateUpdateRequest = function (arr, e, dm, org) {\n        var _this = this;\n        if (!arr) {\n            return '';\n        }\n        var req = '';\n        arr.forEach(function (change) { return change = _this.compareAndRemove(change, org.filter(function (o) { return DataUtil.getObject(e.key, o) === DataUtil.getObject(e.key, change); })[0], e.key); });\n        var stat = {\n            'method': this.options.updateType + ' ',\n            'url': function (data, i, key) {\n                if (typeof data[i][key] === 'number' || DataUtil.parse.isGuid(data[i][key])) {\n                    return '(' + data[i][key] + ')';\n                }\n                else if (data[i][key] instanceof Date) {\n                    var date = data[i][key];\n                    return '(' + date.toJSON() + ')';\n                }\n                else {\n                    return \"('\" + data[i][key] + \"')\";\n                }\n            },\n            'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n        };\n        req = this.generateBodyContent(arr, e, stat, dm);\n        return req;\n    };\n    ODataAdaptor.getField = function (prop) {\n        return prop.replace(/\\./g, '/');\n    };\n    ODataAdaptor.prototype.generateBodyContent = function (arr, e, stat, dm) {\n        var req = '';\n        for (var i = 0; i < arr.length; i++) {\n            req += '\\n' + e.cSet + '\\n';\n            req += this.options.changeSetContent + '\\n\\n';\n            req += stat.method;\n            if (stat.method === 'POST ') {\n                req += (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n            }\n            else if (stat.method === 'PUT ' || stat.method === 'PATCH ') {\n                req += (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n            }\n            else if (stat.method === 'DELETE ') {\n                req += (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n            }\n            req += 'Accept: ' + this.options.accept + '\\n';\n            req += 'Content-Id: ' + this.pvt.changeSet++ + '\\n';\n            req += this.options.batchChangeSetContentType + '\\n';\n            if (!isNullOrUndefined(arr[i]['@odata.etag'])) {\n                req += 'If-Match: ' + arr[i]['@odata.etag'] + '\\n\\n';\n                delete arr[i]['@odata.etag'];\n            }\n            else {\n                req += '\\n';\n            }\n            req += stat.data(arr, i);\n        }\n        return req;\n    };\n    ODataAdaptor.prototype.processBatchResponse = function (data, query, xhr, request, changes) {\n        if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n            return (query.isCountRequired ? { result: [], count: 0 } : []);\n        }\n        if (request && this.options.batch && DataUtil.endsWith(request.url, this.options.batch) && request.type.toLowerCase() === 'post') {\n            var guid = xhr.getResponseHeader('Content-Type');\n            var cIdx = void 0;\n            var jsonObj = void 0;\n            var d = data + '';\n            guid = guid.substring(guid.indexOf('=batchresponse') + 1);\n            d = d.split(guid);\n            if (d.length < 2) {\n                return {};\n            }\n            d = d[1];\n            var exVal = /(?:\\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(d);\n            if (exVal) {\n                d.replace(exVal[0], '');\n            }\n            var changeGuid = exVal ? exVal[1] : '';\n            d = d.split(changeGuid);\n            for (var i = d.length; i > -1; i--) {\n                if (!/\\bContent-ID:/i.test(d[i]) || !/\\bHTTP.+201/.test(d[i])) {\n                    continue;\n                }\n                cIdx = parseInt(/\\bContent-ID: (\\d+)/i.exec(d[i])[1], 10);\n                if (changes.addedRecords[cIdx]) {\n                    jsonObj = DataUtil.parse.parseJson(/^\\{.+\\}/m.exec(d[i])[0]);\n                    extend({}, changes.addedRecords[cIdx], this.processResponse(jsonObj));\n                }\n            }\n            return changes;\n        }\n        return null;\n    };\n    ODataAdaptor.prototype.compareAndRemove = function (data, original, key) {\n        var _this = this;\n        if (isNullOrUndefined(original)) {\n            return data;\n        }\n        Object.keys(data).forEach(function (prop) {\n            if (prop !== key && prop !== '@odata.etag') {\n                if (DataUtil.isPlainObject(data[prop])) {\n                    _this.compareAndRemove(data[prop], original[prop]);\n                    var final = Object.keys(data[prop]).filter(function (data) { return data !== '@odata.etag'; });\n                    if (final.length === 0) {\n                        delete data[prop];\n                    }\n                }\n                else if (data[prop] === original[prop]) {\n                    delete data[prop];\n                }\n                else if (data[prop] && original[prop] && data[prop].valueOf() === original[prop].valueOf()) {\n                    delete data[prop];\n                }\n            }\n        });\n        return data;\n    };\n    return ODataAdaptor;\n}(UrlAdaptor));\nexport { ODataAdaptor };\n/**\n * The OData v4 is an improved version of OData protocols.\n * The DataManager uses the ODataV4Adaptor to consume OData v4 services.\n * @hidden\n */\nvar ODataV4Adaptor = /** @class */ (function (_super) {\n    __extends(ODataV4Adaptor, _super);\n    function ODataV4Adaptor(props) {\n        var _this = _super.call(this, props) || this;\n        // options replaced the default adaptor options\n        _this.options = extend({}, _this.options, {\n            requestType: 'get',\n            accept: 'application/json, text/javascript, */*; q=0.01',\n            multipartAccept: 'multipart/mixed',\n            sortBy: '$orderby',\n            select: '$select',\n            skip: '$skip',\n            take: '$top',\n            count: '$count',\n            search: '$search',\n            where: '$filter',\n            expand: '$expand',\n            batch: '$batch',\n            changeSet: '--changeset_',\n            batchPre: 'batch_',\n            contentId: 'Content-Id: ',\n            batchContent: 'Content-Type: multipart/mixed; boundary=',\n            changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n            batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n            updateType: 'PATCH',\n            localTime: false,\n            apply: '$apply'\n        });\n        extend(_this.options, props || {});\n        return _this;\n    }\n    /**\n     * @hidden\n     */\n    ODataV4Adaptor.prototype.getModuleName = function () {\n        return 'ODataV4Adaptor';\n    };\n    /**\n     * Returns the query string which requests total count from the data source.\n     * @param  {boolean} e\n     * @returns string\n     */\n    ODataV4Adaptor.prototype.onCount = function (e) {\n        return e === true ? 'true' : '';\n    };\n    /**\n     * Generate request string based on the filter criteria from query.\n     * @param  {Predicate} pred\n     * @param  {boolean} requiresCast?\n     */\n    ODataV4Adaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n        var returnValue = '';\n        var val = predicate.value;\n        var isDate = val instanceof Date;\n        if (query instanceof Query) {\n            var queries = this.getQueryRequest(query);\n            for (var i = 0; i < queries.filters.length; i++) {\n                if (queries.filters[i].e.key === predicate.value) {\n                    requiresCast = true;\n                }\n            }\n        }\n        returnValue = _super.prototype.onPredicate.call(this, predicate, query, requiresCast);\n        if (isDate) {\n            returnValue = returnValue.replace(/datetime'(.*)'$/, '$1');\n        }\n        if (DataUtil.parse.isGuid(val)) {\n            returnValue = returnValue.replace('guid', '').replace(/'/g, '');\n        }\n        return returnValue;\n    };\n    /**\n     *  Generate query string based on the multiple search criteria from query.\n     * @param  {{fields:string[]} e\n     * @param  {string} operator\n     * @param  {string} key\n     * @param  {boolean}} ignoreCase\n     */\n    ODataV4Adaptor.prototype.onEachSearch = function (e) {\n        var search = this.pvt.searches || [];\n        search.push(e.key);\n        this.pvt.searches = search;\n    };\n    /**\n     *  Generate query string based on the search criteria from query.\n     * @param  {Object} e\n     */\n    ODataV4Adaptor.prototype.onSearch = function (e) {\n        return this.pvt.searches.join(' OR ');\n    };\n    /**\n     * Returns the expand query string.\n     * @param  {string} e\n     */\n    ODataV4Adaptor.prototype.onExpand = function (e) {\n        var _this = this;\n        var selected = {};\n        var expanded = {};\n        var expands = e.expands.slice();\n        var exArr = [];\n        var selects = e.selects.filter(function (item) { return item.indexOf('.') > -1; });\n        selects.forEach(function (select) {\n            var splits = select.split('.');\n            if (!(splits[0] in selected)) {\n                selected[splits[0]] = [];\n            }\n            selected[splits[0]].push(splits[1]);\n        });\n        //Auto expand from select query\n        Object.keys(selected).forEach(function (expand) {\n            if ((expands.indexOf(expand) === -1)) {\n                expands.push(expand);\n            }\n        });\n        expands.forEach(function (expand) {\n            expanded[expand] = expand in selected ? expand + \"(\" + _this.options.select + \"=\" + selected[expand].join(',') + \")\" : expand;\n        });\n        Object.keys(expanded).forEach(function (ex) { return exArr.push(expanded[ex]); });\n        return exArr.join(',');\n    };\n    /**\n     * Returns the groupby query string.\n     * @param  {string} e\n     */\n    ODataV4Adaptor.prototype.onDistinct = function (distinctFields) {\n        var fields = distinctFields.map(function (field) { return ODataAdaptor.getField(field); }).join(',');\n        return \"groupby((\" + fields + \"))\";\n    };\n    /**\n     * Returns the select query string.\n     * @param  {string[]} e\n     */\n    ODataV4Adaptor.prototype.onSelect = function (e) {\n        return _super.prototype.onSelect.call(this, e.filter(function (item) { return item.indexOf('.') === -1; }));\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings\n     * @returns void\n     */\n    ODataV4Adaptor.prototype.beforeSend = function (dm, request, settings) {\n        if (settings.type === 'POST' || settings.type === 'PUT' || settings.type === 'PATCH') {\n            request.setRequestHeader('Prefer', 'return=representation');\n        }\n        request.setRequestHeader('Accept', this.options.accept);\n    };\n    /**\n     * Returns the data from the query processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     * @returns aggregateResult\n     */\n    ODataV4Adaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        var metaName = '@odata.context';\n        if ((request && request.type === 'GET') && !this.rootUrl && data[metaName]) {\n            var dataUrl = data[metaName].split('/$metadata#');\n            this.rootUrl = dataUrl[0];\n            this.resourceTableName = dataUrl[1];\n        }\n        var pvtData = 'pvtData';\n        var pvt = request && request[pvtData];\n        var emptyAndBatch = _super.prototype.processBatchResponse.call(this, data, query, xhr, request, changes);\n        if (emptyAndBatch) {\n            return emptyAndBatch;\n        }\n        var count = null;\n        var dataCount = '@odata.count';\n        if (query && query.isCountRequired) {\n            if (dataCount in data) {\n                count = data[dataCount];\n            }\n        }\n        data = !isNullOrUndefined(data.value) ? data.value : data;\n        var args = {};\n        args.count = count;\n        args.result = data;\n        this.getAggregateResult(pvt, data, args, null, query);\n        return DataUtil.isNull(count) ? args.result : { result: args.result, count: count, aggregates: args.aggregates };\n    };\n    return ODataV4Adaptor;\n}(ODataAdaptor));\nexport { ODataV4Adaptor };\n/**\n * The Web API is a programmatic interface to define the request and response messages system that is mostly exposed in JSON or XML.\n * The DataManager uses the WebApiAdaptor to consume Web API.\n * Since this adaptor is targeted to interact with Web API created using OData endpoint, it is extended from ODataAdaptor\n * @hidden\n */\nvar WebApiAdaptor = /** @class */ (function (_super) {\n    __extends(WebApiAdaptor, _super);\n    function WebApiAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    WebApiAdaptor.prototype.getModuleName = function () {\n        return 'WebApiAdaptor';\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName?\n     */\n    WebApiAdaptor.prototype.insert = function (dm, data, tableName) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.url,\n            data: JSON.stringify(data)\n        };\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {number} value\n     * @param  {string} tableName?\n     */\n    WebApiAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        return {\n            type: 'DELETE',\n            url: dm.dataSource.url + '/' + value,\n            data: JSON.stringify(value)\n        };\n    };\n    /**\n     * Prepare and return request body which is used to update record.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     */\n    WebApiAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n        return {\n            type: 'PUT',\n            url: dm.dataSource.url,\n            data: JSON.stringify(value)\n        };\n    };\n    WebApiAdaptor.prototype.batchRequest = function (dm, changes, e) {\n        var _this = this;\n        var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n        var url = dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n        e.url = this.resourceTableName ? this.resourceTableName : e.url;\n        var req = [];\n        var _loop_1 = function (i, x) {\n            changes.addedRecords.forEach(function (j, d) {\n                var stat = {\n                    'method': 'POST ',\n                    'url': function (data, i, key) { return ''; },\n                    'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n                };\n                req.push('--' + initialGuid);\n                req.push('Content-Type: application/http; msgtype=request', '');\n                req.push('POST ' + '/api/' + (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url)\n                    + stat.url(changes.addedRecords, i, e.key) + ' HTTP/1.1');\n                req.push('Content-Type: ' + 'application/json; charset=utf-8');\n                req.push('Host: ' + location.host);\n                req.push('', j ? JSON.stringify(j) : '');\n            });\n        };\n        //insertion\n        for (var i = 0, x = changes.addedRecords.length; i < x; i++) {\n            _loop_1(i, x);\n        }\n        var _loop_2 = function (i, x) {\n            changes.changedRecords.forEach(function (j, d) {\n                var stat = {\n                    'method': _this.options.updateType + ' ',\n                    'url': function (data, i, key) { return ''; },\n                    'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n                };\n                req.push('--' + initialGuid);\n                req.push('Content-Type: application/http; msgtype=request', '');\n                req.push('PUT ' + '/api/' + (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url)\n                    + stat.url(changes.changedRecords, i, e.key) + ' HTTP/1.1');\n                req.push('Content-Type: ' + 'application/json; charset=utf-8');\n                req.push('Host: ' + location.host);\n                req.push('', j ? JSON.stringify(j) : '');\n            });\n        };\n        //updation \n        for (var i = 0, x = changes.changedRecords.length; i < x; i++) {\n            _loop_2(i, x);\n        }\n        var _loop_3 = function (i, x) {\n            changes.deletedRecords.forEach(function (j, d) {\n                var state = {\n                    'mtd': 'DELETE ',\n                    'url': function (data, i, key) {\n                        var url = DataUtil.getObject(key, data[i]);\n                        if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n                            return '/' + url;\n                        }\n                        else if (url instanceof Date) {\n                            var datTime = data[i][key];\n                            return '/' + datTime.toJSON();\n                        }\n                        else {\n                            return \"/'\" + url + \"'\";\n                        }\n                    },\n                    'data': function (data, i) { return ''; }\n                };\n                req.push('--' + initialGuid);\n                req.push('Content-Type: application/http; msgtype=request', '');\n                req.push('DELETE ' + '/api/' + (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url)\n                    + state.url(changes.deletedRecords, i, e.key) + ' HTTP/1.1');\n                req.push('Content-Type: ' + 'application/json; charset=utf-8');\n                req.push('Host: ' + location.host);\n                req.push('', j ? JSON.stringify(j) : '');\n            });\n        };\n        //deletion\n        for (var i = 0, x = changes.deletedRecords.length; i < x; i++) {\n            _loop_3(i, x);\n        }\n        req.push('--' + initialGuid + '--', '');\n        return {\n            type: 'POST',\n            url: url,\n            contentType: 'multipart/mixed; boundary=' + initialGuid,\n            data: req.join('\\r\\n')\n        };\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings\n     * @returns void\n     */\n    WebApiAdaptor.prototype.beforeSend = function (dm, request, settings) {\n        request.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');\n    };\n    /**\n     * Returns the data from the query processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     * @returns aggregateResult\n     */\n    WebApiAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        var pvtData = 'pvtData';\n        var pvt = request && request[pvtData];\n        var count = null;\n        var args = {};\n        if (request && request.type.toLowerCase() !== 'post') {\n            var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n            var version = (versionCheck && parseInt(versionCheck, 10)) || 2;\n            if (query && query.isCountRequired) {\n                if (!DataUtil.isNull(data.Count)) {\n                    count = data.Count;\n                }\n            }\n            if (version < 3 && data.Items) {\n                data = data.Items;\n            }\n            args.count = count;\n            args.result = data;\n            this.getAggregateResult(pvt, data, args, null, query);\n        }\n        args.result = args.result || data;\n        return DataUtil.isNull(count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n    };\n    return WebApiAdaptor;\n}(ODataAdaptor));\nexport { WebApiAdaptor };\n/**\n * WebMethodAdaptor can be used by DataManager to interact with web method.\n * @hidden\n */\nvar WebMethodAdaptor = /** @class */ (function (_super) {\n    __extends(WebMethodAdaptor, _super);\n    function WebMethodAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Prepare the request body based on the query.\n     * The query information can be accessed at the WebMethod using variable named `value`.\n     * @param  {DataManager} dm\n     * @param  {Query} query\n     * @param  {Object[]} hierarchyFilters?\n     * @returns application\n     */\n    WebMethodAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n        var obj = new UrlAdaptor().processQuery(dm, query, hierarchyFilters);\n        var getData = 'data';\n        var data = DataUtil.parse.parseJson(obj[getData]);\n        var result = {};\n        var value = 'value';\n        if (data.param) {\n            for (var i = 0; i < data.param.length; i++) {\n                var param = data.param[i];\n                var key = Object.keys(param)[0];\n                result[key] = param[key];\n            }\n        }\n        result[value] = data;\n        var pvtData = 'pvtData';\n        var url = 'url';\n        return {\n            data: JSON.stringify(result),\n            url: obj[url],\n            pvtData: obj[pvtData],\n            type: 'POST',\n            contentType: 'application/json; charset=utf-8'\n        };\n    };\n    return WebMethodAdaptor;\n}(UrlAdaptor));\nexport { WebMethodAdaptor };\n/**\n * RemoteSaveAdaptor, extended from JsonAdaptor and it is used for binding local data and performs all DataManager queries in client-side.\n * It interacts with server-side only for CRUD operations.\n * @hidden\n */\nvar RemoteSaveAdaptor = /** @class */ (function (_super) {\n    __extends(RemoteSaveAdaptor, _super);\n    /**\n     * @hidden\n     */\n    function RemoteSaveAdaptor() {\n        var _this = _super.call(this) || this;\n        setValue('beforeSend', UrlAdaptor.prototype.beforeSend, _this);\n        return _this;\n    }\n    RemoteSaveAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n        this.pvt.position = position;\n        this.updateType = 'add';\n        return {\n            url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: data,\n                table: tableName,\n                action: 'insert'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.remove = function (dm, keyField, val, tableName, query) {\n        _super.prototype.remove.call(this, dm, keyField, val);\n        return {\n            type: 'POST',\n            url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                key: val,\n                keyColumn: keyField,\n                table: tableName,\n                action: 'remove'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.update = function (dm, keyField, val, tableName, query) {\n        this.updateType = 'update';\n        this.updateKey = keyField;\n        return {\n            type: 'POST',\n            url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: val,\n                action: 'update',\n                keyColumn: keyField,\n                key: val[keyField],\n                table: tableName\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes, e) {\n        var i;\n        data = request ? JSON.parse(request.data) : data;\n        if (this.updateType === 'add') {\n            _super.prototype.insert.call(this, ds, data, null, null, this.pvt.position);\n        }\n        if (this.updateType === 'update') {\n            _super.prototype.update.call(this, ds, this.updateKey, data);\n        }\n        this.updateType = undefined;\n        if (data.added) {\n            for (i = 0; i < data.added.length; i++) {\n                _super.prototype.insert.call(this, ds, data.added[i]);\n            }\n        }\n        if (data.changed) {\n            for (i = 0; i < data.changed.length; i++) {\n                _super.prototype.update.call(this, ds, e.key, data.changed[i]);\n            }\n        }\n        if (data.deleted) {\n            for (i = 0; i < data.deleted.length; i++) {\n                _super.prototype.remove.call(this, ds, e.key, data.deleted[i]);\n            }\n        }\n        return data;\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * Also perform the changes in the locally cached data to sync with the remote data.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     */\n    RemoteSaveAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            contentType: 'application/json; charset=utf-8',\n            dataType: 'json',\n            data: JSON.stringify(extend({}, {\n                changed: changes.changedRecords,\n                added: changes.addedRecords,\n                deleted: changes.deletedRecords,\n                action: 'batch',\n                table: e.url,\n                key: e.key\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.addParams = function (options) {\n        var urlParams = new UrlAdaptor();\n        urlParams.addParams(options);\n    };\n    return RemoteSaveAdaptor;\n}(JsonAdaptor));\nexport { RemoteSaveAdaptor };\n/**\n * Ajax Adaptor that is extended from URL Adaptor, is used for handle data operations with user defined functions.\n * @hidden\n */\nvar AjaxAdaptor = /** @class */ (function (_super) {\n    __extends(AjaxAdaptor, _super);\n    function AjaxAdaptor(props) {\n        var _this = _super.call(this) || this;\n        // options replaced the default adaptor options\n        _this.options = extend({}, _this.options, {\n            getData: new Function(),\n            addRecord: new Function(),\n            updateRecord: new Function(),\n            deleteRecord: new Function(),\n            batchUpdate: new Function()\n        });\n        extend(_this.options, props || {});\n        return _this;\n    }\n    AjaxAdaptor.prototype.getModuleName = function () {\n        return 'AjaxAdaptor';\n    };\n    return AjaxAdaptor;\n}(UrlAdaptor));\nexport { AjaxAdaptor };\n/**\n * Cache Adaptor is used to cache the data of the visited pages. It prevents new requests for the previously visited pages.\n * You can configure cache page size and duration of caching by using cachingPageSize and timeTillExpiration properties of the DataManager\n * @hidden\n */\nvar CacheAdaptor = /** @class */ (function (_super) {\n    __extends(CacheAdaptor, _super);\n    /**\n     * Constructor for CacheAdaptor class.\n     * @param  {CacheAdaptor} adaptor?\n     * @param  {number} timeStamp?\n     * @param  {number} pageSize?\n     * @hidden\n     */\n    function CacheAdaptor(adaptor, timeStamp, pageSize) {\n        var _this = _super.call(this) || this;\n        _this.isCrudAction = false;\n        _this.isInsertAction = false;\n        if (!isNullOrUndefined(adaptor)) {\n            _this.cacheAdaptor = adaptor;\n        }\n        _this.pageSize = pageSize;\n        _this.guidId = DataUtil.getGuid('cacheAdaptor');\n        var obj = { keys: [], results: [] };\n        window.localStorage.setItem(_this.guidId, JSON.stringify(obj));\n        var guid = _this.guidId;\n        if (!isNullOrUndefined(timeStamp)) {\n            setInterval(function () {\n                var data;\n                data = DataUtil.parse.parseJson(window.localStorage.getItem(guid));\n                var forDel = [];\n                for (var i = 0; i < data.results.length; i++) {\n                    var currentTime = +new Date();\n                    var requestTime = +new Date(data.results[i].timeStamp);\n                    data.results[i].timeStamp = currentTime - requestTime;\n                    if (currentTime - requestTime > timeStamp) {\n                        forDel.push(i);\n                    }\n                }\n                for (var i = 0; i < forDel.length; i++) {\n                    data.results.splice(forDel[i], 1);\n                    data.keys.splice(forDel[i], 1);\n                }\n                window.localStorage.removeItem(guid);\n                window.localStorage.setItem(guid, JSON.stringify(data));\n            }, timeStamp);\n        }\n        return _this;\n    }\n    /**\n     * It will generate the key based on the URL when we send a request to server.\n     * @param  {string} url\n     * @param  {Query} query?\n     * @hidden\n     */\n    CacheAdaptor.prototype.generateKey = function (url, query) {\n        var queries = this.getQueryRequest(query);\n        var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n        var key = url;\n        var page = 'onPage';\n        if (page in singles) {\n            key += singles[page].pageIndex;\n        }\n        queries.sorts.forEach(function (obj) {\n            key += obj.e.direction + obj.e.fieldName;\n        });\n        queries.groups.forEach(function (obj) {\n            key += obj.e.fieldName;\n        });\n        queries.searches.forEach(function (obj) {\n            key += obj.e.searchKey;\n        });\n        for (var filter = 0; filter < queries.filters.length; filter++) {\n            var currentFilter = queries.filters[filter];\n            if (currentFilter.e.isComplex) {\n                var newQuery = query.clone();\n                newQuery.queries = [];\n                for (var i = 0; i < currentFilter.e.predicates.length; i++) {\n                    newQuery.queries.push({ fn: 'onWhere', e: currentFilter.e.predicates[i], filter: query.queries.filter });\n                }\n                key += currentFilter.e.condition + this.generateKey(url, newQuery);\n            }\n            else {\n                key += currentFilter.e.field + currentFilter.e.operator + currentFilter.e.value;\n            }\n        }\n        return key;\n    };\n    /**\n     * Process the query to generate request body.\n     * If the data is already cached, it will return the cached data.\n     * @param  {DataManager} dm\n     * @param  {Query} query?\n     * @param  {Object[]} hierarchyFilters?\n     */\n    CacheAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n        var key = this.generateKey(dm.dataSource.url, query);\n        var cachedItems;\n        cachedItems = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n        var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(key)] : null;\n        if (data != null && !this.isCrudAction && !this.isInsertAction) {\n            return data;\n        }\n        this.isCrudAction = null;\n        this.isInsertAction = null;\n        return this.cacheAdaptor.processQuery.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n    };\n    /**\n     * Returns the data from the query processing.\n     * It will also cache the data for later usage.\n     * @param  {DataResult} data\n     * @param  {DataManager} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     */\n    CacheAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        if (this.isInsertAction || (request && this.cacheAdaptor.options.batch &&\n            DataUtil.endsWith(request.url, this.cacheAdaptor.options.batch) && request.type.toLowerCase() === 'post')) {\n            return this.cacheAdaptor.processResponse(data, ds, query, xhr, request, changes);\n        }\n        data = this.cacheAdaptor.processResponse.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n        var key = query ? this.generateKey(ds.dataSource.url, query) : ds.dataSource.url;\n        var obj = {};\n        obj = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n        var index = obj.keys.indexOf(key);\n        if (index !== -1) {\n            obj.results.splice(index, 1);\n            obj.keys.splice(index, 1);\n        }\n        obj.results[obj.keys.push(key) - 1] = { keys: key, result: data.result, timeStamp: new Date(), count: data.count };\n        while (obj.results.length > this.pageSize) {\n            obj.results.splice(0, 1);\n            obj.keys.splice(0, 1);\n        }\n        window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n        return data;\n    };\n    /**\n     * Method will trigger before send the request to server side. Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings?\n     */\n    CacheAdaptor.prototype.beforeSend = function (dm, request, settings) {\n        if (!isNullOrUndefined(this.cacheAdaptor.options.batch) && DataUtil.endsWith(settings.url, this.cacheAdaptor.options.batch)\n            && settings.type.toLowerCase() === 'post') {\n            request.setRequestHeader('Accept', this.cacheAdaptor.options.multipartAccept);\n        }\n        if (!dm.dataSource.crossDomain) {\n            request.setRequestHeader('Accept', this.cacheAdaptor.options.accept);\n        }\n    };\n    /**\n     * Updates existing record and saves the changes to the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName\n     */\n    CacheAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n        this.isCrudAction = true;\n        return this.cacheAdaptor.update(dm, keyField, value, tableName);\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName?\n     */\n    CacheAdaptor.prototype.insert = function (dm, data, tableName) {\n        this.isInsertAction = true;\n        return this.cacheAdaptor.insert(dm, data, tableName);\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     */\n    CacheAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        this.isCrudAction = true;\n        return this.cacheAdaptor.remove(dm, keyField, value, tableName);\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     */\n    CacheAdaptor.prototype.batchRequest = function (dm, changes, e) {\n        return this.cacheAdaptor.batchRequest(dm, changes, e);\n    };\n    return CacheAdaptor;\n}(UrlAdaptor));\nexport { CacheAdaptor };\n"],"mappings":"AAAA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;EACrD,IAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;IAChCF,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;MAAEC,SAAS,EAAE;IAAb,aAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;MAAED,CAAC,CAACI,SAAF,GAAcH,CAAd;IAAkB,CAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;MAAE,KAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;IAAc,CAF9E;;IAGA,OAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;EACH,CALD;;EAMA,OAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;IACnBF,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;IACA,SAASO,EAAT,GAAc;MAAE,KAAKC,WAAL,GAAmBT,CAAnB;IAAuB;;IACvCA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;EACH,CAJD;AAKH,CAZ2C,EAA5C;;AAaA,SAASI,KAAT,EAAgBC,MAAhB,EAAwBC,iBAAxB,EAA2CC,QAA3C,EAAqDC,QAArD,QAAqE,sBAArE;AACA,SAASC,QAAT,QAAyB,QAAzB;AACA,SAASC,KAAT,EAAgBC,SAAhB,QAAiC,SAAjC;AACA,IAAIC,MAAM,GAAG;EAAEC,SAAS,EAAE;AAAb,CAAb;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,OAAO;AAAG;AAAe,YAAY;EACrC;AACJ;AACA;AACA;AACA;AACA;EACI,SAASA,OAAT,CAAiBC,EAAjB,EAAqB;IACjB;IACA,KAAKC,OAAL,GAAe;MACXC,IAAI,EAAE,OADK;MAEXC,WAAW,EAAE,MAFF;MAGXC,MAAM,EAAE,QAHG;MAIXC,MAAM,EAAE,QAJG;MAKXC,IAAI,EAAE,MALK;MAMXC,KAAK,EAAE,OANI;MAOXC,IAAI,EAAE,MAPK;MAQXC,MAAM,EAAE,QARG;MASXC,KAAK,EAAE,gBATI;MAUXC,KAAK,EAAE,OAVI;MAWXC,UAAU,EAAE,YAXD;MAYXC,MAAM,EAAE;IAZG,CAAf;IAcA;AACR;AACA;AACA;;IACQ,KAAKC,IAAL,GAAYf,OAAZ;IACA,KAAKgB,UAAL,GAAkBf,EAAlB;IACA,KAAKgB,GAAL,GAAW,EAAX;EACH;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIjB,OAAO,CAACZ,SAAR,CAAkB8B,eAAlB,GAAoC,UAAUC,IAAV,EAAgBlB,EAAhB,EAAoBmB,KAApB,EAA2BC,GAA3B,EAAgC;IAChE,OAAOF,IAAP;EACH,CAFD;;EAGA,OAAOnB,OAAP;AACH,CA3C4B,EAA7B;;AA4CA,SAASA,OAAT;AACA;AACA;AACA;AACA;;AACA,IAAIsB,WAAW;AAAG;AAAe,UAAUC,MAAV,EAAkB;EAC/C/C,SAAS,CAAC8C,WAAD,EAAcC,MAAd,CAAT;;EACA,SAASD,WAAT,GAAuB;IACnB,OAAOC,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACC,KAAP,CAAa,IAAb,EAAmBC,SAAnB,CAAnB,IAAoD,IAA3D;EACH;EACD;AACJ;AACA;AACA;AACA;AACA;;;EACIH,WAAW,CAAClC,SAAZ,CAAsBsC,YAAtB,GAAqC,UAAUC,WAAV,EAAuBP,KAAvB,EAA8B;IAC/D,IAAIQ,MAAM,GAAGD,WAAW,CAACX,UAAZ,CAAuBa,IAAvB,CAA4BC,KAA5B,CAAkC,CAAlC,CAAb;IACA,IAAInB,KAAK,GAAGiB,MAAM,CAACG,MAAnB;IACA,IAAIC,QAAQ,GAAG,IAAf;IACA,IAAIC,GAAJ;IACA,IAAIC,GAAJ;IACA,IAAIC,QAAQ,GAAG,EAAf;IACA,IAAIC,QAAQ,GAAG,CAAf;IACA,IAAI5B,KAAK,GAAG,EAAZ;IACA,IAAI6B,IAAJ;;IACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,KAAK,CAACe,QAAN,CAAeJ,MAAnC,EAA2CO,CAAC,EAA5C,EAAgD;MAC5CF,QAAQ;MACRD,QAAQ,CAACf,KAAK,CAACe,QAAN,CAAeG,CAAf,EAAkBJ,GAAnB,CAAR,GAAkCd,KAAK,CAACe,QAAN,CAAeG,CAAf,EAAkBC,KAApD;IACH;;IACD,IAAIC,GAAG,GAAG,EAAV;;IACA,KAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,KAAK,CAACqB,OAAN,CAAcV,MAAlC,EAA0CO,CAAC,EAA3C,EAA+C;MAC3CJ,GAAG,GAAGd,KAAK,CAACqB,OAAN,CAAcH,CAAd,CAAN;;MACA,IAAI,CAACJ,GAAG,CAACQ,EAAJ,KAAW,QAAX,IAAuBR,GAAG,CAACQ,EAAJ,KAAW,SAAnC,KAAiDtB,KAAK,CAACe,QAAN,CAAeJ,MAApE,EAA4E;QACxE,IAAIG,GAAG,CAACQ,EAAJ,KAAW,SAAf,EAA0B;UACtBlC,KAAK,CAACmC,IAAN,CAAWT,GAAG,CAACU,CAAf;QACH;;QACD,IAAIV,GAAG,CAACQ,EAAJ,KAAW,QAAf,EAAyB;UACrBL,IAAI,GAAGH,GAAG,CAACU,CAAX;QACH;;QACD;MACH;;MACDX,GAAG,GAAG,KAAKC,GAAG,CAACQ,EAAT,EAAaG,IAAb,CAAkB,IAAlB,EAAwBjB,MAAxB,EAAgCM,GAAG,CAACU,CAApC,EAAuCxB,KAAvC,CAAN;;MACA,IAAIc,GAAG,CAACQ,EAAJ,KAAW,cAAf,EAA+B;QAC3BF,GAAG,CAACN,GAAG,CAACU,CAAJ,CAAME,KAAN,GAAc,KAAd,GAAsBZ,GAAG,CAACU,CAAJ,CAAM7B,IAA7B,CAAH,GAAwCkB,GAAxC;MACH,CAFD,MAGK;QACDL,MAAM,GAAGK,GAAG,KAAKc,SAAR,GAAoBd,GAApB,GAA0BL,MAAnC;MACH;;MACD,IAAIM,GAAG,CAACQ,EAAJ,KAAW,QAAX,IAAuBR,GAAG,CAACQ,EAAJ,KAAW,QAAlC,IAA8CR,GAAG,CAACQ,EAAJ,KAAW,QAAzD,IAAqER,GAAG,CAACQ,EAAJ,KAAW,SAApF,EAA+F;QAC3FV,QAAQ,GAAG,KAAX;MACH;;MACD,IAAIA,QAAJ,EAAc;QACVrB,KAAK,GAAGiB,MAAM,CAACG,MAAf;MACH;IACJ;;IACD,IAAIK,QAAJ,EAAc;MACV,IAAIY,IAAI,GAAG;QACP5B,KAAK,EAAEA,KADA;QACOe,QAAQ,EAAEA,QADjB;QAC2BP,MAAM,EAAEA,MADnC;QAC2CpB,KAAK,EAAEA,KADlD;QACyD6B,IAAI,EAAEA;MAD/D,CAAX;MAGA,IAAIY,YAAY,GAAG,KAAKC,aAAL,CAAmBF,IAAnB,CAAnB;MACApB,MAAM,GAAGqB,YAAY,CAACrB,MAAtB;MACAjB,KAAK,GAAGsC,YAAY,CAACtC,KAArB;IACH;;IACD,IAAIS,KAAK,CAAC+B,eAAV,EAA2B;MACvBvB,MAAM,GAAG;QACLA,MAAM,EAAEA,MADH;QAELjB,KAAK,EAAEA,KAFF;QAGLE,UAAU,EAAE2B;MAHP,CAAT;IAKH;;IACD,OAAOZ,MAAP;EACH,CAxDD;EAyDA;AACJ;AACA;AACA;;;EACIN,WAAW,CAAClC,SAAZ,CAAsB8D,aAAtB,GAAsC,UAAUF,IAAV,EAAgB;IAClD,IAAIrC,KAAK,GAAG,CAAZ;IACA,IAAI6B,GAAG,GAAG,KAAKY,YAAL,CAAkBJ,IAAI,CAAC5B,KAAvB,CAAV;IACA,IAAIQ,MAAM,GAAGoB,IAAI,CAACpB,MAAlB;;IACA,IAAI,CAACpC,iBAAiB,CAACwD,IAAI,CAACb,QAAL,CAAckB,iBAAf,CAAtB,EAAyD;MACrD,IAAIC,GAAG,GAAGN,IAAI,CAACb,QAAL,CAAckB,iBAAxB;;MACA,KAAK,IAAIf,CAAC,GAAGgB,GAAG,CAAC1C,KAAJ,CAAUmB,MAAV,GAAmB,CAAhC,EAAmCO,CAAC,IAAI,CAAxC,EAA2CA,CAAC,EAA5C,EAAgD;QAC5CV,MAAM,GAAG,KAAK2B,OAAL,CAAa3B,MAAb,EAAqB0B,GAAG,CAAC1C,KAAJ,CAAU0B,CAAV,CAArB,CAAT;MACH;;MACD,IAAIU,IAAI,CAACxC,KAAL,CAAWuB,MAAX,KAAsBuB,GAAG,CAACE,KAA9B,EAAqC;QACjC,IAAIV,KAAK,GAAGE,IAAI,CAACxC,KAAL,CAAW8C,GAAG,CAACE,KAAf,EAAsBC,SAAlC;QACA7B,MAAM,GAAGjC,QAAQ,CAACa,KAAT,CAAeoB,MAAf,EAAuBkB,KAAvB,EAA8BN,GAA9B,EAAmC,IAAnC,EAAyC,IAAzC,EAA+CQ,IAAI,CAACxC,KAAL,CAAW,CAAX,EAAckD,QAA7D,EAAuE,IAAvE,CAAT;MACH;;MACD/C,KAAK,GAAGiB,MAAM,CAACG,MAAf;MACA,IAAIZ,IAAI,GAAGS,MAAX;MACAA,MAAM,GAAGA,MAAM,CAACE,KAAP,CAAawB,GAAG,CAAC/C,IAAjB,CAAT;MACAqB,MAAM,GAAGA,MAAM,CAACE,KAAP,CAAa,CAAb,EAAgBwB,GAAG,CAAC7C,IAApB,CAAT;;MACA,IAAIuC,IAAI,CAACxC,KAAL,CAAWuB,MAAX,KAAsBuB,GAAG,CAACE,KAA9B,EAAqC;QACjC,KAAKG,eAAL,CAAqB/B,MAArB,EAA6BT,IAA7B;MACH;IACJ,CAhBD,MAiBK;MACD,IAAI2B,KAAK,GAAGE,IAAI,CAACxC,KAAL,CAAW,CAAX,EAAciD,SAA1B;MACA7B,MAAM,GAAGjC,QAAQ,CAACa,KAAT,CAAeoB,MAAf,EAAuBkB,KAAvB,EAA8BN,GAA9B,EAAmC,IAAnC,EAAyC,IAAzC,EAA+CQ,IAAI,CAACxC,KAAL,CAAW,CAAX,EAAckD,QAA7D,EAAuE,IAAvE,CAAT;MACA/C,KAAK,GAAGiB,MAAM,CAACG,MAAf;MACA,IAAIZ,IAAI,GAAGS,MAAX;;MACA,IAAIoB,IAAI,CAACX,IAAT,EAAe;QACXT,MAAM,GAAG,KAAKgC,MAAL,CAAYhC,MAAZ,EAAoBoB,IAAI,CAACX,IAAzB,EAA+BW,IAAI,CAAC5B,KAApC,CAAT;MACH;;MACD,KAAKuC,eAAL,CAAqB/B,MAArB,EAA6BT,IAA7B;IACH;;IACD,OAAO;MAAES,MAAM,EAAEA,MAAV;MAAkBjB,KAAK,EAAEA;IAAzB,CAAP;EACH,CAhCD;;EAiCAW,WAAW,CAAClC,SAAZ,CAAsBuE,eAAtB,GAAwC,UAAU/B,MAAV,EAAkBT,IAAlB,EAAwB;IAC5D,IAAIS,MAAM,CAACG,MAAP,IAAiBZ,IAAI,CAACY,MAA1B,EAAkC;MAC9B,IAAI8B,GAAG,GAAG,WAAV;MACA,IAAIC,UAAU,GAAG,aAAjB;MACA,IAAIN,KAAK,GAAG,OAAZ;MACA,IAAIO,OAAO,GAAG,SAAd;MACAnC,MAAM,CAACiC,GAAD,CAAN,GAAc1C,IAAI,CAAC0C,GAAD,CAAlB;MACAjC,MAAM,CAACkC,UAAD,CAAN,GAAqB3C,IAAI,CAAC2C,UAAD,CAAzB;MACAlC,MAAM,CAAC4B,KAAD,CAAN,GAAgBrC,IAAI,CAACqC,KAAD,CAApB;MACA5B,MAAM,CAACmC,OAAD,CAAN,GAAkB5C,IAAI,CAAC4C,OAAD,CAAtB;IACH;;IACD,OAAOnC,MAAP;EACH,CAZD;EAaA;AACJ;AACA;AACA;;;EACIN,WAAW,CAAClC,SAAZ,CAAsBgE,YAAtB,GAAqC,UAAUhC,KAAV,EAAiB;IAClD,IAAI4C,QAAQ,GAAGpE,KAAK,CAACqE,aAAN,CAAoB7C,KAAK,CAACqB,OAA1B,EAAmC,cAAnC,CAAf;IACA,IAAID,GAAG,GAAG,EAAV;;IACA,IAAIwB,QAAQ,CAACjC,MAAb,EAAqB;MACjB,IAAImC,GAAG,GAAG,KAAK,CAAf;;MACA,KAAK,IAAI5B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0B,QAAQ,CAACjC,MAA7B,EAAqCO,CAAC,EAAtC,EAA0C;QACtC4B,GAAG,GAAGF,QAAQ,CAAC1B,CAAD,CAAR,CAAYM,CAAlB;QACAJ,GAAG,CAACG,IAAJ,CAAS;UAAE5B,IAAI,EAAEmD,GAAG,CAACnD,IAAZ;UAAkB+B,KAAK,EAAEnD,QAAQ,CAACD,QAAT,CAAkBwE,GAAG,CAACpB,KAAtB,EAA6B1B,KAA7B;QAAzB,CAAT;MACH;IACJ;;IACD,OAAOoB,GAAP;EACH,CAXD;EAYA;AACJ;AACA;AACA;AACA;AACA;;;EACIlB,WAAW,CAAClC,SAAZ,CAAsB+E,YAAtB,GAAqC,UAAUC,EAAV,EAAcC,OAAd,EAAuBzB,CAAvB,EAA0B;IAC3D,IAAIN,CAAJ;IACA,IAAIgC,iBAAiB,GAAGD,OAAO,CAACE,cAAR,CAAuBxC,MAA/C;;IACA,KAAKO,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG+B,OAAO,CAACG,YAAR,CAAqBzC,MAArC,EAA6CO,CAAC,EAA9C,EAAkD;MAC9C,KAAKmC,MAAL,CAAYL,EAAZ,EAAgBC,OAAO,CAACG,YAAR,CAAqBlC,CAArB,CAAhB;IACH;;IACD,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG+B,OAAO,CAACK,cAAR,CAAuB3C,MAAvC,EAA+CO,CAAC,EAAhD,EAAoD;MAChD,KAAKqC,MAAL,CAAYP,EAAZ,EAAgBxB,CAAC,CAACV,GAAlB,EAAuBmC,OAAO,CAACK,cAAR,CAAuBpC,CAAvB,CAAvB;IACH;;IACD,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGgC,iBAAhB,EAAmChC,CAAC,EAApC,EAAwC;MACpC,KAAKsC,MAAL,CAAYR,EAAZ,EAAgBxB,CAAC,CAACV,GAAlB,EAAuBmC,OAAO,CAACE,cAAR,CAAuBjC,CAAvB,CAAvB;IACH;;IACD,OAAO+B,OAAP;EACH,CAbD;EAcA;AACJ;AACA;AACA;AACA;;;EACI/C,WAAW,CAAClC,SAAZ,CAAsBmE,OAAtB,GAAgC,UAAUtD,EAAV,EAAc2C,CAAd,EAAiB;IAC7C,IAAI,CAAC3C,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,OAAOA,EAAE,CAAC4E,MAAH,CAAU,UAAUC,GAAV,EAAe;MAC5B,IAAIlC,CAAJ,EAAO;QACH,OAAOA,CAAC,CAACmC,QAAF,CAAWD,GAAX,CAAP;MACH;IACJ,CAJM,CAAP;EAKH,CATD;EAUA;AACJ;AACA;AACA;AACA;AACA;;;EACIxD,WAAW,CAAClC,SAAZ,CAAsB4F,YAAtB,GAAqC,UAAU/E,EAAV,EAAc2C,CAAd,EAAiB;IAClD,IAAIF,EAAE,GAAG/C,QAAQ,CAACkB,UAAT,CAAoB+B,CAAC,CAAC7B,IAAtB,CAAT;;IACA,IAAI,CAACd,EAAD,IAAO,CAACyC,EAAR,IAAczC,EAAE,CAAC8B,MAAH,KAAc,CAAhC,EAAmC;MAC/B,OAAO,IAAP;IACH;;IACD,OAAOW,EAAE,CAACzC,EAAD,EAAK2C,CAAC,CAACE,KAAP,CAAT;EACH,CAND;EAOA;AACJ;AACA;AACA;AACA;;;EACIxB,WAAW,CAAClC,SAAZ,CAAsB6F,QAAtB,GAAiC,UAAUhF,EAAV,EAAc2C,CAAd,EAAiB;IAC9C,IAAI,CAAC3C,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,IAAI2C,CAAC,CAACsC,UAAF,CAAanD,MAAb,KAAwB,CAA5B,EAA+B;MAC3BpC,QAAQ,CAACwF,YAAT,CAAsBlF,EAAE,CAAC,CAAD,CAAxB,EAA6B2C,CAAC,CAACsC,UAA/B;IACH;;IACD,OAAOjF,EAAE,CAAC4E,MAAH,CAAU,UAAUC,GAAV,EAAe;MAC5B,KAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxC,CAAC,CAACsC,UAAF,CAAanD,MAAjC,EAAyCqD,CAAC,EAA1C,EAA8C;QAC1C,IAAIxC,CAAC,CAACc,QAAF,CAAWb,IAAX,CAAgBiC,GAAhB,EAAqBnF,QAAQ,CAAC0F,SAAT,CAAmBzC,CAAC,CAACsC,UAAF,CAAaE,CAAb,CAAnB,EAAoCN,GAApC,CAArB,EAA+DlC,CAAC,CAAC0C,SAAjE,EAA4E1C,CAAC,CAAC2C,UAA9E,EAA0F3C,CAAC,CAAC4C,YAA5F,CAAJ,EAA+G;UAC3G,OAAO,IAAP;QACH;MACJ;;MACD,OAAO,KAAP;IACH,CAPM,CAAP;EAQH,CAfD;EAgBA;AACJ;AACA;AACA;AACA;AACA;;;EACIlE,WAAW,CAAClC,SAAZ,CAAsBqG,QAAtB,GAAiC,UAAUxF,EAAV,EAAc2C,CAAd,EAAiBxB,KAAjB,EAAwB;IACrD,IAAI,CAACnB,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,IAAIyF,SAAJ;IACA,IAAI5C,KAAK,GAAGnD,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAACa,SAApB,EAA+BrC,KAA/B,CAAZ;;IACA,IAAI,CAAC0B,KAAL,EAAY;MACR,OAAO7C,EAAE,CAAC0F,IAAH,CAAQ/C,CAAC,CAACc,QAAV,CAAP;IACH;;IACD,IAAIZ,KAAK,YAAY/D,KAArB,EAA4B;MACxB+D,KAAK,GAAGA,KAAK,CAAChB,KAAN,CAAY,CAAZ,CAAR;;MACA,KAAK,IAAIQ,CAAC,GAAGQ,KAAK,CAACf,MAAN,GAAe,CAA5B,EAA+BO,CAAC,IAAI,CAApC,EAAuCA,CAAC,EAAxC,EAA4C;QACxC,IAAI,CAACQ,KAAK,CAACR,CAAD,CAAV,EAAe;UACX;QACH;;QACDoD,SAAS,GAAG9C,CAAC,CAACc,QAAd;;QACA,IAAI/D,QAAQ,CAACiG,QAAT,CAAkB9C,KAAK,CAACR,CAAD,CAAvB,EAA4B,OAA5B,CAAJ,EAA0C;UACtCoD,SAAS,GAAG/F,QAAQ,CAACkG,MAAT,CAAgB,YAAhB,CAAZ;UACA/C,KAAK,CAACR,CAAD,CAAL,GAAWQ,KAAK,CAACR,CAAD,CAAL,CAASwD,OAAT,CAAiB,OAAjB,EAA0B,EAA1B,CAAX;QACH;;QACD7F,EAAE,GAAGN,QAAQ,CAACgG,IAAT,CAAc1F,EAAd,EAAkB6C,KAAK,CAACR,CAAD,CAAvB,EAA4BoD,SAA5B,CAAL;MACH;;MACD,OAAOzF,EAAP;IACH;;IACD,OAAON,QAAQ,CAACgG,IAAT,CAAc1F,EAAd,EAAkB6C,KAAlB,EAAyBF,CAAC,CAACc,QAA3B,CAAP;EACH,CAzBD;EA0BA;AACJ;AACA;AACA;AACA;AACA;;;EACIpC,WAAW,CAAClC,SAAZ,CAAsB2G,OAAtB,GAAgC,UAAU9F,EAAV,EAAc2C,CAAd,EAAiBxB,KAAjB,EAAwB;IACpD,IAAI,CAACnB,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,IAAIuC,GAAG,GAAG,KAAKY,YAAL,CAAkBhC,KAAlB,CAAV;IACA,OAAOzB,QAAQ,CAACa,KAAT,CAAeP,EAAf,EAAmBN,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAACa,SAApB,EAA+BrC,KAA/B,CAAnB,EAA0DoB,GAA1D,EAA+D,IAA/D,EAAqE,IAArE,EAA2EI,CAAC,CAACc,QAA7E,CAAP;EACH,CAND;EAOA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACIpC,WAAW,CAAClC,SAAZ,CAAsBwE,MAAtB,GAA+B,UAAU3D,EAAV,EAAc2C,CAAd,EAAiBxB,KAAjB,EAAwB;IACnD,IAAI4E,IAAI,GAAGrG,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAACqD,QAApB,EAA8B7E,KAA9B,CAAX;IACA,IAAI8E,KAAK,GAAG,CAACvG,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAACuD,SAApB,EAA+B/E,KAA/B,IAAwC,CAAzC,IAA8C4E,IAA1D;IACA,IAAII,GAAG,GAAGF,KAAK,GAAGF,IAAlB;;IACA,IAAI,CAAC/F,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,OAAOA,EAAE,CAAC6B,KAAH,CAASoE,KAAT,EAAgBE,GAAhB,CAAP;EACH,CARD;EASA;AACJ;AACA;AACA;AACA;AACA;;;EACI9E,WAAW,CAAClC,SAAZ,CAAsBiH,OAAtB,GAAgC,UAAUpG,EAAV,EAAc2C,CAAd,EAAiB;IAC7C,IAAI,CAAC3C,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,OAAOA,EAAE,CAAC6B,KAAH,CAASnC,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAACsD,KAApB,CAAT,EAAqCvG,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAACwD,GAApB,CAArC,CAAP;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;;;EACI9E,WAAW,CAAClC,SAAZ,CAAsBkH,MAAtB,GAA+B,UAAUrG,EAAV,EAAc2C,CAAd,EAAiB;IAC5C,IAAI,CAAC3C,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,OAAOA,EAAE,CAAC6B,KAAH,CAAS,CAAT,EAAYnC,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAAC2D,GAApB,CAAZ,CAAP;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;;;EACIjF,WAAW,CAAClC,SAAZ,CAAsBoH,MAAtB,GAA+B,UAAUvG,EAAV,EAAc2C,CAAd,EAAiB;IAC5C,IAAI,CAAC3C,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,OAAOA,EAAE,CAAC6B,KAAH,CAASnC,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAAC2D,GAApB,CAAT,CAAP;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;;;EACIjF,WAAW,CAAClC,SAAZ,CAAsBqH,QAAtB,GAAiC,UAAUxG,EAAV,EAAc2C,CAAd,EAAiB;IAC9C,IAAI,CAAC3C,EAAD,IAAO,CAACA,EAAE,CAAC8B,MAAf,EAAuB;MACnB,OAAO9B,EAAP;IACH;;IACD,OAAON,QAAQ,CAACW,MAAT,CAAgBL,EAAhB,EAAoBN,QAAQ,CAACD,QAAT,CAAkBkD,CAAC,CAACsC,UAApB,CAApB,CAAP;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;AACA;;;EACI5D,WAAW,CAAClC,SAAZ,CAAsBqF,MAAtB,GAA+B,UAAUL,EAAV,EAAcjD,IAAd,EAAoBuF,SAApB,EAA+BtF,KAA/B,EAAsCuF,QAAtC,EAAgD;IAC3E,IAAInH,iBAAiB,CAACmH,QAAD,CAArB,EAAiC;MAC7B,OAAOvC,EAAE,CAACpD,UAAH,CAAca,IAAd,CAAmBc,IAAnB,CAAwBxB,IAAxB,CAAP;IACH,CAFD,MAGK;MACD,OAAOiD,EAAE,CAACpD,UAAH,CAAca,IAAd,CAAmB+E,MAAnB,CAA0BD,QAA1B,EAAoC,CAApC,EAAuCxF,IAAvC,CAAP;IACH;EACJ,CAPD;EAQA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIG,WAAW,CAAClC,SAAZ,CAAsBwF,MAAtB,GAA+B,UAAUR,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0C;IACrE,IAAIzG,EAAE,GAAGmE,EAAE,CAACpD,UAAH,CAAca,IAAvB;IACA,IAAIS,CAAJ;;IACA,IAAI,OAAOC,KAAP,KAAiB,QAAjB,IAA6B,EAAEA,KAAK,YAAYuE,IAAnB,CAAjC,EAA2D;MACvDvE,KAAK,GAAG5C,QAAQ,CAAC0F,SAAT,CAAmBwB,QAAnB,EAA6BtE,KAA7B,CAAR;IACH;;IACD,KAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGrC,EAAE,CAAC8B,MAAnB,EAA2BO,CAAC,EAA5B,EAAgC;MAC5B,IAAI3C,QAAQ,CAAC0F,SAAT,CAAmBwB,QAAnB,EAA6B5G,EAAE,CAACqC,CAAD,CAA/B,MAAwCC,KAA5C,EAAmD;QAC/C;MACH;IACJ;;IACD,OAAOD,CAAC,KAAKrC,EAAE,CAAC8B,MAAT,GAAkB9B,EAAE,CAAC2G,MAAH,CAAUtE,CAAV,EAAa,CAAb,CAAlB,GAAoC,IAA3C;EACH,CAZD;EAaA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIhB,WAAW,CAAClC,SAAZ,CAAsBuF,MAAtB,GAA+B,UAAUP,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0C;IACrE,IAAIzG,EAAE,GAAGmE,EAAE,CAACpD,UAAH,CAAca,IAAvB;IACA,IAAIS,CAAJ;IACA,IAAIJ,GAAJ;;IACA,IAAI,CAAC1C,iBAAiB,CAACqH,QAAD,CAAtB,EAAkC;MAC9B3E,GAAG,GAAGxC,QAAQ,CAACmH,QAAD,EAAWtE,KAAX,CAAd;IACH;;IACD,KAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGrC,EAAE,CAAC8B,MAAnB,EAA2BO,CAAC,EAA5B,EAAgC;MAC5B,IAAI,CAAC9C,iBAAiB,CAACqH,QAAD,CAAlB,IAAiCnH,QAAQ,CAACmH,QAAD,EAAW5G,EAAE,CAACqC,CAAD,CAAb,CAAT,KAAgCJ,GAApE,EAAyE;QACrE;MACH;IACJ;;IACD,OAAOI,CAAC,GAAGrC,EAAE,CAAC8B,MAAP,GAAgBzC,KAAK,CAACW,EAAE,CAACqC,CAAD,CAAH,EAAQC,KAAR,CAArB,GAAsC,IAA7C;EACH,CAbD;;EAcA,OAAOjB,WAAP;AACH,CA/WgC,CA+W/BtB,OA/W+B,CAAjC;;AAgXA,SAASsB,WAAT;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIyF,UAAU;AAAG;AAAe,UAAUxF,MAAV,EAAkB;EAC9C/C,SAAS,CAACuI,UAAD,EAAaxF,MAAb,CAAT;;EACA,SAASwF,UAAT,GAAsB;IAClB,OAAOxF,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACC,KAAP,CAAa,IAAb,EAAmBC,SAAnB,CAAnB,IAAoD,IAA3D;EACH;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACI;;;EACAsF,UAAU,CAAC3H,SAAX,CAAqBsC,YAArB,GAAoC,UAAU0C,EAAV,EAAchD,KAAd,EAAqB4F,gBAArB,EAAuC;IACvE,IAAIvE,OAAO,GAAG,KAAKwE,eAAL,CAAqB7F,KAArB,CAAd;IACA,IAAI8F,OAAO,GAAGtH,KAAK,CAACuH,gBAAN,CAAuB/F,KAAK,CAACqB,OAA7B,EAAsC,CAAC,UAAD,EAAa,QAAb,EAAuB,QAAvB,EAAiC,QAAjC,EAA2C,SAA3C,CAAtC,CAAd;IACA,IAAI2E,MAAM,GAAGhG,KAAK,CAACgG,MAAnB;IACA,IAAIC,GAAG,GAAGjD,EAAE,CAACpD,UAAH,CAAcqG,GAAxB;IACA,IAAIC,IAAJ;IACA,IAAI/G,IAAJ;IACA,IAAIE,IAAI,GAAG,IAAX;IACA,IAAIP,OAAO,GAAG,KAAKA,OAAnB;IACA,IAAIqH,OAAO,GAAG;MAAEC,KAAK,EAAE,EAAT;MAAaC,MAAM,EAAE,EAArB;MAAyBC,OAAO,EAAE,EAAlC;MAAsCC,QAAQ,EAAE,EAAhD;MAAoD9G,UAAU,EAAE;IAAhE,CAAd,CATuE,CAUvE;;IACA,IAAI,YAAYqG,OAAhB,EAAyB;MACrBI,IAAI,GAAGJ,OAAO,CAACtD,MAAf;MACArD,IAAI,GAAGZ,QAAQ,CAACD,QAAT,CAAkB4H,IAAI,CAACnB,SAAvB,EAAkC/E,KAAlC,CAAP;MACAX,IAAI,GAAGd,QAAQ,CAACD,QAAT,CAAkB4H,IAAI,CAACrB,QAAvB,EAAiC7E,KAAjC,CAAP;MACAb,IAAI,GAAG,CAACA,IAAI,GAAG,CAAR,IAAaE,IAApB;IACH,CALD,MAMK,IAAI,aAAayG,OAAjB,EAA0B;MAC3BI,IAAI,GAAGJ,OAAO,CAACb,OAAf;MACA9F,IAAI,GAAG+G,IAAI,CAACpB,KAAZ;MACAzF,IAAI,GAAG6G,IAAI,CAAClB,GAAL,GAAWkB,IAAI,CAACpB,KAAvB;IACH,CArBsE,CAsBvE;;;IACA,KAAK,IAAI5D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,OAAO,CAAC+E,KAAR,CAAczF,MAAlC,EAA0CO,CAAC,EAA3C,EAA+C;MAC3CgF,IAAI,GAAG3H,QAAQ,CAACD,QAAT,CAAkB+C,OAAO,CAAC+E,KAAR,CAAclF,CAAd,EAAiBM,CAAjB,CAAmBa,SAArC,EAAgDrC,KAAhD,CAAP;MACAmG,OAAO,CAACC,KAAR,CAAc7E,IAAd,CAAmBhD,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,YAAnC,EAAiD;QAAEC,IAAI,EAAEP,IAAR;QAAcQ,SAAS,EAAErF,OAAO,CAAC+E,KAAR,CAAclF,CAAd,EAAiBM,CAAjB,CAAmBkF;MAA5C,CAAjD,EAA0G1G,KAA1G,CAAnB;IACH,CA1BsE,CA2BvE;;;IACA,IAAI4F,gBAAJ,EAAsB;MAClBM,IAAI,GAAG,KAAKS,cAAL,CAAoBf,gBAApB,EAAsC5F,KAAtC,CAAP;;MACA,IAAIkG,IAAJ,EAAU;QACNC,OAAO,CAACG,OAAR,CAAgB/E,IAAhB,CAAqBhD,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,aAAnC,EAAkDN,IAAI,CAACU,MAAL,EAAlD,EAAiE5G,KAAjE,CAArB;MACH;IACJ,CAjCsE,CAkCvE;;;IACA,KAAK,IAAIkB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,OAAO,CAACiF,OAAR,CAAgB3F,MAApC,EAA4CO,CAAC,EAA7C,EAAiD;MAC7CiF,OAAO,CAACG,OAAR,CAAgB/E,IAAhB,CAAqBhD,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,aAAnC,EAAkDnF,OAAO,CAACiF,OAAR,CAAgBpF,CAAhB,EAAmBM,CAAnB,CAAqBoF,MAArB,EAAlD,EAAiF5G,KAAjF,CAArB;MACA,IAAI6G,MAAM,GAAG,OAAOV,OAAO,CAACG,OAAR,CAAgBpF,CAAhB,CAAP,KAA8B,QAA9B,GAAyC1D,MAAM,CAACsJ,IAAP,CAAYX,OAAO,CAACG,OAAR,CAAgBpF,CAAhB,CAAZ,CAAzC,GAA2E,EAAxF;;MACA,KAAK,IAAI6F,EAAE,GAAG,CAAT,EAAYC,MAAM,GAAGH,MAA1B,EAAkCE,EAAE,GAAGC,MAAM,CAACrG,MAA9C,EAAsDoG,EAAE,EAAxD,EAA4D;QACxD,IAAIE,IAAI,GAAGD,MAAM,CAACD,EAAD,CAAjB;;QACA,IAAIxI,QAAQ,CAAC2I,MAAT,CAAiBf,OAAD,CAAUc,IAAV,CAAhB,CAAJ,EAAsC;UAClC,OAAOd,OAAO,CAACc,IAAD,CAAd;QACH;MACJ;IACJ,CA5CsE,CA6CvE;;;IACA,KAAK,IAAI/F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,OAAO,CAACkF,QAAR,CAAiB5F,MAArC,EAA6CO,CAAC,EAA9C,EAAkD;MAC9CgF,IAAI,GAAG7E,OAAO,CAACkF,QAAR,CAAiBrF,CAAjB,EAAoBM,CAA3B;MACA2E,OAAO,CAACI,QAAR,CAAiBhF,IAAjB,CAAsBhD,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,cAAnC,EAAmD;QACrEW,MAAM,EAAEjB,IAAI,CAACpC,UADwD;QAErEsD,QAAQ,EAAElB,IAAI,CAACkB,QAFsD;QAGrEtG,GAAG,EAAEoF,IAAI,CAAChC,SAH2D;QAIrEC,UAAU,EAAE+B,IAAI,CAAC/B;MAJoD,CAAnD,EAKnBnE,KALmB,CAAtB;IAMH,CAtDsE,CAuDvE;;;IACA,KAAK,IAAIkB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,OAAO,CAACgF,MAAR,CAAe1F,MAAnC,EAA2CO,CAAC,EAA5C,EAAgD;MAC5CiF,OAAO,CAACE,MAAR,CAAe9E,IAAf,CAAoBhD,QAAQ,CAACD,QAAT,CAAkB+C,OAAO,CAACgF,MAAR,CAAenF,CAAf,EAAkBM,CAAlB,CAAoBa,SAAtC,EAAiDrC,KAAjD,CAApB;IACH,CA1DsE,CA2DvE;;;IACA,KAAK,IAAIkB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,OAAO,CAAC5B,UAAR,CAAmBkB,MAAvC,EAA+CO,CAAC,EAAhD,EAAoD;MAChDgF,IAAI,GAAG7E,OAAO,CAAC5B,UAAR,CAAmByB,CAAnB,EAAsBM,CAA7B;MACA2E,OAAO,CAAC1G,UAAR,CAAmB8B,IAAnB,CAAwB;QAAE5B,IAAI,EAAEuG,IAAI,CAACvG,IAAb;QAAmB+B,KAAK,EAAEnD,QAAQ,CAACD,QAAT,CAAkB4H,IAAI,CAACxE,KAAvB,EAA8B1B,KAA9B;MAA1B,CAAxB;IACH;;IACD,IAAIkC,GAAG,GAAG,EAAV;IACA,KAAKmF,eAAL,CAAqBvI,OAArB,EAA8BkB,KAA9B,EAAqC8F,OAArC,EAA8CK,OAA9C,EAAuDjE,GAAvD,EAjEuE,CAkEvE;;IACA3D,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,WAAnC,EAAgD;MAAExD,EAAE,EAAEA,EAAN;MAAUhD,KAAK,EAAEA,KAAjB;MAAwBgG,MAAM,EAAEA,MAAhC;MAAwCsB,SAAS,EAAEpF;IAAnD,CAAhD;;IACA,IAAIlC,KAAK,CAACe,QAAN,CAAeJ,MAAnB,EAA2B;MACvB,KAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,KAAK,CAACe,QAAN,CAAeJ,MAAnC,EAA2CO,CAAC,EAA5C,EAAgD;QAC5CgB,GAAG,CAAClC,KAAK,CAACe,QAAN,CAAeG,CAAf,EAAkBJ,GAAnB,CAAH,GAA6Bd,KAAK,CAACe,QAAN,CAAeG,CAAf,EAAkBC,KAA/C;MACH;IACJ,CAxEsE,CAyEvE;;;IACA,IAAI2F,IAAI,GAAGtJ,MAAM,CAACsJ,IAAP,CAAY5E,GAAZ,CAAX;;IACA,KAAK,IAAIqF,EAAE,GAAG,CAAT,EAAYC,MAAM,GAAGV,IAA1B,EAAgCS,EAAE,GAAGC,MAAM,CAAC7G,MAA5C,EAAoD4G,EAAE,EAAtD,EAA0D;MACtD,IAAIN,IAAI,GAAGO,MAAM,CAACD,EAAD,CAAjB;;MACA,IAAIhJ,QAAQ,CAAC2I,MAAT,CAAgBhF,GAAG,CAAC+E,IAAD,CAAnB,KAA8B/E,GAAG,CAAC+E,IAAD,CAAH,KAAc,EAA5C,IAAkD/E,GAAG,CAAC+E,IAAD,CAAH,CAAUtG,MAAV,KAAqB,CAA3E,EAA8E;QAC1E,OAAOuB,GAAG,CAAC+E,IAAD,CAAV;MACH;IACJ;;IACD,IAAI,EAAEnI,OAAO,CAACK,IAAR,IAAgB+C,GAAhB,IAAuBpD,OAAO,CAACO,IAAR,IAAgB6C,GAAzC,KAAiD7C,IAAI,KAAK,IAA9D,EAAoE;MAChE6C,GAAG,CAACpD,OAAO,CAACK,IAAT,CAAH,GAAoBZ,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,QAAnC,EAA6CrH,IAA7C,EAAmDa,KAAnD,CAApB;MACAkC,GAAG,CAACpD,OAAO,CAACO,IAAT,CAAH,GAAoBd,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,QAAnC,EAA6CnH,IAA7C,EAAmDW,KAAnD,CAApB;IACH;;IACD,IAAIpC,CAAC,GAAG,KAAKiC,GAAb;IACA,KAAKA,GAAL,GAAW,EAAX;;IACA,IAAI,KAAKf,OAAL,CAAaE,WAAb,KAA6B,MAAjC,EAAyC;MACrC,OAAO;QACHe,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAexF,GAAf,EAAoB3D,QAAQ,CAACoJ,KAAT,CAAeC,gBAAnC,CADH;QAEH3B,GAAG,EAAEA,GAFF;QAGH4B,OAAO,EAAEjK,CAHN;QAIH+B,IAAI,EAAE,MAJH;QAKHmI,WAAW,EAAE;MALV,CAAP;IAOH;;IACD5B,IAAI,GAAG,KAAK6B,oBAAL,CAA0B7F,GAA1B,EAA+BlC,KAA/B,EAAsCgD,EAAtC,CAAP;IACAkD,IAAI,GAAG,CAAClD,EAAE,CAACpD,UAAH,CAAcqG,GAAd,CAAkB+B,OAAlB,CAA0B,GAA1B,MAAmC,CAAC,CAApC,GAAwC,GAAxC,GAA8C,GAA/C,IAAsD9B,IAA7D;IACA,OAAO;MACHvG,IAAI,EAAE,KADH;MACUsG,GAAG,EAAEC,IAAI,CAACvF,MAAL,GAAcsF,GAAG,CAACvB,OAAJ,CAAY,MAAZ,EAAoBwB,IAApB,CAAd,GAA0CD,GADzD;MAC8D4B,OAAO,EAAEjK;IADvE,CAAP;EAGH,CArGD;;EAsGA+H,UAAU,CAAC3H,SAAX,CAAqBqJ,eAArB,GAAuC,UAAUvI,OAAV,EAAmBkB,KAAnB,EAA0B8F,OAA1B,EAAmCK,OAAnC,EAA4C8B,QAA5C,EAAsD;IACzF,IAAIC,KAAK,GAAG,OAAZ;IACA,IAAIhG,GAAG,GAAG+F,QAAV;IACA/F,GAAG,CAACpD,OAAO,CAACC,IAAT,CAAH,GAAoBiB,KAAK,CAACmI,SAA1B;;IACA,IAAIrJ,OAAO,CAACsB,KAAR,IAAiBJ,KAAK,CAACoI,SAAN,CAAgBzH,MAArC,EAA6C;MACzCuB,GAAG,CAACpD,OAAO,CAACsB,KAAT,CAAH,GAAqB,gBAAgB,IAAhB,GAAuB7B,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,YAAnC,EAAiDxG,KAAK,CAACoI,SAAvD,CAAvB,GAA2F,EAAhH;IACH;;IACD,IAAI,CAACpI,KAAK,CAACoI,SAAN,CAAgBzH,MAAjB,IAA2B7B,OAAO,CAACY,MAAvC,EAA+C;MAC3CwC,GAAG,CAACpD,OAAO,CAACY,MAAT,CAAH,GAAsB,cAAc,IAAd,IAAsB,cAAcoG,OAApC,GAClBvH,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,UAAnC,EAA+C;QAAE6B,OAAO,EAAE9J,QAAQ,CAACD,QAAT,CAAkBwH,OAAO,CAACT,QAAR,CAAiBvB,UAAnC,EAA+C9D,KAA/C,CAAX;QAAkEsI,OAAO,EAAEtI,KAAK,CAACsI;MAAjF,CAA/C,EAA2ItI,KAA3I,CADkB,GACkIA,KAAK,CAACsI,OAD9J;IAEH;;IACDpG,GAAG,CAACpD,OAAO,CAACI,MAAT,CAAH,GAAsB,cAAc4G,OAAd,IAAyB,CAAC9F,KAAK,CAACoI,SAAN,CAAgBzH,MAA1C,GAClBpC,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,UAAnC,EAA+CjI,QAAQ,CAACD,QAAT,CAAkBwH,OAAO,CAACT,QAAR,CAAiBvB,UAAnC,EAA+C9D,KAA/C,CAA/C,EAAsGA,KAAtG,CADkB,GAC6F,EADnH;IAEAkC,GAAG,CAACpD,OAAO,CAACS,KAAT,CAAH,GAAqBS,KAAK,CAAC+B,eAAN,GAAwBxD,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,SAAnC,EAA8CxG,KAAK,CAAC+B,eAApD,EAAqE/B,KAArE,CAAxB,GAAsG,EAA3H;IACAkC,GAAG,CAACpD,OAAO,CAACQ,MAAT,CAAH,GAAsB6G,OAAO,CAACI,QAAR,CAAiB5F,MAAjB,GAA0BpC,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,UAAnC,EAA+CL,OAAO,CAACI,QAAvD,EAAiEvG,KAAjE,CAA1B,GAAoG,EAA1H;IACAkC,GAAG,CAACpD,OAAO,CAACK,IAAT,CAAH,GAAoB,YAAY2G,OAAZ,GAChBvH,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,QAAnC,EAA6CjI,QAAQ,CAACD,QAAT,CAAkBwH,OAAO,CAACV,MAAR,CAAeD,GAAjC,EAAsCnF,KAAtC,CAA7C,EAA2FA,KAA3F,CADgB,GACoF,EADxG;IAEAkC,GAAG,CAACpD,OAAO,CAACO,IAAT,CAAH,GAAoB,YAAYyG,OAAZ,GAChBvH,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,QAAnC,EAA6CjI,QAAQ,CAACD,QAAT,CAAkBwH,OAAO,CAACZ,MAAR,CAAeC,GAAjC,EAAsCnF,KAAtC,CAA7C,EAA2FA,KAA3F,CADgB,GACoF,EADxG;IAEAkC,GAAG,CAACpD,OAAO,CAACU,KAAT,CAAH,GAAqB2G,OAAO,CAACG,OAAR,CAAgB3F,MAAhB,IAA0BwF,OAAO,CAACI,QAAR,CAAiB5F,MAA3C,GACjBpC,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,SAAnC,EAA8CL,OAAO,CAACG,OAAtD,EAA+DtG,KAA/D,CADiB,GACuD,EAD5E;IAEAkC,GAAG,CAACpD,OAAO,CAACG,MAAT,CAAH,GAAsBkH,OAAO,CAACC,KAAR,CAAczF,MAAd,GAAuBpC,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,UAAnC,EAA+CL,OAAO,CAACC,KAAvD,EAA8DpG,KAA9D,CAAvB,GAA8F,EAApH;IACAkC,GAAG,CAACpD,OAAO,CAACM,KAAT,CAAH,GAAqB+G,OAAO,CAACE,MAAR,CAAe1F,MAAf,GAAwBpC,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,SAAnC,EAA8CL,OAAO,CAACE,MAAtD,EAA8DrG,KAA9D,CAAxB,GAA+F,EAApH;IACAkC,GAAG,CAACpD,OAAO,CAACW,UAAT,CAAH,GAA0B0G,OAAO,CAAC1G,UAAR,CAAmBkB,MAAnB,GACtBpC,QAAQ,CAACiI,mBAAT,CAA6B,IAA7B,EAAmC,cAAnC,EAAmDL,OAAO,CAAC1G,UAA3D,EAAuEO,KAAvE,CADsB,GAC0D,EADpF;IAEAkC,GAAG,CAACgG,KAAD,CAAH,GAAa,EAAb;EACH,CA1BD;EA2BA;AACJ;AACA;AACA;AACA;AACA;;;EACIvC,UAAU,CAAC3H,SAAX,CAAqB+J,oBAArB,GAA4C,UAAU5B,OAAV,EAAmBnG,KAAnB,EAA0BgD,EAA1B,EAA8B;IACtE,OAAO,EAAP,CADsE,CAEtE;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACI2C,UAAU,CAAC3H,SAAX,CAAqB8B,eAArB,GAAuC,UAAUC,IAAV,EAAgBlB,EAAhB,EAAoBmB,KAApB,EAA2BC,GAA3B,EAAgCkG,OAAhC,EAAyClD,OAAzC,EAAkD;IACrF,IAAIhD,GAAG,IAAIA,GAAG,CAACsI,iBAAJ,CAAsB,cAAtB,CAAP,IACAtI,GAAG,CAACsI,iBAAJ,CAAsB,cAAtB,EAAsCP,OAAtC,CAA8C,kBAA9C,MAAsE,CAAC,CAD3E,EAC8E;MAC1E,IAAIQ,cAAc,GAAGjK,QAAQ,CAACkK,gBAA9B;;MACA,IAAI5J,EAAE,IAAI,CAACA,EAAE,CAAC4J,gBAAd,EAAgC;QAC5BlK,QAAQ,CAACkK,gBAAT,GAA4B,KAA5B;MACH;;MACD1I,IAAI,GAAGxB,QAAQ,CAACoJ,KAAT,CAAee,SAAf,CAAyB3I,IAAzB,CAAP;MACAxB,QAAQ,CAACkK,gBAAT,GAA4BD,cAA5B;IACH;;IACD,IAAIG,QAAQ,GAAGxC,OAAf;IACA,IAAItG,GAAG,GAAG8I,QAAQ,CAACd,OAAT,IAAoB,EAA9B;IACA,IAAIe,OAAO,GAAG7I,IAAI,GAAGA,IAAI,CAAC6I,OAAR,GAAkB,EAApC;;IACA,IAAI3I,GAAG,IAAIA,GAAG,CAACsI,iBAAJ,CAAsB,cAAtB,CAAP,IACAtI,GAAG,CAACsI,iBAAJ,CAAsB,cAAtB,EAAsCP,OAAtC,CAA8C,KAA9C,MAAyD,CAAC,CAD9D,EACiE;MAC7D,OAAQhI,KAAK,CAAC+B,eAAN,GAAwB;QAAEvB,MAAM,EAAE,EAAV;QAAcjB,KAAK,EAAE;MAArB,CAAxB,GAAmD,EAA3D;IACH;;IACD,IAAIjC,CAAC,GAAGmK,IAAI,CAACE,KAAL,CAAWgB,QAAQ,CAAC5I,IAApB,CAAR;;IACA,IAAIzC,CAAC,IAAIA,CAAC,CAACuL,MAAF,KAAa,OAAlB,IAA6B9I,IAA7B,IAAqCA,IAAI,CAACqD,YAA9C,EAA4D;MACxDH,OAAO,CAACG,YAAR,GAAuBrD,IAAI,CAACqD,YAA5B;MACA,OAAOH,OAAP;IACH;;IACD,IAAIlD,IAAI,IAAIA,IAAI,CAACzC,CAAjB,EAAoB;MAChByC,IAAI,GAAGA,IAAI,CAACzC,CAAZ;IACH;;IACD,IAAIsE,IAAI,GAAG,EAAX;;IACA,IAAI7B,IAAI,IAAI,WAAWA,IAAvB,EAA6B;MACzB6B,IAAI,CAACrC,KAAL,GAAaQ,IAAI,CAACR,KAAlB;IACH;;IACDqC,IAAI,CAACpB,MAAL,GAAcT,IAAI,IAAIA,IAAI,CAACS,MAAb,GAAsBT,IAAI,CAACS,MAA3B,GAAoCT,IAAlD;IACA,IAAI+I,QAAQ,GAAG,KAAf;;IACA,IAAInL,KAAK,CAACoL,OAAN,CAAchJ,IAAI,CAACS,MAAnB,KAA8BT,IAAI,CAACS,MAAL,CAAYG,MAA9C,EAAsD;MAClD,IAAIG,GAAG,GAAG,KAAV;MACA,IAAIkI,GAAG,GAAG,OAAV;MACA,IAAI5G,KAAK,GAAG,OAAZ;;MACA,IAAI,CAAChE,iBAAiB,CAAC2B,IAAI,CAACS,MAAL,CAAY,CAAZ,EAAeM,GAAf,CAAD,CAAtB,EAA6C;QACzCc,IAAI,CAACpB,MAAL,GAAc,KAAKyI,qBAAL,CAA2BrH,IAAI,CAACpB,MAAhC,EAAwC,CAAxC,EAA2CX,GAAG,CAACwG,MAAJ,CAAW1F,MAAX,GAAoB,CAA/D,CAAd;MACH;;MACD,IAAIX,KAAK,IAAIA,KAAK,CAACe,QAAN,CAAeJ,MAAxB,IAAkCd,GAAG,CAACwG,MAAJ,CAAW1F,MAAjD,EAAyD;QACrD,KAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,KAAK,CAACe,QAAN,CAAeJ,MAAnC,EAA2CO,CAAC,EAA5C,EAAgD;UAC5C,IAAIlB,KAAK,CAACe,QAAN,CAAeG,CAAf,EAAkBJ,GAAlB,MAA2B,mBAA/B,EAAoD;YAChD,IAAIK,KAAK,GAAGnB,KAAK,CAACe,QAAN,CAAeG,CAAf,EAAkB8H,GAAlB,EAAuB5G,KAAvB,CAAZ;;YACA,IAAIvC,GAAG,CAACwG,MAAJ,CAAW1F,MAAX,KAAsBQ,KAA1B,EAAiC;cAC7B2H,QAAQ,GAAG,IAAX;YACH;UACJ;QACJ;MACJ;IACJ;;IACD,IAAI,CAACA,QAAL,EAAe;MACX,KAAKI,kBAAL,CAAwBrJ,GAAxB,EAA6BE,IAA7B,EAAmC6B,IAAnC,EAAyCgH,OAAzC,EAAkD5I,KAAlD;IACH;;IACD,OAAOzB,QAAQ,CAAC2I,MAAT,CAAgBtF,IAAI,CAACrC,KAArB,IAA8BqC,IAAI,CAACpB,MAAnC,GAA4C;MAAEA,MAAM,EAAEoB,IAAI,CAACpB,MAAf;MAAuBjB,KAAK,EAAEqC,IAAI,CAACrC,KAAnC;MAA0CE,UAAU,EAAEmC,IAAI,CAACnC;IAA3D,CAAnD;EACH,CArDD;;EAsDAkG,UAAU,CAAC3H,SAAX,CAAqBiL,qBAArB,GAA6C,UAAUlJ,IAAV,EAAgBqC,KAAhB,EAAuBM,UAAvB,EAAmC;IAC5E,KAAK,IAAIxB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,IAAI,CAACY,MAAzB,EAAiCO,CAAC,EAAlC,EAAsC;MAClC,IAAInB,IAAI,CAACmB,CAAD,CAAJ,CAAQiI,KAAR,CAAcxI,MAAd,IAAwBnD,MAAM,CAACsJ,IAAP,CAAY/G,IAAI,CAACmB,CAAD,CAAJ,CAAQiI,KAAR,CAAc,CAAd,CAAZ,EAA8BnB,OAA9B,CAAsC,KAAtC,IAA+C,CAAC,CAA5E,EAA+E;QAC3E,KAAKiB,qBAAL,CAA2BlJ,IAAI,CAACmB,CAAD,CAAJ,CAAQiI,KAAnC,EAA0C/G,KAAK,GAAG,CAAlD,EAAqDM,UAAU,GAAG,CAAlE;MACH;IACJ;;IACD,IAAID,GAAG,GAAG,WAAV;IACA,IAAI2G,QAAQ,GAAG,aAAf;IACA,IAAIC,GAAG,GAAG,OAAV;IACA,IAAI1G,OAAO,GAAG,SAAd;IACA5C,IAAI,CAAC0C,GAAD,CAAJ,GAAY/D,MAAM,CAAC+D,GAAD,CAAlB;IACA1C,IAAI,CAACsJ,GAAD,CAAJ,GAAYjH,KAAZ;IACArC,IAAI,CAACqJ,QAAD,CAAJ,GAAiB1G,UAAjB;IACA3C,IAAI,CAAC4C,OAAD,CAAJ,GAAgB5C,IAAI,CAAC,CAAD,CAAJ,CAAQoJ,KAAR,CAAcxI,MAAd,GAAuB,KAAK2I,iBAAL,CAAuBvJ,IAAvB,EAA6B,CAAC3B,iBAAiB,CAAC2B,IAAI,CAAC,CAAD,CAAJ,CAAQoJ,KAAR,CAAcxG,OAAd,CAAD,CAA/C,CAAvB,GAAkG,EAAlH;IACA,OAAO5C,IAAP;EACH,CAfD;;EAgBA4F,UAAU,CAAC3H,SAAX,CAAqBsL,iBAArB,GAAyC,UAAUvJ,IAAV,EAAgBwJ,UAAhB,EAA4B;IACjE,IAAIC,mBAAmB,GAAG,EAA1B;IACA,IAAI7G,OAAO,GAAG,SAAd;;IACA,KAAK,IAAIzB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,IAAI,CAACY,MAAzB,EAAiCO,CAAC,EAAlC,EAAsC;MAClC,IAAI,CAACqI,UAAL,EAAiB;QACb,KAAK,IAAIvF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjE,IAAI,CAACmB,CAAD,CAAJ,CAAQiI,KAAR,CAAcxI,MAAlC,EAA0CqD,CAAC,EAA3C,EAA+C;UAC3CwF,mBAAmB,CAACjI,IAApB,CAAyBxB,IAAI,CAACmB,CAAD,CAAJ,CAAQiI,KAAR,CAAcnF,CAAd,CAAzB;QACH;MACJ,CAJD,MAKK;QACDwF,mBAAmB,GAAGA,mBAAmB,CAACC,MAApB,CAA2B1J,IAAI,CAACmB,CAAD,CAAJ,CAAQiI,KAAR,CAAcxG,OAAd,CAA3B,CAAtB;MACH;IACJ;;IACD,OAAO6G,mBAAP;EACH,CAdD;EAeA;AACJ;AACA;AACA;AACA;;;EACI7D,UAAU,CAAC3H,SAAX,CAAqB2G,OAArB,GAA+B,UAAUnD,CAAV,EAAa;IACxC,KAAK3B,GAAL,CAASwG,MAAT,GAAkB7E,CAAlB;IACA,OAAOA,CAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;;;EACImE,UAAU,CAAC3H,SAAX,CAAqB4F,YAArB,GAAoC,UAAUpC,CAAV,EAAa;IAC7C,KAAK3B,GAAL,CAASJ,UAAT,GAAsB+B,CAAtB;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACImE,UAAU,CAAC3H,SAAX,CAAqB+E,YAArB,GAAoC,UAAUC,EAAV,EAAcC,OAAd,EAAuBzB,CAAvB,EAA0BxB,KAA1B,EAAiC0J,QAAjC,EAA2C;IAC3E,IAAIzD,GAAJ;IACA,IAAInF,GAAJ;IACA,OAAO;MACHnB,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAc+J,QAAd,IAA0B3G,EAAE,CAACpD,UAAH,CAAcgK,OAAxC,IAAmD5G,EAAE,CAACpD,UAAH,CAAciK,SAAjE,IAA8E7G,EAAE,CAACpD,UAAH,CAAcqG,GAF9F;MAGH6B,WAAW,EAAE,iCAHV;MAIHgC,QAAQ,EAAE,MAJP;MAKH/J,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5B4L,OAAO,EAAE9G,OAAO,CAACK,cADW;QAE5B0G,KAAK,EAAE/G,OAAO,CAACG,YAFa;QAG5B6G,OAAO,EAAEhH,OAAO,CAACE,cAHW;QAI5B0F,MAAM,EAAE,OAJoB;QAK5BqB,KAAK,EAAE1I,CAAC,CAACyE,GAAD,CALoB;QAM5BnF,GAAG,EAAEU,CAAC,CAACV,GAAD;MANsB,CAAL,EAOxBvC,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CAPwB,CAArB;IALH,CAAP;EAcH,CAjBD;EAkBA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI2F,UAAU,CAAC3H,SAAX,CAAqBoM,UAArB,GAAkC,UAAUpH,EAAV,EAAcmD,OAAd,EAAuB,CACrD;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;AACA;;;EACIR,UAAU,CAAC3H,SAAX,CAAqBqF,MAArB,GAA8B,UAAUL,EAAV,EAAcjD,IAAd,EAAoBuF,SAApB,EAA+BtF,KAA/B,EAAsC;IAChE,OAAO;MACHiG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAcyK,SAAd,IAA2BrH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoD5G,EAAE,CAACpD,UAAH,CAAcqG,GADpE;MAEHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5BgD,KAAK,EAAEpB,IADqB;QAE5BmK,KAAK,EAAE5E,SAFqB;QAG5BuD,MAAM,EAAE;MAHoB,CAAL,EAIxBtK,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CAJwB,CAArB;IAFH,CAAP;EAQH,CATD;EAUA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI2F,UAAU,CAAC3H,SAAX,CAAqBwF,MAArB,GAA8B,UAAUR,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0CtF,KAA1C,EAAiD;IAC3E,OAAO;MACHL,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAciK,SAAd,IAA2B7G,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoD5G,EAAE,CAACpD,UAAH,CAAcqG,GAFpE;MAGHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5B2C,GAAG,EAAEK,KADuB;QAE5BmJ,SAAS,EAAE7E,QAFiB;QAG5ByE,KAAK,EAAE5E,SAHqB;QAI5BuD,MAAM,EAAE;MAJoB,CAAL,EAKxBtK,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CALwB,CAArB;IAHH,CAAP;EAUH,CAXD;EAYA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI2F,UAAU,CAAC3H,SAAX,CAAqBuF,MAArB,GAA8B,UAAUP,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0CtF,KAA1C,EAAiD;IAC3E,OAAO;MACHL,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAc2K,SAAd,IAA2BvH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoD5G,EAAE,CAACpD,UAAH,CAAcqG,GAFpE;MAGHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5BgD,KAAK,EAAEA,KADqB;QAE5B0H,MAAM,EAAE,QAFoB;QAG5ByB,SAAS,EAAE7E,QAHiB;QAI5B3E,GAAG,EAAEvC,QAAQ,CAAC0F,SAAT,CAAmBwB,QAAnB,EAA6BtE,KAA7B,CAJuB;QAK5B+I,KAAK,EAAE5E;MALqB,CAAL,EAMxB/G,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CANwB,CAArB;IAHH,CAAP;EAWH,CAZD;EAaA;AACJ;AACA;AACA;AACA;AACA;;;EACI2F,UAAU,CAAC3H,SAAX,CAAqB2I,cAArB,GAAsC,UAAU5G,IAAV,EAAgBC,KAAhB,EAAuB;IACzD,IAAIc,GAAG,GAAGd,KAAK,CAACwK,IAAhB;IACA,IAAIrJ,KAAJ;IACA,IAAI8F,IAAI,GAAGnG,GAAX;IACA,IAAI2J,IAAI,GAAGzK,KAAK,CAACc,GAAjB;IACA,IAAI4J,SAAS,GAAG,EAAhB;;IACA,IAAI,OAAO3K,IAAI,CAAC,CAAD,CAAX,KAAmB,QAAvB,EAAiC;MAC7BkH,IAAI,GAAG,IAAP;IACH;;IACD,KAAK,IAAI/F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,IAAI,CAACY,MAAzB,EAAiCO,CAAC,EAAlC,EAAsC;MAClC,IAAI,OAAOnB,IAAI,CAAC,CAAD,CAAX,KAAmB,QAAvB,EAAiC;QAC7BoB,KAAK,GAAG5C,QAAQ,CAAC0F,SAAT,CAAmBwG,IAAI,IAAIxD,IAA3B,EAAiClH,IAAI,CAACmB,CAAD,CAArC,CAAR;MACH,CAFD,MAGK;QACDC,KAAK,GAAGpB,IAAI,CAACmB,CAAD,CAAZ;MACH;;MACDwJ,SAAS,CAACnJ,IAAV,CAAe,IAAI9C,SAAJ,CAAcqC,GAAd,EAAmB,OAAnB,EAA4BK,KAA5B,CAAf;IACH;;IACD,OAAO1C,SAAS,CAACkM,EAAV,CAAaD,SAAb,CAAP;EACH,CAnBD;;EAoBA/E,UAAU,CAAC3H,SAAX,CAAqBkL,kBAArB,GAA0C,UAAUrJ,GAAV,EAAeE,IAAf,EAAqB6B,IAArB,EAA2BgH,OAA3B,EAAoC5I,KAApC,EAA2C;IACjF,IAAI4K,KAAK,GAAG7K,IAAZ;;IACA,IAAIA,IAAI,IAAIA,IAAI,CAACS,MAAjB,EAAyB;MACrBoK,KAAK,GAAG7K,IAAI,CAACS,MAAb;IACH;;IACD,IAAIX,GAAG,IAAIA,GAAG,CAACJ,UAAX,IAAyBI,GAAG,CAACJ,UAAJ,CAAekB,MAA5C,EAAoD;MAChD,IAAIS,GAAG,GAAGvB,GAAG,CAACJ,UAAd;MACA,IAAI6B,EAAE,GAAG,KAAK,CAAd;MACA,IAAIuJ,aAAa,GAAGD,KAApB;MACA,IAAIE,GAAG,GAAG,EAAV;;MACA,IAAI/K,IAAI,CAACgL,SAAT,EAAoB;QAChBF,aAAa,GAAG9K,IAAI,CAACgL,SAArB;MACH;;MACD,KAAK,IAAI7J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGE,GAAG,CAACT,MAAxB,EAAgCO,CAAC,EAAjC,EAAqC;QACjCI,EAAE,GAAG/C,QAAQ,CAACkB,UAAT,CAAoB2B,GAAG,CAACF,CAAD,CAAH,CAAOvB,IAA3B,CAAL;;QACA,IAAI2B,EAAJ,EAAQ;UACJwJ,GAAG,CAAC1J,GAAG,CAACF,CAAD,CAAH,CAAOQ,KAAP,GAAe,KAAf,GAAuBN,GAAG,CAACF,CAAD,CAAH,CAAOvB,IAA/B,CAAH,GAA0C2B,EAAE,CAACuJ,aAAD,EAAgBzJ,GAAG,CAACF,CAAD,CAAH,CAAOQ,KAAvB,CAA5C;QACH;MACJ;;MACDE,IAAI,CAACnC,UAAL,GAAkBqL,GAAlB;IACH;;IACD,IAAIhK,GAAG,GAAG,KAAV;IACA,IAAIkK,gBAAgB,GAAGrN,KAAK,CAACoL,OAAN,CAAchJ,IAAI,CAACS,MAAnB,KAA8BT,IAAI,CAACS,MAAL,CAAYG,MAA1C,IAAoD,CAACvC,iBAAiB,CAAC2B,IAAI,CAACS,MAAL,CAAY,CAAZ,EAAeM,GAAf,CAAD,CAA7F;;IACA,IAAIjB,GAAG,IAAIA,GAAG,CAACwG,MAAX,IAAqBxG,GAAG,CAACwG,MAAJ,CAAW1F,MAAhC,IAA0C,CAACqK,gBAA/C,EAAiE;MAC7D,IAAI3E,MAAM,GAAGxG,GAAG,CAACwG,MAAjB;;MACA,KAAK,IAAInF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmF,MAAM,CAAC1F,MAA3B,EAAmCO,CAAC,EAApC,EAAwC;QACpC,IAAIkB,KAAK,GAAG,IAAZ;;QACA,IAAI,CAAChE,iBAAiB,CAACwK,OAAD,CAAtB,EAAiC;UAC7BA,OAAO,GAAGrK,QAAQ,CAACa,KAAT,CAAewJ,OAAf,EAAwBvC,MAAM,CAACnF,CAAD,CAA9B,CAAV;QACH;;QACD,IAAI+J,UAAU,GAAGzM,KAAK,CAACqE,aAAN,CAAoB7C,KAAK,CAACqB,OAA1B,EAAmC,SAAnC,EAA8CH,CAA9C,EAAiDM,CAAlE;QACAoJ,KAAK,GAAGrM,QAAQ,CAACa,KAAT,CAAewL,KAAf,EAAsBvE,MAAM,CAACnF,CAAD,CAA5B,EAAiCrB,GAAG,CAACJ,UAArC,EAAiD2C,KAAjD,EAAwDwG,OAAxD,EAAiEqC,UAAU,CAAC3I,QAA5E,CAAR;MACH;;MACDV,IAAI,CAACpB,MAAL,GAAcoK,KAAd;IACH;;IACD,OAAOhJ,IAAP;EACH,CApCD;;EAqCA+D,UAAU,CAAC3H,SAAX,CAAqB6H,eAArB,GAAuC,UAAU7F,KAAV,EAAiB;IACpD,IAAIkC,GAAG,GAAG;MAAEkE,KAAK,EAAE,EAAT;MAAaC,MAAM,EAAE,EAArB;MAAyBC,OAAO,EAAE,EAAlC;MAAsCC,QAAQ,EAAE,EAAhD;MAAoD9G,UAAU,EAAE;IAAhE,CAAV;IACAyC,GAAG,CAACkE,KAAJ,GAAY5H,KAAK,CAACqE,aAAN,CAAoB7C,KAAK,CAACqB,OAA1B,EAAmC,UAAnC,CAAZ;IACAa,GAAG,CAACmE,MAAJ,GAAa7H,KAAK,CAACqE,aAAN,CAAoB7C,KAAK,CAACqB,OAA1B,EAAmC,SAAnC,CAAb;IACAa,GAAG,CAACoE,OAAJ,GAAc9H,KAAK,CAACqE,aAAN,CAAoB7C,KAAK,CAACqB,OAA1B,EAAmC,SAAnC,CAAd;IACAa,GAAG,CAACqE,QAAJ,GAAe/H,KAAK,CAACqE,aAAN,CAAoB7C,KAAK,CAACqB,OAA1B,EAAmC,UAAnC,CAAf;IACAa,GAAG,CAACzC,UAAJ,GAAiBjB,KAAK,CAACqE,aAAN,CAAoB7C,KAAK,CAACqB,OAA1B,EAAmC,cAAnC,CAAjB;IACA,OAAOa,GAAP;EACH,CARD;;EASAyD,UAAU,CAAC3H,SAAX,CAAqBkN,SAArB,GAAiC,UAAUpM,OAAV,EAAmB;IAChD,IAAIoD,GAAG,GAAGpD,OAAO,CAACwI,SAAlB;;IACA,IAAIxI,OAAO,CAACkH,MAAR,CAAerF,MAAnB,EAA2B;MACvBuB,GAAG,CAAC8D,MAAJ,GAAa,EAAb;IACH;;IACD,KAAK,IAAIe,EAAE,GAAG,CAAT,EAAYQ,EAAE,GAAGzI,OAAO,CAACkH,MAA9B,EAAsCe,EAAE,GAAGQ,EAAE,CAAC5G,MAA9C,EAAsDoG,EAAE,EAAxD,EAA4D;MACxD,IAAIjE,GAAG,GAAGyE,EAAE,CAACR,EAAD,CAAZ;;MACA,IAAI7E,GAAG,CAACY,GAAG,CAAChC,GAAL,CAAP,EAAkB;QACd,MAAM,IAAIqK,KAAJ,CAAU,0EAAV,CAAN;MACH;;MACDjJ,GAAG,CAACY,GAAG,CAAChC,GAAL,CAAH,GAAegC,GAAG,CAAC3B,KAAnB;;MACA,IAAI2B,GAAG,CAACxB,EAAR,EAAY;QACRY,GAAG,CAACY,GAAG,CAAChC,GAAL,CAAH,GAAegC,GAAG,CAACxB,EAAJ,CAAOG,IAAP,CAAY3C,OAAO,CAACkB,KAApB,EAA2B8C,GAAG,CAAChC,GAA/B,EAAoChC,OAAO,CAACkB,KAA5C,EAAmDlB,OAAO,CAACkE,EAA3D,CAAf;MACH;;MACDd,GAAG,CAAC8D,MAAJ,CAAWlD,GAAG,CAAChC,GAAf,IAAsBoB,GAAG,CAACY,GAAG,CAAChC,GAAL,CAAzB;IACH;EACJ,CAhBD;;EAiBA,OAAO6E,UAAP;AACH,CA3b+B,CA2b9B/G,OA3b8B,CAAhC;;AA4bA,SAAS+G,UAAT;AACA;AACA;AACA;AACA;;AACA,IAAIyF,YAAY;AAAG;AAAe,UAAUjL,MAAV,EAAkB;EAChD/C,SAAS,CAACgO,YAAD,EAAejL,MAAf,CAAT;;EACA,SAASiL,YAAT,CAAsBC,KAAtB,EAA6B;IACzB,IAAIC,KAAK,GAAGnL,MAAM,CAACsB,IAAP,CAAY,IAAZ,KAAqB,IAAjC,CADyB,CAEzB;;;IACA6J,KAAK,CAACxM,OAAN,GAAgBX,MAAM,CAAC,EAAD,EAAKmN,KAAK,CAACxM,OAAX,EAAoB;MACtCE,WAAW,EAAE,KADyB;MAEtCuM,MAAM,EAAE,uEAF8B;MAGtCC,eAAe,EAAE,iBAHqB;MAItCvM,MAAM,EAAE,UAJ8B;MAKtCC,MAAM,EAAE,SAL8B;MAMtCC,IAAI,EAAE,OANgC;MAOtCE,IAAI,EAAE,MAPgC;MAQtCE,KAAK,EAAE,cAR+B;MAStCC,KAAK,EAAE,SAT+B;MAUtCE,MAAM,EAAE,SAV8B;MAWtC+L,KAAK,EAAE,QAX+B;MAYtCC,SAAS,EAAE,cAZ2B;MAatCC,QAAQ,EAAE,QAb4B;MActCC,SAAS,EAAE,cAd2B;MAetCC,YAAY,EAAE,0CAfwB;MAgBtCC,gBAAgB,EAAE,oEAhBoB;MAiBtCC,yBAAyB,EAAE,gDAjBW;MAkBtCC,UAAU,EAAE;IAlB0B,CAApB,CAAtB;IAoBA7N,MAAM,CAACmN,KAAK,CAACxM,OAAP,EAAgBuM,KAAK,IAAI,EAAzB,CAAN;IACA,OAAOC,KAAP;EACH;;EACDF,YAAY,CAACpN,SAAb,CAAuBiO,aAAvB,GAAuC,YAAY;IAC/C,OAAO,cAAP;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;;;EACIb,YAAY,CAACpN,SAAb,CAAuBkO,WAAvB,GAAqC,UAAUC,SAAV,EAAqBnM,KAArB,EAA4BoM,YAA5B,EAA0C;IAC3E,IAAIC,WAAW,GAAG,EAAlB;IACA,IAAIjF,QAAJ;IACA,IAAIkF,IAAJ;IACA,IAAItD,GAAG,GAAGmD,SAAS,CAAChL,KAApB;IACA,IAAIxB,IAAI,GAAG,OAAOqJ,GAAlB;IACA,IAAItH,KAAK,GAAGyK,SAAS,CAACzK,KAAV,GAAkB0J,YAAY,CAACmB,QAAb,CAAsBJ,SAAS,CAACzK,KAAhC,CAAlB,GAA2D,IAAvE;;IACA,IAAIsH,GAAG,YAAYtD,IAAnB,EAAyB;MACrBsD,GAAG,GAAG,eAAezK,QAAQ,CAACoJ,KAAT,CAAe6E,QAAf,CAAwBxD,GAAxB,CAAf,GAA8C,IAApD;IACH;;IACD,IAAIrJ,IAAI,KAAK,QAAb,EAAuB;MACnBqJ,GAAG,GAAGyD,kBAAkB,CAACzD,GAAD,CAAxB;MACAA,GAAG,GAAG,OAAOA,GAAP,GAAa,IAAnB;;MACA,IAAIoD,YAAJ,EAAkB;QACd1K,KAAK,GAAG,UAAUA,KAAV,GAAkB,mBAA1B;MACH;;MACD,IAAInD,QAAQ,CAACoJ,KAAT,CAAe+E,MAAf,CAAsB1D,GAAtB,CAAJ,EAAgC;QAC5BsD,IAAI,GAAG,MAAP;MACH;;MACD,IAAIH,SAAS,CAAChI,UAAd,EAA0B;QACtB,IAAI,CAACmI,IAAL,EAAW;UACP5K,KAAK,GAAG,aAAaA,KAAb,GAAqB,GAA7B;QACH;;QACDsH,GAAG,GAAGA,GAAG,CAAC2D,WAAJ,EAAN;MACH;IACJ;;IACDvF,QAAQ,GAAG7I,QAAQ,CAACqO,YAAT,CAAsBT,SAAS,CAAC/E,QAAhC,CAAX;;IACA,IAAIA,QAAJ,EAAc;MACViF,WAAW,IAAI3K,KAAf;MACA2K,WAAW,IAAIjF,QAAf;;MACA,IAAIkF,IAAJ,EAAU;QACND,WAAW,IAAIC,IAAf;MACH;;MACD,OAAOD,WAAW,GAAGrD,GAArB;IACH;;IACD,IAAI,CAAC5K,iBAAiB,CAAC,KAAK6N,aAAN,CAAlB,IAA0C,KAAKA,aAAL,OAAyB,gBAAvE,EAAyF;MACrF7E,QAAQ,GAAG7I,QAAQ,CAACsO,eAAT,CAAyBV,SAAS,CAAC/E,QAAnC,CAAX;IACH,CAFD,MAGK;MACDA,QAAQ,GAAG7I,QAAQ,CAACuO,aAAT,CAAuBX,SAAS,CAAC/E,QAAjC,CAAX;IACH;;IACD,IAAIA,QAAQ,KAAK,aAAjB,EAAgC;MAC5B,IAAIlB,IAAI,GAAG8C,GAAX;MACAA,GAAG,GAAGtH,KAAN;MACAA,KAAK,GAAGwE,IAAR;IACH;;IACDmG,WAAW,IAAIjF,QAAQ,GAAG,GAA1B;IACAiF,WAAW,IAAI3K,KAAK,GAAG,GAAvB;;IACA,IAAI4K,IAAJ,EAAU;MACND,WAAW,IAAIC,IAAf;IACH;;IACDD,WAAW,IAAIrD,GAAG,GAAG,GAArB;IACA,OAAOqD,WAAP;EACH,CArDD;;EAsDAjB,YAAY,CAACpN,SAAb,CAAuBkN,SAAvB,GAAmC,UAAUpM,OAAV,EAAmB;IAClDqB,MAAM,CAACnC,SAAP,CAAiBkN,SAAjB,CAA2BzJ,IAA3B,CAAgC,IAAhC,EAAsC3C,OAAtC;;IACA,OAAOA,OAAO,CAACwI,SAAR,CAAkBtB,MAAzB;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;;;EACIoF,YAAY,CAACpN,SAAb,CAAuB+O,kBAAvB,GAA4C,UAAUZ,SAAV,EAAqBnM,KAArB,EAA4BoM,YAA5B,EAA0C;IAClF,IAAItB,GAAG,GAAG,EAAV;;IACA,KAAK,IAAI5J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiL,SAAS,CAACa,UAAV,CAAqBrM,MAAzC,EAAiDO,CAAC,EAAlD,EAAsD;MAClD4J,GAAG,CAACvJ,IAAJ,CAAS,MAAM,KAAK0L,WAAL,CAAiBd,SAAS,CAACa,UAAV,CAAqB9L,CAArB,CAAjB,EAA0ClB,KAA1C,EAAiDoM,YAAjD,CAAN,GAAuE,GAAhF;IACH;;IACD,OAAOtB,GAAG,CAACoC,IAAJ,CAAS,MAAMf,SAAS,CAACgB,SAAhB,GAA4B,GAArC,CAAP;EACH,CAND;EAOA;AACJ;AACA;AACA;AACA;;;EACI/B,YAAY,CAACpN,SAAb,CAAuBiP,WAAvB,GAAqC,UAAUxJ,MAAV,EAAkBzD,KAAlB,EAAyBoM,YAAzB,EAAuC;IACxE,OAAO3I,MAAM,CAAC2J,SAAP,GAAmB,KAAKL,kBAAL,CAAwBtJ,MAAxB,EAAgCzD,KAAhC,EAAuCoM,YAAvC,CAAnB,GAA0E,KAAKF,WAAL,CAAiBzI,MAAjB,EAAyBzD,KAAzB,EAAgCoM,YAAhC,CAAjF;EACH,CAFD;EAGA;AACJ;AACA;AACA;;;EACIhB,YAAY,CAACpN,SAAb,CAAuBmE,OAAvB,GAAiC,UAAUmE,OAAV,EAAmB;IAChD,IAAI,KAAKzG,GAAL,CAASP,MAAb,EAAqB;MACjBgH,OAAO,CAAC/E,IAAR,CAAa,KAAK0L,WAAL,CAAiB,KAAKpN,GAAL,CAASP,MAA1B,EAAkC,IAAlC,EAAwC,IAAxC,CAAb;IACH;;IACD,OAAOgH,OAAO,CAAC4G,IAAR,CAAa,OAAb,CAAP;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI9B,YAAY,CAACpN,SAAb,CAAuBqP,YAAvB,GAAsC,UAAU7L,CAAV,EAAa;IAC/C,IAAIA,CAAC,CAAC2F,MAAF,IAAY3F,CAAC,CAAC2F,MAAF,CAASxG,MAAT,KAAoB,CAApC,EAAuC;MACnCpC,QAAQ,CAAC+O,UAAT,CAAoB,wEAApB;IACH;;IACD,IAAI7J,MAAM,GAAG,KAAK5D,GAAL,CAASP,MAAT,IAAmB,EAAhC;;IACA,KAAK,IAAI4B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGM,CAAC,CAAC2F,MAAF,CAASxG,MAA7B,EAAqCO,CAAC,EAAtC,EAA0C;MACtCuC,MAAM,CAAClC,IAAP,CAAY,IAAI9C,SAAJ,CAAc+C,CAAC,CAAC2F,MAAF,CAASjG,CAAT,CAAd,EAA2BM,CAAC,CAAC4F,QAA7B,EAAuC5F,CAAC,CAACV,GAAzC,EAA8CU,CAAC,CAAC2C,UAAhD,CAAZ;IACH;;IACD,KAAKtE,GAAL,CAASP,MAAT,GAAkBmE,MAAlB;EACH,CATD;EAUA;AACJ;AACA;AACA;;;EACI2H,YAAY,CAACpN,SAAb,CAAuB6F,QAAvB,GAAkC,UAAUrC,CAAV,EAAa;IAC3C,KAAK3B,GAAL,CAASP,MAAT,GAAkBb,SAAS,CAACkM,EAAV,CAAa,KAAK9K,GAAL,CAASP,MAAtB,CAAlB;IACA,OAAO,EAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;;;EACI8L,YAAY,CAACpN,SAAb,CAAuBuP,UAAvB,GAAoC,UAAU/L,CAAV,EAAa;IAC7C,IAAIsJ,GAAG,GAAG,EAAV;;IACA,IAAItJ,CAAC,CAACiF,IAAF,YAAkB9I,KAAtB,EAA6B;MACzB,KAAK,IAAIuD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGM,CAAC,CAACiF,IAAF,CAAO9F,MAA3B,EAAmCO,CAAC,EAApC,EAAwC;QACpC4J,GAAG,CAACvJ,IAAJ,CAAS6J,YAAY,CAACmB,QAAb,CAAsB/K,CAAC,CAACiF,IAAF,CAAOvF,CAAP,CAAtB,KAAoCM,CAAC,CAACkF,SAAF,KAAgB,YAAhB,GAA+B,OAA/B,GAAyC,EAA7E,CAAT;MACH;IACJ,CAJD,MAKK;MACDoE,GAAG,CAACvJ,IAAJ,CAAS6J,YAAY,CAACmB,QAAb,CAAsB/K,CAAC,CAACiF,IAAxB,KAAiCjF,CAAC,CAACkF,SAAF,KAAgB,YAAhB,GAA+B,OAA/B,GAAyC,EAA1E,CAAT;IACH;;IACD,OAAOoE,GAAG,CAACoC,IAAJ,CAAS,GAAT,CAAP;EACH,CAXD;EAYA;AACJ;AACA;AACA;;;EACI9B,YAAY,CAACpN,SAAb,CAAuBqG,QAAvB,GAAkC,UAAU7C,CAAV,EAAa;IAC3C,OAAOA,CAAC,CAACgM,OAAF,GAAYN,IAAZ,CAAiB,GAAjB,CAAP;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;;;EACI9B,YAAY,CAACpN,SAAb,CAAuB2G,OAAvB,GAAiC,UAAUnD,CAAV,EAAa;IAC1C,KAAK3B,GAAL,CAASwG,MAAT,GAAkB7E,CAAlB;IACA,OAAO,EAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;;;EACI4J,YAAY,CAACpN,SAAb,CAAuBqH,QAAvB,GAAkC,UAAU7D,CAAV,EAAa;IAC3C,KAAK,IAAIN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGM,CAAC,CAACb,MAAtB,EAA8BO,CAAC,EAA/B,EAAmC;MAC/BM,CAAC,CAACN,CAAD,CAAD,GAAOkK,YAAY,CAACmB,QAAb,CAAsB/K,CAAC,CAACN,CAAD,CAAvB,CAAP;IACH;;IACD,OAAOM,CAAC,CAAC0L,IAAF,CAAO,GAAP,CAAP;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;;;EACI9B,YAAY,CAACpN,SAAb,CAAuB4F,YAAvB,GAAsC,UAAUpC,CAAV,EAAa;IAC/C,KAAK3B,GAAL,CAASJ,UAAT,GAAsB+B,CAAtB;IACA,OAAO,EAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;;;EACI4J,YAAY,CAACpN,SAAb,CAAuByP,OAAvB,GAAiC,UAAUjM,CAAV,EAAa;IAC1C,OAAOA,CAAC,KAAK,IAAN,GAAa,UAAb,GAA0B,EAAjC;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI4J,YAAY,CAACpN,SAAb,CAAuBoM,UAAvB,GAAoC,UAAUpH,EAAV,EAAcmD,OAAd,EAAuBuH,QAAvB,EAAiC;IACjE,IAAInP,QAAQ,CAACiG,QAAT,CAAkBkJ,QAAQ,CAACzH,GAA3B,EAAgC,KAAKnH,OAAL,CAAa2M,KAA7C,KAAuDiC,QAAQ,CAAC/N,IAAT,CAAcgN,WAAd,OAAgC,MAA3F,EAAmG;MAC/FxG,OAAO,CAACwH,gBAAR,CAAyB,QAAzB,EAAmC,KAAK7O,OAAL,CAAa0M,eAAhD;MACArF,OAAO,CAACwH,gBAAR,CAAyB,oBAAzB,EAA+C,KAA/C;MACAxH,OAAO,CAACyH,gBAAR,CAAyB,oCAAzB;IACH,CAJD,MAKK;MACDzH,OAAO,CAACwH,gBAAR,CAAyB,QAAzB,EAAmC,KAAK7O,OAAL,CAAayM,MAAhD;IACH;;IACDpF,OAAO,CAACwH,gBAAR,CAAyB,oBAAzB,EAA+C,KAA/C;IACAxH,OAAO,CAACwH,gBAAR,CAAyB,uBAAzB,EAAkD,KAAlD;EACH,CAXD;EAYA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIvC,YAAY,CAACpN,SAAb,CAAuB8B,eAAvB,GAAyC,UAAUC,IAAV,EAAgBlB,EAAhB,EAAoBmB,KAApB,EAA2BC,GAA3B,EAAgCkG,OAAhC,EAAyClD,OAAzC,EAAkD;IACvF,IAAI4K,SAAS,GAAG,gBAAhB;;IACA,IAAK1H,OAAO,IAAIA,OAAO,CAACxG,IAAR,KAAiB,KAA7B,IAAuC,CAAC,KAAKmO,OAA7C,IAAwD/N,IAAI,CAAC8N,SAAD,CAAhE,EAA6E;MACzE,IAAIE,QAAQ,GAAGhO,IAAI,CAAC8N,SAAD,CAAJ,CAAgBG,KAAhB,CAAsB,aAAtB,CAAf;MACA,KAAKF,OAAL,GAAeC,QAAQ,CAAC,CAAD,CAAvB;MACA,KAAKE,iBAAL,GAAyBF,QAAQ,CAAC,CAAD,CAAjC;IACH;;IACD,IAAIlG,OAAO,GAAG,SAAd;;IACA,IAAI,CAACzJ,iBAAiB,CAAC2B,IAAI,CAACzC,CAAN,CAAtB,EAAgC;MAC5B,IAAI4Q,QAAQ,GAAKlO,KAAK,IAAIA,KAAK,CAAC+B,eAAhB,GAAmChC,IAAI,CAACzC,CAAL,CAAO6Q,OAA1C,GAAoDpO,IAAI,CAACzC,CAAzE;MACA,IAAI8Q,QAAQ,GAAG,YAAf;;MACA,IAAI,CAAChQ,iBAAiB,CAAC8P,QAAD,CAAtB,EAAkC;QAC9B,KAAK,IAAIhN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgN,QAAQ,CAACvN,MAA7B,EAAqCO,CAAC,EAAtC,EAA0C;UACtC,IAAI,CAAC9C,iBAAiB,CAAC8P,QAAQ,CAAChN,CAAD,CAAR,CAAYkN,QAAZ,CAAD,CAAtB,EAA+C;YAC3C,OAAOF,QAAQ,CAAChN,CAAD,CAAR,CAAYkN,QAAZ,CAAP;UACH;QACJ;MACJ;IACJ;;IACD,IAAIvO,GAAG,GAAGsG,OAAO,IAAIA,OAAO,CAAC0B,OAAD,CAA5B;IACA,IAAIwG,aAAa,GAAG,KAAKC,oBAAL,CAA0BvO,IAA1B,EAAgCC,KAAhC,EAAuCC,GAAvC,EAA4CkG,OAA5C,EAAqDlD,OAArD,CAApB;;IACA,IAAIoL,aAAJ,EAAmB;MACf,OAAOA,aAAP;IACH;;IACD,IAAIE,YAAY,GAAGtO,GAAG,IAAIkG,OAAO,CAACoC,iBAAR,CAA0B,oBAA1B,CAA1B;IACA,IAAIhJ,KAAK,GAAG,IAAZ;IACA,IAAIiP,OAAO,GAAID,YAAY,IAAIE,QAAQ,CAACF,YAAD,EAAe,EAAf,CAAzB,IAAgD,CAA9D;;IACA,IAAIvO,KAAK,IAAIA,KAAK,CAAC+B,eAAnB,EAAoC;MAChC,IAAI2M,UAAU,GAAG,SAAjB;;MACA,IAAI3O,IAAI,CAAC2O,UAAD,CAAJ,IAAoB3O,IAAI,CAAC,aAAD,CAA5B,EAA6C;QACzCR,KAAK,GAAGQ,IAAI,CAAC2O,UAAD,CAAJ,IAAoB3O,IAAI,CAAC,aAAD,CAAhC;MACH;;MACD,IAAIA,IAAI,CAACzC,CAAT,EAAY;QACRyC,IAAI,GAAGA,IAAI,CAACzC,CAAZ;MACH;;MACD,IAAIyC,IAAI,CAAC2O,UAAD,CAAJ,IAAoB3O,IAAI,CAAC,aAAD,CAA5B,EAA6C;QACzCR,KAAK,GAAGQ,IAAI,CAAC2O,UAAD,CAAJ,IAAoB3O,IAAI,CAAC,aAAD,CAAhC;MACH;IACJ;;IACD,IAAIyO,OAAO,KAAK,CAAZ,IAAiBzO,IAAI,CAACoB,KAA1B,EAAiC;MAC7BpB,IAAI,GAAGA,IAAI,CAACoB,KAAZ;IACH;;IACD,IAAIpB,IAAI,CAACzC,CAAT,EAAY;MACRyC,IAAI,GAAGA,IAAI,CAACzC,CAAZ;IACH;;IACD,IAAIkR,OAAO,GAAG,CAAV,IAAezO,IAAI,CAACoO,OAAxB,EAAiC;MAC7BpO,IAAI,GAAGA,IAAI,CAACoO,OAAZ;IACH;;IACD,IAAIvM,IAAI,GAAG,EAAX;IACAA,IAAI,CAACrC,KAAL,GAAaA,KAAb;IACAqC,IAAI,CAACpB,MAAL,GAAcT,IAAd;IACA,KAAKmJ,kBAAL,CAAwBrJ,GAAxB,EAA6BE,IAA7B,EAAmC6B,IAAnC,EAAyC,IAAzC,EAA+C5B,KAA/C;IACA,OAAOzB,QAAQ,CAAC2I,MAAT,CAAgB3H,KAAhB,IAAyBqC,IAAI,CAACpB,MAA9B,GAAuC;MAAEA,MAAM,EAAEoB,IAAI,CAACpB,MAAf;MAAuBjB,KAAK,EAAEqC,IAAI,CAACrC,KAAnC;MAA0CE,UAAU,EAAEmC,IAAI,CAACnC;IAA3D,CAA9C;EACH,CArDD;EAsDA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI2L,YAAY,CAACpN,SAAb,CAAuB+J,oBAAvB,GAA8C,UAAU5B,OAAV,EAAmBnG,KAAnB,EAA0BgD,EAA1B,EAA8B;IACxE,IAAI8H,GAAG,GAAG,EAAV;IACA,IAAIZ,KAAK,GAAG,OAAZ;IACA,IAAI5E,SAAS,GAAGa,OAAO,CAAC+D,KAAD,CAAP,IAAkB,EAAlC;IACA,IAAIyE,MAAM,GAAG,SAAb;IACA,OAAOxI,OAAO,CAAC+D,KAAD,CAAd;;IACA,IAAIlH,EAAE,CAACpD,UAAH,CAAcgP,cAAlB,EAAkC;MAC9BzI,OAAO,CAACwI,MAAD,CAAP,GAAkB,MAAlB;IACH;;IACD,IAAI7H,IAAI,GAAGtJ,MAAM,CAACsJ,IAAP,CAAYX,OAAZ,CAAX;;IACA,KAAK,IAAIY,EAAE,GAAG,CAAT,EAAY8H,MAAM,GAAG/H,IAA1B,EAAgCC,EAAE,GAAG8H,MAAM,CAAClO,MAA5C,EAAoDoG,EAAE,EAAtD,EAA0D;MACtD,IAAIE,IAAI,GAAG4H,MAAM,CAAC9H,EAAD,CAAjB;MACA+D,GAAG,CAACvJ,IAAJ,CAAS0F,IAAI,GAAG,GAAP,GAAad,OAAO,CAACc,IAAD,CAA7B;IACH;;IACD6D,GAAG,GAAGA,GAAG,CAACoC,IAAJ,CAAS,GAAT,CAAN;;IACA,IAAIlK,EAAE,CAACpD,UAAH,CAAcqG,GAAd,IAAqBjD,EAAE,CAACpD,UAAH,CAAcqG,GAAd,CAAkB+B,OAAlB,CAA0B,GAA1B,MAAmC,CAAC,CAAzD,IAA8D,CAAC1C,SAAnE,EAA8E;MAC1E,OAAOwF,GAAP;IACH;;IACD,OAAOA,GAAG,CAACnK,MAAJ,GAAa2E,SAAS,GAAG,GAAZ,GAAkBwF,GAA/B,GAAqCxF,SAAS,IAAI,EAAzD;EACH,CAnBD;;EAoBA8F,YAAY,CAACpN,SAAb,CAAuB8Q,iBAAvB,GAA2C,UAAUhO,GAAV,EAAeiO,UAAf,EAA2B;IAClE,KAAK,IAAIhI,EAAE,GAAG,CAAT,EAAYQ,EAAE,GAAG,CAACnJ,iBAAiB,CAAC2Q,UAAD,CAAlB,GAAiCvR,MAAM,CAACsJ,IAAP,CAAYiI,UAAZ,CAAjC,GAA2D,EAAjF,EAAqFhI,EAAE,GAAGQ,EAAE,CAAC5G,MAA7F,EAAqGoG,EAAE,EAAvG,EAA2G;MACvG,IAAIE,IAAI,GAAGM,EAAE,CAACR,EAAD,CAAb;;MACA,IAAKgI,UAAU,CAAC9H,IAAD,CAAV,YAA4BvB,IAAjC,EAAwC;QACpCqJ,UAAU,CAAC9H,IAAD,CAAV,GAAmB1I,QAAQ,CAACyQ,SAAT,CAAmBC,WAAnB,CAA+BF,UAAU,CAAC9H,IAAD,CAAzC,CAAnB;MACH;IACJ;;IACD,OAAO8H,UAAP;EACH,CARD;EASA;AACJ;AACA;AACA;AACA;AACA;;;EACI3D,YAAY,CAACpN,SAAb,CAAuBqF,MAAvB,GAAgC,UAAUL,EAAV,EAAcjD,IAAd,EAAoBuF,SAApB,EAA+B;IAC3D,OAAO;MACHW,GAAG,EAAE,CAACjD,EAAE,CAACpD,UAAH,CAAcyK,SAAd,IAA2BrH,EAAE,CAACpD,UAAH,CAAcqG,GAA1C,EAA+CvB,OAA/C,CAAuD,MAAvD,EAA+DY,SAAS,GAAG,MAAMA,SAAT,GAAqB,EAA7F,CADF;MAEHvF,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAe3H,IAAf,EAAqB,KAAKjB,OAAL,CAAaoQ,SAAb,GAAyB,KAAKJ,iBAA9B,GAAkD,IAAvE;IAFH,CAAP;EAIH,CALD;EAMA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI1D,YAAY,CAACpN,SAAb,CAAuBwF,MAAvB,GAAgC,UAAUR,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0C;IACtE,IAAIW,GAAJ;;IACA,IAAI,OAAO9E,KAAP,KAAiB,QAAjB,IAA6B,CAAC5C,QAAQ,CAACoJ,KAAT,CAAe+E,MAAf,CAAsBvL,KAAtB,CAAlC,EAAgE;MAC5D8E,GAAG,GAAG,OAAO9E,KAAP,GAAe,IAArB;IACH,CAFD,MAGK;MACD8E,GAAG,GAAG,MAAM9E,KAAN,GAAc,GAApB;IACH;;IACD,OAAO;MACHxB,IAAI,EAAE,QADH;MAEHsG,GAAG,EAAE,CAACjD,EAAE,CAACpD,UAAH,CAAciK,SAAd,IAA2B7G,EAAE,CAACpD,UAAH,CAAcqG,GAA1C,EAA+CvB,OAA/C,CAAuD,MAAvD,EAA+DY,SAAS,GAAG,MAAMA,SAAT,GAAqB,EAA7F,IAAmGW;IAFrG,CAAP;EAIH,CAZD;EAaA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACImF,YAAY,CAACpN,SAAb,CAAuBuF,MAAvB,GAAgC,UAAUP,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0CtF,KAA1C,EAAiD0J,QAAjD,EAA2D;IACvF,IAAI,KAAK5K,OAAL,CAAakN,UAAb,KAA4B,OAA5B,IAAuC,CAAC5N,iBAAiB,CAACsL,QAAD,CAA7D,EAAyE;MACrEvI,KAAK,GAAG,KAAKgO,gBAAL,CAAsBhO,KAAtB,EAA6BuI,QAA7B,EAAuCjE,QAAvC,CAAR;IACH;;IACD,IAAIQ,GAAJ;;IACA,IAAI,OAAO9E,KAAK,CAACsE,QAAD,CAAZ,KAA2B,QAA3B,IAAuC,CAAClH,QAAQ,CAACoJ,KAAT,CAAe+E,MAAf,CAAsBvL,KAAK,CAACsE,QAAD,CAA3B,CAA5C,EAAoF;MAChFQ,GAAG,GAAG,OAAO9E,KAAK,CAACsE,QAAD,CAAZ,GAAyB,IAA/B;IACH,CAFD,MAGK;MACDQ,GAAG,GAAG,MAAM9E,KAAK,CAACsE,QAAD,CAAX,GAAwB,GAA9B;IACH;;IACD,OAAO;MACH9F,IAAI,EAAE,KAAKb,OAAL,CAAakN,UADhB;MAEH/F,GAAG,EAAE,CAACjD,EAAE,CAACpD,UAAH,CAAc2K,SAAd,IAA2BvH,EAAE,CAACpD,UAAH,CAAcqG,GAA1C,EAA+CvB,OAA/C,CAAuD,MAAvD,EAA+DY,SAAS,GAAG,MAAMA,SAAT,GAAqB,EAA7F,IAAmGW,GAFrG;MAGHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevG,KAAf,EAAsB,KAAKrC,OAAL,CAAaoQ,SAAb,GAAyB,KAAKJ,iBAA9B,GAAkD,IAAxE,CAHH;MAIHvD,MAAM,EAAE,KAAKzM,OAAL,CAAayM;IAJlB,CAAP;EAMH,CAjBD;EAkBA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIH,YAAY,CAACpN,SAAb,CAAuB+E,YAAvB,GAAsC,UAAUC,EAAV,EAAcC,OAAd,EAAuBzB,CAAvB,EAA0BxB,KAA1B,EAAiC0J,QAAjC,EAA2C;IAC7E,IAAI0F,WAAW,GAAG5N,CAAC,CAAC8K,IAAF,GAAS/N,QAAQ,CAAC8Q,OAAT,CAAiB,KAAKvQ,OAAL,CAAa6M,QAA9B,CAA3B;IACA,IAAI1F,GAAG,GAAG,KAAK6H,OAAL,GAAe,KAAKA,OAAL,GAAe,GAAf,GAAqB,KAAKhP,OAAL,CAAa2M,KAAjD,GACNzI,EAAE,CAACpD,UAAH,CAAcqG,GAAd,CAAkBvB,OAAlB,CAA0B,MAA1B,EAAkC,MAAM,KAAK5F,OAAL,CAAa2M,KAArD,CADJ;IAEAjK,CAAC,CAACyE,GAAF,GAAQ,KAAKgI,iBAAL,GAAyB,KAAKA,iBAA9B,GAAkDzM,CAAC,CAACyE,GAA5D;IACA,IAAIrE,IAAI,GAAG;MACPqE,GAAG,EAAEzE,CAAC,CAACyE,GADA;MAEPnF,GAAG,EAAEU,CAAC,CAACV,GAFA;MAGPwO,GAAG,EAAE,CAHE;MAIPC,IAAI,EAAEhR,QAAQ,CAAC8Q,OAAT,CAAiB,KAAKvQ,OAAL,CAAa4M,SAA9B;IAJC,CAAX;IAMA,IAAIxJ,GAAG,GAAG,OAAOkN,WAAP,GAAqB,IAA/B;IACAlN,GAAG,IAAI,6CAA6CN,IAAI,CAAC2N,IAAL,CAAU7K,OAAV,CAAkB,IAAlB,EAAwB,EAAxB,CAA7C,GAA2E,IAAlF;IACA,KAAK7E,GAAL,CAAS6L,SAAT,GAAqB,CAArB;IACAxJ,GAAG,IAAI,KAAKsN,qBAAL,CAA2BvM,OAAO,CAACG,YAAnC,EAAiDxB,IAAjD,EAAuDoB,EAAvD,CAAP;IACAd,GAAG,IAAI,KAAKuN,qBAAL,CAA2BxM,OAAO,CAACK,cAAnC,EAAmD1B,IAAnD,EAAyDoB,EAAzD,EAA6D0G,QAAQ,GAAGA,QAAQ,CAACpG,cAAZ,GAA6B,EAAlG,CAAP;IACApB,GAAG,IAAI,KAAKwN,qBAAL,CAA2BzM,OAAO,CAACE,cAAnC,EAAmDvB,IAAnD,EAAyDoB,EAAzD,CAAP;IACAd,GAAG,IAAIN,IAAI,CAAC2N,IAAL,GAAY,MAAnB;IACArN,GAAG,IAAI,OAAOkN,WAAP,GAAqB,IAA5B;IACA,OAAO;MACHzP,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEA,GAFF;MAGH6D,QAAQ,EAAE,MAHP;MAIHhC,WAAW,EAAE,6CAA6CsH,WAJvD;MAKHrP,IAAI,EAAEmC;IALH,CAAP;EAOH,CA1BD;EA2BA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACIkJ,YAAY,CAACpN,SAAb,CAAuB0R,qBAAvB,GAA+C,UAAUC,GAAV,EAAenO,CAAf,EAAkBwB,EAAlB,EAAsB;IACjE,IAAI,CAAC2M,GAAL,EAAU;MACN,OAAO,EAAP;IACH;;IACD,IAAIzN,GAAG,GAAG,EAAV;IACA,IAAI0N,IAAI,GAAG;MACP,UAAU,SADH;MAEP,OAAO,UAAU7P,IAAV,EAAgBmB,CAAhB,EAAmBJ,GAAnB,EAAwB;QAC3B,IAAImF,GAAG,GAAG1H,QAAQ,CAAC0F,SAAT,CAAmBnD,GAAnB,EAAwBf,IAAI,CAACmB,CAAD,CAA5B,CAAV;;QACA,IAAI,OAAO+E,GAAP,KAAe,QAAf,IAA2B1H,QAAQ,CAACoJ,KAAT,CAAe+E,MAAf,CAAsBzG,GAAtB,CAA/B,EAA2D;UACvD,OAAO,MAAMA,GAAN,GAAY,GAAnB;QACH,CAFD,MAGK,IAAIA,GAAG,YAAYP,IAAnB,EAAyB;UAC1B,IAAImK,QAAQ,GAAG9P,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,CAAf;UACA,OAAO,MAAM+O,QAAQ,CAACC,MAAT,EAAN,GAA0B,GAAjC;QACH,CAHI,MAIA;UACD,OAAO,OAAO7J,GAAP,GAAa,IAApB;QACH;MACJ,CAdM;MAeP,QAAQ,UAAUlG,IAAV,EAAgBmB,CAAhB,EAAmB;QAAE,OAAO,EAAP;MAAY;IAflC,CAAX;IAiBAgB,GAAG,GAAG,KAAK6N,mBAAL,CAAyBJ,GAAzB,EAA8BnO,CAA9B,EAAiCoO,IAAjC,EAAuC5M,EAAvC,CAAN;IACA,OAAOd,GAAG,GAAG,IAAb;EACH,CAxBD;EAyBA;AACJ;AACA;AACA;AACA;AACA;;;EACIkJ,YAAY,CAACpN,SAAb,CAAuBwR,qBAAvB,GAA+C,UAAUG,GAAV,EAAenO,CAAf,EAAkBwB,EAAlB,EAAsB;IACjE,IAAI,CAAC2M,GAAL,EAAU;MACN,OAAO,EAAP;IACH;;IACD,IAAIzN,GAAG,GAAG,EAAV;IACA,IAAI0N,IAAI,GAAG;MACP,UAAU,OADH;MAEP,OAAO,UAAU7P,IAAV,EAAgBmB,CAAhB,EAAmBJ,GAAnB,EAAwB;QAAE,OAAO,EAAP;MAAY,CAFtC;MAGP,QAAQ,UAAUf,IAAV,EAAgBmB,CAAhB,EAAmB;QAAE,OAAOuG,IAAI,CAACC,SAAL,CAAe3H,IAAI,CAACmB,CAAD,CAAnB,IAA0B,MAAjC;MAA0C;IAHhE,CAAX;IAKAgB,GAAG,GAAG,KAAK6N,mBAAL,CAAyBJ,GAAzB,EAA8BnO,CAA9B,EAAiCoO,IAAjC,EAAuC5M,EAAvC,CAAN;IACA,OAAOd,GAAP;EACH,CAZD;EAaA;AACJ;AACA;AACA;AACA;AACA;;;EACIkJ,YAAY,CAACpN,SAAb,CAAuByR,qBAAvB,GAA+C,UAAUE,GAAV,EAAenO,CAAf,EAAkBwB,EAAlB,EAAsBgN,GAAtB,EAA2B;IACtE,IAAI1E,KAAK,GAAG,IAAZ;;IACA,IAAI,CAACqE,GAAL,EAAU;MACN,OAAO,EAAP;IACH;;IACD,IAAIzN,GAAG,GAAG,EAAV;IACAyN,GAAG,CAACM,OAAJ,CAAY,UAAUC,MAAV,EAAkB;MAAE,OAAOA,MAAM,GAAG5E,KAAK,CAAC6D,gBAAN,CAAuBe,MAAvB,EAA+BF,GAAG,CAACvM,MAAJ,CAAW,UAAU0M,CAAV,EAAa;QAAE,OAAO5R,QAAQ,CAAC0F,SAAT,CAAmBzC,CAAC,CAACV,GAArB,EAA0BqP,CAA1B,MAAiC5R,QAAQ,CAAC0F,SAAT,CAAmBzC,CAAC,CAACV,GAArB,EAA0BoP,MAA1B,CAAxC;MAA4E,CAAtG,EAAwG,CAAxG,CAA/B,EAA2I1O,CAAC,CAACV,GAA7I,CAAhB;IAAoK,CAApM;IACA,IAAI8O,IAAI,GAAG;MACP,UAAU,KAAK9Q,OAAL,CAAakN,UAAb,GAA0B,GAD7B;MAEP,OAAO,UAAUjM,IAAV,EAAgBmB,CAAhB,EAAmBJ,GAAnB,EAAwB;QAC3B,IAAI,OAAOf,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,CAAP,KAAwB,QAAxB,IAAoCvC,QAAQ,CAACoJ,KAAT,CAAe+E,MAAf,CAAsB3M,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,CAAtB,CAAxC,EAA6E;UACzE,OAAO,MAAMf,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,CAAN,GAAqB,GAA5B;QACH,CAFD,MAGK,IAAIf,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,aAAwB4E,IAA5B,EAAkC;UACnC,IAAI0K,IAAI,GAAGrQ,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,CAAX;UACA,OAAO,MAAMsP,IAAI,CAACN,MAAL,EAAN,GAAsB,GAA7B;QACH,CAHI,MAIA;UACD,OAAO,OAAO/P,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,CAAP,GAAsB,IAA7B;QACH;MACJ,CAbM;MAcP,QAAQ,UAAUf,IAAV,EAAgBmB,CAAhB,EAAmB;QAAE,OAAOuG,IAAI,CAACC,SAAL,CAAe3H,IAAI,CAACmB,CAAD,CAAnB,IAA0B,MAAjC;MAA0C;IAdhE,CAAX;IAgBAgB,GAAG,GAAG,KAAK6N,mBAAL,CAAyBJ,GAAzB,EAA8BnO,CAA9B,EAAiCoO,IAAjC,EAAuC5M,EAAvC,CAAN;IACA,OAAOd,GAAP;EACH,CAzBD;;EA0BAkJ,YAAY,CAACmB,QAAb,GAAwB,UAAUtF,IAAV,EAAgB;IACpC,OAAOA,IAAI,CAACvC,OAAL,CAAa,KAAb,EAAoB,GAApB,CAAP;EACH,CAFD;;EAGA0G,YAAY,CAACpN,SAAb,CAAuB+R,mBAAvB,GAA6C,UAAUJ,GAAV,EAAenO,CAAf,EAAkBoO,IAAlB,EAAwB5M,EAAxB,EAA4B;IACrE,IAAId,GAAG,GAAG,EAAV;;IACA,KAAK,IAAIhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyO,GAAG,CAAChP,MAAxB,EAAgCO,CAAC,EAAjC,EAAqC;MACjCgB,GAAG,IAAI,OAAOV,CAAC,CAAC+N,IAAT,GAAgB,IAAvB;MACArN,GAAG,IAAI,KAAKpD,OAAL,CAAagN,gBAAb,GAAgC,MAAvC;MACA5J,GAAG,IAAI0N,IAAI,CAACS,MAAZ;;MACA,IAAIT,IAAI,CAACS,MAAL,KAAgB,OAApB,EAA6B;QACzBnO,GAAG,IAAI,CAACc,EAAE,CAACpD,UAAH,CAAcyK,SAAd,IAA2BrH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoDpI,CAAC,CAACyE,GAAvD,IAA8D2J,IAAI,CAAC3J,GAAL,CAAS0J,GAAT,EAAczO,CAAd,EAAiBM,CAAC,CAACV,GAAnB,CAA9D,GAAwF,aAA/F;MACH,CAFD,MAGK,IAAI8O,IAAI,CAACS,MAAL,KAAgB,MAAhB,IAA0BT,IAAI,CAACS,MAAL,KAAgB,QAA9C,EAAwD;QACzDnO,GAAG,IAAI,CAACc,EAAE,CAACpD,UAAH,CAAc2K,SAAd,IAA2BvH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoDpI,CAAC,CAACyE,GAAvD,IAA8D2J,IAAI,CAAC3J,GAAL,CAAS0J,GAAT,EAAczO,CAAd,EAAiBM,CAAC,CAACV,GAAnB,CAA9D,GAAwF,aAA/F;MACH,CAFI,MAGA,IAAI8O,IAAI,CAACS,MAAL,KAAgB,SAApB,EAA+B;QAChCnO,GAAG,IAAI,CAACc,EAAE,CAACpD,UAAH,CAAciK,SAAd,IAA2B7G,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoDpI,CAAC,CAACyE,GAAvD,IAA8D2J,IAAI,CAAC3J,GAAL,CAAS0J,GAAT,EAAczO,CAAd,EAAiBM,CAAC,CAACV,GAAnB,CAA9D,GAAwF,aAA/F;MACH;;MACDoB,GAAG,IAAI,aAAa,KAAKpD,OAAL,CAAayM,MAA1B,GAAmC,IAA1C;MACArJ,GAAG,IAAI,iBAAiB,KAAKrC,GAAL,CAAS6L,SAAT,EAAjB,GAAwC,IAA/C;MACAxJ,GAAG,IAAI,KAAKpD,OAAL,CAAaiN,yBAAb,GAAyC,IAAhD;;MACA,IAAI,CAAC3N,iBAAiB,CAACuR,GAAG,CAACzO,CAAD,CAAH,CAAO,aAAP,CAAD,CAAtB,EAA+C;QAC3CgB,GAAG,IAAI,eAAeyN,GAAG,CAACzO,CAAD,CAAH,CAAO,aAAP,CAAf,GAAuC,MAA9C;QACA,OAAOyO,GAAG,CAACzO,CAAD,CAAH,CAAO,aAAP,CAAP;MACH,CAHD,MAIK;QACDgB,GAAG,IAAI,IAAP;MACH;;MACDA,GAAG,IAAI0N,IAAI,CAAC7P,IAAL,CAAU4P,GAAV,EAAezO,CAAf,CAAP;IACH;;IACD,OAAOgB,GAAP;EACH,CA5BD;;EA6BAkJ,YAAY,CAACpN,SAAb,CAAuBsQ,oBAAvB,GAA8C,UAAUvO,IAAV,EAAgBC,KAAhB,EAAuBC,GAAvB,EAA4BkG,OAA5B,EAAqClD,OAArC,EAA8C;IACxF,IAAIhD,GAAG,IAAIA,GAAG,CAACsI,iBAAJ,CAAsB,cAAtB,CAAP,IAAgDtI,GAAG,CAACsI,iBAAJ,CAAsB,cAAtB,EAAsCP,OAAtC,CAA8C,KAA9C,MAAyD,CAAC,CAA9G,EAAiH;MAC7G,OAAQhI,KAAK,CAAC+B,eAAN,GAAwB;QAAEvB,MAAM,EAAE,EAAV;QAAcjB,KAAK,EAAE;MAArB,CAAxB,GAAmD,EAA3D;IACH;;IACD,IAAI4G,OAAO,IAAI,KAAKrH,OAAL,CAAa2M,KAAxB,IAAiClN,QAAQ,CAACiG,QAAT,CAAkB2B,OAAO,CAACF,GAA1B,EAA+B,KAAKnH,OAAL,CAAa2M,KAA5C,CAAjC,IAAuFtF,OAAO,CAACxG,IAAR,CAAagN,WAAb,OAA+B,MAA1H,EAAkI;MAC9H,IAAIL,IAAI,GAAGrM,GAAG,CAACsI,iBAAJ,CAAsB,cAAtB,CAAX;MACA,IAAI+H,IAAI,GAAG,KAAK,CAAhB;MACA,IAAIC,OAAO,GAAG,KAAK,CAAnB;MACA,IAAIjT,CAAC,GAAGyC,IAAI,GAAG,EAAf;MACAuM,IAAI,GAAGA,IAAI,CAACkE,SAAL,CAAelE,IAAI,CAACtE,OAAL,CAAa,gBAAb,IAAiC,CAAhD,CAAP;MACA1K,CAAC,GAAGA,CAAC,CAAC0Q,KAAF,CAAQ1B,IAAR,CAAJ;;MACA,IAAIhP,CAAC,CAACqD,MAAF,GAAW,CAAf,EAAkB;QACd,OAAO,EAAP;MACH;;MACDrD,CAAC,GAAGA,CAAC,CAAC,CAAD,CAAL;MACA,IAAImT,KAAK,GAAG,sDAAsDC,IAAtD,CAA2DpT,CAA3D,CAAZ;;MACA,IAAImT,KAAJ,EAAW;QACPnT,CAAC,CAACoH,OAAF,CAAU+L,KAAK,CAAC,CAAD,CAAf,EAAoB,EAApB;MACH;;MACD,IAAIE,UAAU,GAAGF,KAAK,GAAGA,KAAK,CAAC,CAAD,CAAR,GAAc,EAApC;MACAnT,CAAC,GAAGA,CAAC,CAAC0Q,KAAF,CAAQ2C,UAAR,CAAJ;;MACA,KAAK,IAAIzP,CAAC,GAAG5D,CAAC,CAACqD,MAAf,EAAuBO,CAAC,GAAG,CAAC,CAA5B,EAA+BA,CAAC,EAAhC,EAAoC;QAChC,IAAI,CAAC,iBAAiB0P,IAAjB,CAAsBtT,CAAC,CAAC4D,CAAD,CAAvB,CAAD,IAAgC,CAAC,cAAc0P,IAAd,CAAmBtT,CAAC,CAAC4D,CAAD,CAApB,CAArC,EAA+D;UAC3D;QACH;;QACDoP,IAAI,GAAG7B,QAAQ,CAAC,uBAAuBiC,IAAvB,CAA4BpT,CAAC,CAAC4D,CAAD,CAA7B,EAAkC,CAAlC,CAAD,EAAuC,EAAvC,CAAf;;QACA,IAAI+B,OAAO,CAACG,YAAR,CAAqBkN,IAArB,CAAJ,EAAgC;UAC5BC,OAAO,GAAGhS,QAAQ,CAACoJ,KAAT,CAAee,SAAf,CAAyB,WAAWgI,IAAX,CAAgBpT,CAAC,CAAC4D,CAAD,CAAjB,EAAsB,CAAtB,CAAzB,CAAV;UACA/C,MAAM,CAAC,EAAD,EAAK8E,OAAO,CAACG,YAAR,CAAqBkN,IAArB,CAAL,EAAiC,KAAKxQ,eAAL,CAAqByQ,OAArB,CAAjC,CAAN;QACH;MACJ;;MACD,OAAOtN,OAAP;IACH;;IACD,OAAO,IAAP;EACH,CAlCD;;EAmCAmI,YAAY,CAACpN,SAAb,CAAuBmR,gBAAvB,GAA0C,UAAUpP,IAAV,EAAgB2J,QAAhB,EAA0B5I,GAA1B,EAA+B;IACrE,IAAIwK,KAAK,GAAG,IAAZ;;IACA,IAAIlN,iBAAiB,CAACsL,QAAD,CAArB,EAAiC;MAC7B,OAAO3J,IAAP;IACH;;IACDvC,MAAM,CAACsJ,IAAP,CAAY/G,IAAZ,EAAkBkQ,OAAlB,CAA0B,UAAUhJ,IAAV,EAAgB;MACtC,IAAIA,IAAI,KAAKnG,GAAT,IAAgBmG,IAAI,KAAK,aAA7B,EAA4C;QACxC,IAAI1I,QAAQ,CAACsS,aAAT,CAAuB9Q,IAAI,CAACkH,IAAD,CAA3B,CAAJ,EAAwC;UACpCqE,KAAK,CAAC6D,gBAAN,CAAuBpP,IAAI,CAACkH,IAAD,CAA3B,EAAmCyC,QAAQ,CAACzC,IAAD,CAA3C;;UACA,IAAI6J,KAAK,GAAGtT,MAAM,CAACsJ,IAAP,CAAY/G,IAAI,CAACkH,IAAD,CAAhB,EAAwBxD,MAAxB,CAA+B,UAAU1D,IAAV,EAAgB;YAAE,OAAOA,IAAI,KAAK,aAAhB;UAAgC,CAAjF,CAAZ;;UACA,IAAI+Q,KAAK,CAACnQ,MAAN,KAAiB,CAArB,EAAwB;YACpB,OAAOZ,IAAI,CAACkH,IAAD,CAAX;UACH;QACJ,CAND,MAOK,IAAIlH,IAAI,CAACkH,IAAD,CAAJ,KAAeyC,QAAQ,CAACzC,IAAD,CAA3B,EAAmC;UACpC,OAAOlH,IAAI,CAACkH,IAAD,CAAX;QACH,CAFI,MAGA,IAAIlH,IAAI,CAACkH,IAAD,CAAJ,IAAcyC,QAAQ,CAACzC,IAAD,CAAtB,IAAgClH,IAAI,CAACkH,IAAD,CAAJ,CAAW8J,OAAX,OAAyBrH,QAAQ,CAACzC,IAAD,CAAR,CAAe8J,OAAf,EAA7D,EAAuF;UACxF,OAAOhR,IAAI,CAACkH,IAAD,CAAX;QACH;MACJ;IACJ,CAhBD;IAiBA,OAAOlH,IAAP;EACH,CAvBD;;EAwBA,OAAOqL,YAAP;AACH,CAnlBiC,CAmlBhCzF,UAnlBgC,CAAlC;;AAolBA,SAASyF,YAAT;AACA;AACA;AACA;AACA;AACA;;AACA,IAAI4F,cAAc;AAAG;AAAe,UAAU7Q,MAAV,EAAkB;EAClD/C,SAAS,CAAC4T,cAAD,EAAiB7Q,MAAjB,CAAT;;EACA,SAAS6Q,cAAT,CAAwB3F,KAAxB,EAA+B;IAC3B,IAAIC,KAAK,GAAGnL,MAAM,CAACsB,IAAP,CAAY,IAAZ,EAAkB4J,KAAlB,KAA4B,IAAxC,CAD2B,CAE3B;;;IACAC,KAAK,CAACxM,OAAN,GAAgBX,MAAM,CAAC,EAAD,EAAKmN,KAAK,CAACxM,OAAX,EAAoB;MACtCE,WAAW,EAAE,KADyB;MAEtCuM,MAAM,EAAE,gDAF8B;MAGtCC,eAAe,EAAE,iBAHqB;MAItCvM,MAAM,EAAE,UAJ8B;MAKtCC,MAAM,EAAE,SAL8B;MAMtCC,IAAI,EAAE,OANgC;MAOtCE,IAAI,EAAE,MAPgC;MAQtCE,KAAK,EAAE,QAR+B;MAStCD,MAAM,EAAE,SAT8B;MAUtCE,KAAK,EAAE,SAV+B;MAWtCE,MAAM,EAAE,SAX8B;MAYtC+L,KAAK,EAAE,QAZ+B;MAatCC,SAAS,EAAE,cAb2B;MActCC,QAAQ,EAAE,QAd4B;MAetCC,SAAS,EAAE,cAf2B;MAgBtCC,YAAY,EAAE,0CAhBwB;MAiBtCC,gBAAgB,EAAE,oEAjBoB;MAkBtCC,yBAAyB,EAAE,gDAlBW;MAmBtCC,UAAU,EAAE,OAnB0B;MAoBtCkD,SAAS,EAAE,KApB2B;MAqBtC9O,KAAK,EAAE;IArB+B,CAApB,CAAtB;IAuBAjC,MAAM,CAACmN,KAAK,CAACxM,OAAP,EAAgBuM,KAAK,IAAI,EAAzB,CAAN;IACA,OAAOC,KAAP;EACH;EACD;AACJ;AACA;;;EACI0F,cAAc,CAAChT,SAAf,CAAyBiO,aAAzB,GAAyC,YAAY;IACjD,OAAO,gBAAP;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;;;EACI+E,cAAc,CAAChT,SAAf,CAAyByP,OAAzB,GAAmC,UAAUjM,CAAV,EAAa;IAC5C,OAAOA,CAAC,KAAK,IAAN,GAAa,MAAb,GAAsB,EAA7B;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;;;EACIwP,cAAc,CAAChT,SAAf,CAAyBkO,WAAzB,GAAuC,UAAUC,SAAV,EAAqBnM,KAArB,EAA4BoM,YAA5B,EAA0C;IAC7E,IAAIC,WAAW,GAAG,EAAlB;IACA,IAAIrD,GAAG,GAAGmD,SAAS,CAAChL,KAApB;IACA,IAAI8P,MAAM,GAAGjI,GAAG,YAAYtD,IAA5B;;IACA,IAAI1F,KAAK,YAAYxB,KAArB,EAA4B;MACxB,IAAI6C,OAAO,GAAG,KAAKwE,eAAL,CAAqB7F,KAArB,CAAd;;MACA,KAAK,IAAIkB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,OAAO,CAACiF,OAAR,CAAgB3F,MAApC,EAA4CO,CAAC,EAA7C,EAAiD;QAC7C,IAAIG,OAAO,CAACiF,OAAR,CAAgBpF,CAAhB,EAAmBM,CAAnB,CAAqBV,GAArB,KAA6BqL,SAAS,CAAChL,KAA3C,EAAkD;UAC9CiL,YAAY,GAAG,IAAf;QACH;MACJ;IACJ;;IACDC,WAAW,GAAGlM,MAAM,CAACnC,SAAP,CAAiBkO,WAAjB,CAA6BzK,IAA7B,CAAkC,IAAlC,EAAwC0K,SAAxC,EAAmDnM,KAAnD,EAA0DoM,YAA1D,CAAd;;IACA,IAAI6E,MAAJ,EAAY;MACR5E,WAAW,GAAGA,WAAW,CAAC3H,OAAZ,CAAoB,iBAApB,EAAuC,IAAvC,CAAd;IACH;;IACD,IAAInG,QAAQ,CAACoJ,KAAT,CAAe+E,MAAf,CAAsB1D,GAAtB,CAAJ,EAAgC;MAC5BqD,WAAW,GAAGA,WAAW,CAAC3H,OAAZ,CAAoB,MAApB,EAA4B,EAA5B,EAAgCA,OAAhC,CAAwC,IAAxC,EAA8C,EAA9C,CAAd;IACH;;IACD,OAAO2H,WAAP;EACH,CApBD;EAqBA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI2E,cAAc,CAAChT,SAAf,CAAyBqP,YAAzB,GAAwC,UAAU7L,CAAV,EAAa;IACjD,IAAIlC,MAAM,GAAG,KAAKO,GAAL,CAAS0G,QAAT,IAAqB,EAAlC;IACAjH,MAAM,CAACiC,IAAP,CAAYC,CAAC,CAACV,GAAd;IACA,KAAKjB,GAAL,CAAS0G,QAAT,GAAoBjH,MAApB;EACH,CAJD;EAKA;AACJ;AACA;AACA;;;EACI0R,cAAc,CAAChT,SAAf,CAAyB6F,QAAzB,GAAoC,UAAUrC,CAAV,EAAa;IAC7C,OAAO,KAAK3B,GAAL,CAAS0G,QAAT,CAAkB2G,IAAlB,CAAuB,MAAvB,CAAP;EACH,CAFD;EAGA;AACJ;AACA;AACA;;;EACI8D,cAAc,CAAChT,SAAf,CAAyBkT,QAAzB,GAAoC,UAAU1P,CAAV,EAAa;IAC7C,IAAI8J,KAAK,GAAG,IAAZ;;IACA,IAAI6F,QAAQ,GAAG,EAAf;IACA,IAAIC,QAAQ,GAAG,EAAf;IACA,IAAI9I,OAAO,GAAG9G,CAAC,CAAC8G,OAAF,CAAU5H,KAAV,EAAd;IACA,IAAI2Q,KAAK,GAAG,EAAZ;IACA,IAAIhJ,OAAO,GAAG7G,CAAC,CAAC6G,OAAF,CAAU5E,MAAV,CAAiB,UAAU6N,IAAV,EAAgB;MAAE,OAAOA,IAAI,CAACtJ,OAAL,CAAa,GAAb,IAAoB,CAAC,CAA5B;IAAgC,CAAnE,CAAd;IACAK,OAAO,CAAC4H,OAAR,CAAgB,UAAU/Q,MAAV,EAAkB;MAC9B,IAAIqS,MAAM,GAAGrS,MAAM,CAAC8O,KAAP,CAAa,GAAb,CAAb;;MACA,IAAI,EAAEuD,MAAM,CAAC,CAAD,CAAN,IAAaJ,QAAf,CAAJ,EAA8B;QAC1BA,QAAQ,CAACI,MAAM,CAAC,CAAD,CAAP,CAAR,GAAsB,EAAtB;MACH;;MACDJ,QAAQ,CAACI,MAAM,CAAC,CAAD,CAAP,CAAR,CAAoBhQ,IAApB,CAAyBgQ,MAAM,CAAC,CAAD,CAA/B;IACH,CAND,EAP6C,CAc7C;;IACA/T,MAAM,CAACsJ,IAAP,CAAYqK,QAAZ,EAAsBlB,OAAtB,CAA8B,UAAUvQ,MAAV,EAAkB;MAC5C,IAAK4I,OAAO,CAACN,OAAR,CAAgBtI,MAAhB,MAA4B,CAAC,CAAlC,EAAsC;QAClC4I,OAAO,CAAC/G,IAAR,CAAa7B,MAAb;MACH;IACJ,CAJD;IAKA4I,OAAO,CAAC2H,OAAR,CAAgB,UAAUvQ,MAAV,EAAkB;MAC9B0R,QAAQ,CAAC1R,MAAD,CAAR,GAAmBA,MAAM,IAAIyR,QAAV,GAAqBzR,MAAM,GAAG,GAAT,GAAe4L,KAAK,CAACxM,OAAN,CAAcI,MAA7B,GAAsC,GAAtC,GAA4CiS,QAAQ,CAACzR,MAAD,CAAR,CAAiBwN,IAAjB,CAAsB,GAAtB,CAA5C,GAAyE,GAA9F,GAAoGxN,MAAvH;IACH,CAFD;IAGAlC,MAAM,CAACsJ,IAAP,CAAYsK,QAAZ,EAAsBnB,OAAtB,CAA8B,UAAUuB,EAAV,EAAc;MAAE,OAAOH,KAAK,CAAC9P,IAAN,CAAW6P,QAAQ,CAACI,EAAD,CAAnB,CAAP;IAAkC,CAAhF;IACA,OAAOH,KAAK,CAACnE,IAAN,CAAW,GAAX,CAAP;EACH,CAzBD;EA0BA;AACJ;AACA;AACA;;;EACI8D,cAAc,CAAChT,SAAf,CAAyByT,UAAzB,GAAsC,UAAUC,cAAV,EAA0B;IAC5D,IAAIvK,MAAM,GAAGuK,cAAc,CAACC,GAAf,CAAmB,UAAUjQ,KAAV,EAAiB;MAAE,OAAO0J,YAAY,CAACmB,QAAb,CAAsB7K,KAAtB,CAAP;IAAsC,CAA5E,EAA8EwL,IAA9E,CAAmF,GAAnF,CAAb;IACA,OAAO,cAAc/F,MAAd,GAAuB,IAA9B;EACH,CAHD;EAIA;AACJ;AACA;AACA;;;EACI6J,cAAc,CAAChT,SAAf,CAAyBqH,QAAzB,GAAoC,UAAU7D,CAAV,EAAa;IAC7C,OAAOrB,MAAM,CAACnC,SAAP,CAAiBqH,QAAjB,CAA0B5D,IAA1B,CAA+B,IAA/B,EAAqCD,CAAC,CAACiC,MAAF,CAAS,UAAU6N,IAAV,EAAgB;MAAE,OAAOA,IAAI,CAACtJ,OAAL,CAAa,GAAb,MAAsB,CAAC,CAA9B;IAAkC,CAA7D,CAArC,CAAP;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIgJ,cAAc,CAAChT,SAAf,CAAyBoM,UAAzB,GAAsC,UAAUpH,EAAV,EAAcmD,OAAd,EAAuBuH,QAAvB,EAAiC;IACnE,IAAIA,QAAQ,CAAC/N,IAAT,KAAkB,MAAlB,IAA4B+N,QAAQ,CAAC/N,IAAT,KAAkB,KAA9C,IAAuD+N,QAAQ,CAAC/N,IAAT,KAAkB,OAA7E,EAAsF;MAClFwG,OAAO,CAACwH,gBAAR,CAAyB,QAAzB,EAAmC,uBAAnC;IACH;;IACDxH,OAAO,CAACwH,gBAAR,CAAyB,QAAzB,EAAmC,KAAK7O,OAAL,CAAayM,MAAhD;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIyF,cAAc,CAAChT,SAAf,CAAyB8B,eAAzB,GAA2C,UAAUC,IAAV,EAAgBlB,EAAhB,EAAoBmB,KAApB,EAA2BC,GAA3B,EAAgCkG,OAAhC,EAAyClD,OAAzC,EAAkD;IACzF,IAAI2O,QAAQ,GAAG,gBAAf;;IACA,IAAKzL,OAAO,IAAIA,OAAO,CAACxG,IAAR,KAAiB,KAA7B,IAAuC,CAAC,KAAKmO,OAA7C,IAAwD/N,IAAI,CAAC6R,QAAD,CAAhE,EAA4E;MACxE,IAAIC,OAAO,GAAG9R,IAAI,CAAC6R,QAAD,CAAJ,CAAe5D,KAAf,CAAqB,aAArB,CAAd;MACA,KAAKF,OAAL,GAAe+D,OAAO,CAAC,CAAD,CAAtB;MACA,KAAK5D,iBAAL,GAAyB4D,OAAO,CAAC,CAAD,CAAhC;IACH;;IACD,IAAIhK,OAAO,GAAG,SAAd;IACA,IAAIhI,GAAG,GAAGsG,OAAO,IAAIA,OAAO,CAAC0B,OAAD,CAA5B;;IACA,IAAIwG,aAAa,GAAGlO,MAAM,CAACnC,SAAP,CAAiBsQ,oBAAjB,CAAsC7M,IAAtC,CAA2C,IAA3C,EAAiD1B,IAAjD,EAAuDC,KAAvD,EAA8DC,GAA9D,EAAmEkG,OAAnE,EAA4ElD,OAA5E,CAApB;;IACA,IAAIoL,aAAJ,EAAmB;MACf,OAAOA,aAAP;IACH;;IACD,IAAI9O,KAAK,GAAG,IAAZ;IACA,IAAIuS,SAAS,GAAG,cAAhB;;IACA,IAAI9R,KAAK,IAAIA,KAAK,CAAC+B,eAAnB,EAAoC;MAChC,IAAI+P,SAAS,IAAI/R,IAAjB,EAAuB;QACnBR,KAAK,GAAGQ,IAAI,CAAC+R,SAAD,CAAZ;MACH;IACJ;;IACD/R,IAAI,GAAG,CAAC3B,iBAAiB,CAAC2B,IAAI,CAACoB,KAAN,CAAlB,GAAiCpB,IAAI,CAACoB,KAAtC,GAA8CpB,IAArD;IACA,IAAI6B,IAAI,GAAG,EAAX;IACAA,IAAI,CAACrC,KAAL,GAAaA,KAAb;IACAqC,IAAI,CAACpB,MAAL,GAAcT,IAAd;IACA,KAAKmJ,kBAAL,CAAwBrJ,GAAxB,EAA6BE,IAA7B,EAAmC6B,IAAnC,EAAyC,IAAzC,EAA+C5B,KAA/C;IACA,OAAOzB,QAAQ,CAAC2I,MAAT,CAAgB3H,KAAhB,IAAyBqC,IAAI,CAACpB,MAA9B,GAAuC;MAAEA,MAAM,EAAEoB,IAAI,CAACpB,MAAf;MAAuBjB,KAAK,EAAEA,KAA9B;MAAqCE,UAAU,EAAEmC,IAAI,CAACnC;IAAtD,CAA9C;EACH,CA1BD;;EA2BA,OAAOuR,cAAP;AACH,CA3LmC,CA2LlC5F,YA3LkC,CAApC;;AA4LA,SAAS4F,cAAT;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIe,aAAa;AAAG;AAAe,UAAU5R,MAAV,EAAkB;EACjD/C,SAAS,CAAC2U,aAAD,EAAgB5R,MAAhB,CAAT;;EACA,SAAS4R,aAAT,GAAyB;IACrB,OAAO5R,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACC,KAAP,CAAa,IAAb,EAAmBC,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACD0R,aAAa,CAAC/T,SAAd,CAAwBiO,aAAxB,GAAwC,YAAY;IAChD,OAAO,eAAP;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;AACA;;;EACI8F,aAAa,CAAC/T,SAAd,CAAwBqF,MAAxB,GAAiC,UAAUL,EAAV,EAAcjD,IAAd,EAAoBuF,SAApB,EAA+B;IAC5D,OAAO;MACH3F,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAcqG,GAFhB;MAGHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAe3H,IAAf;IAHH,CAAP;EAKH,CAND;EAOA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACIgS,aAAa,CAAC/T,SAAd,CAAwBwF,MAAxB,GAAiC,UAAUR,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0C;IACvE,OAAO;MACH3F,IAAI,EAAE,QADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAcqG,GAAd,GAAoB,GAApB,GAA0B9E,KAF5B;MAGHpB,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevG,KAAf;IAHH,CAAP;EAKH,CAND;EAOA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI4Q,aAAa,CAAC/T,SAAd,CAAwBuF,MAAxB,GAAiC,UAAUP,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0C;IACvE,OAAO;MACH3F,IAAI,EAAE,KADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAcqG,GAFhB;MAGHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevG,KAAf;IAHH,CAAP;EAKH,CAND;;EAOA4Q,aAAa,CAAC/T,SAAd,CAAwB+E,YAAxB,GAAuC,UAAUC,EAAV,EAAcC,OAAd,EAAuBzB,CAAvB,EAA0B;IAC7D,IAAI8J,KAAK,GAAG,IAAZ;;IACA,IAAI8D,WAAW,GAAG5N,CAAC,CAAC8K,IAAF,GAAS/N,QAAQ,CAAC8Q,OAAT,CAAiB,KAAKvQ,OAAL,CAAa6M,QAA9B,CAA3B;IACA,IAAI1F,GAAG,GAAGjD,EAAE,CAACpD,UAAH,CAAcqG,GAAd,CAAkBvB,OAAlB,CAA0B,MAA1B,EAAkC,MAAM,KAAK5F,OAAL,CAAa2M,KAArD,CAAV;IACAjK,CAAC,CAACyE,GAAF,GAAQ,KAAKgI,iBAAL,GAAyB,KAAKA,iBAA9B,GAAkDzM,CAAC,CAACyE,GAA5D;IACA,IAAI/D,GAAG,GAAG,EAAV;;IACA,IAAI8P,OAAO,GAAG,UAAU9Q,CAAV,EAAa+Q,CAAb,EAAgB;MAC1BhP,OAAO,CAACG,YAAR,CAAqB6M,OAArB,CAA6B,UAAUjM,CAAV,EAAa1G,CAAb,EAAgB;QACzC,IAAIsS,IAAI,GAAG;UACP,UAAU,OADH;UAEP,OAAO,UAAU7P,IAAV,EAAgBmB,CAAhB,EAAmBJ,GAAnB,EAAwB;YAAE,OAAO,EAAP;UAAY,CAFtC;UAGP,QAAQ,UAAUf,IAAV,EAAgBmB,CAAhB,EAAmB;YAAE,OAAOuG,IAAI,CAACC,SAAL,CAAe3H,IAAI,CAACmB,CAAD,CAAnB,IAA0B,MAAjC;UAA0C;QAHhE,CAAX;QAKAgB,GAAG,CAACX,IAAJ,CAAS,OAAO6N,WAAhB;QACAlN,GAAG,CAACX,IAAJ,CAAS,iDAAT,EAA4D,EAA5D;QACAW,GAAG,CAACX,IAAJ,CAAS,UAAU,OAAV,IAAqByB,EAAE,CAACpD,UAAH,CAAcyK,SAAd,IAA2BrH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoDpI,CAAC,CAACyE,GAA3E,IACH2J,IAAI,CAAC3J,GAAL,CAAShD,OAAO,CAACG,YAAjB,EAA+BlC,CAA/B,EAAkCM,CAAC,CAACV,GAApC,CADG,GACwC,WADjD;QAEAoB,GAAG,CAACX,IAAJ,CAAS,mBAAmB,iCAA5B;QACAW,GAAG,CAACX,IAAJ,CAAS,WAAW2Q,QAAQ,CAACC,IAA7B;QACAjQ,GAAG,CAACX,IAAJ,CAAS,EAAT,EAAayC,CAAC,GAAGyD,IAAI,CAACC,SAAL,CAAe1D,CAAf,CAAH,GAAuB,EAArC;MACH,CAbD;IAcH,CAfD,CAN6D,CAsB7D;;;IACA,KAAK,IAAI9C,CAAC,GAAG,CAAR,EAAW+Q,CAAC,GAAGhP,OAAO,CAACG,YAAR,CAAqBzC,MAAzC,EAAiDO,CAAC,GAAG+Q,CAArD,EAAwD/Q,CAAC,EAAzD,EAA6D;MACzD8Q,OAAO,CAAC9Q,CAAD,EAAI+Q,CAAJ,CAAP;IACH;;IACD,IAAIG,OAAO,GAAG,UAAUlR,CAAV,EAAa+Q,CAAb,EAAgB;MAC1BhP,OAAO,CAACK,cAAR,CAAuB2M,OAAvB,CAA+B,UAAUjM,CAAV,EAAa1G,CAAb,EAAgB;QAC3C,IAAIsS,IAAI,GAAG;UACP,UAAUtE,KAAK,CAACxM,OAAN,CAAckN,UAAd,GAA2B,GAD9B;UAEP,OAAO,UAAUjM,IAAV,EAAgBmB,CAAhB,EAAmBJ,GAAnB,EAAwB;YAAE,OAAO,EAAP;UAAY,CAFtC;UAGP,QAAQ,UAAUf,IAAV,EAAgBmB,CAAhB,EAAmB;YAAE,OAAOuG,IAAI,CAACC,SAAL,CAAe3H,IAAI,CAACmB,CAAD,CAAnB,IAA0B,MAAjC;UAA0C;QAHhE,CAAX;QAKAgB,GAAG,CAACX,IAAJ,CAAS,OAAO6N,WAAhB;QACAlN,GAAG,CAACX,IAAJ,CAAS,iDAAT,EAA4D,EAA5D;QACAW,GAAG,CAACX,IAAJ,CAAS,SAAS,OAAT,IAAoByB,EAAE,CAACpD,UAAH,CAAc2K,SAAd,IAA2BvH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoDpI,CAAC,CAACyE,GAA1E,IACH2J,IAAI,CAAC3J,GAAL,CAAShD,OAAO,CAACK,cAAjB,EAAiCpC,CAAjC,EAAoCM,CAAC,CAACV,GAAtC,CADG,GAC0C,WADnD;QAEAoB,GAAG,CAACX,IAAJ,CAAS,mBAAmB,iCAA5B;QACAW,GAAG,CAACX,IAAJ,CAAS,WAAW2Q,QAAQ,CAACC,IAA7B;QACAjQ,GAAG,CAACX,IAAJ,CAAS,EAAT,EAAayC,CAAC,GAAGyD,IAAI,CAACC,SAAL,CAAe1D,CAAf,CAAH,GAAuB,EAArC;MACH,CAbD;IAcH,CAfD,CA1B6D,CA0C7D;;;IACA,KAAK,IAAI9C,CAAC,GAAG,CAAR,EAAW+Q,CAAC,GAAGhP,OAAO,CAACK,cAAR,CAAuB3C,MAA3C,EAAmDO,CAAC,GAAG+Q,CAAvD,EAA0D/Q,CAAC,EAA3D,EAA+D;MAC3DkR,OAAO,CAAClR,CAAD,EAAI+Q,CAAJ,CAAP;IACH;;IACD,IAAII,OAAO,GAAG,UAAUnR,CAAV,EAAa+Q,CAAb,EAAgB;MAC1BhP,OAAO,CAACE,cAAR,CAAuB8M,OAAvB,CAA+B,UAAUjM,CAAV,EAAa1G,CAAb,EAAgB;QAC3C,IAAIgV,KAAK,GAAG;UACR,OAAO,SADC;UAER,OAAO,UAAUvS,IAAV,EAAgBmB,CAAhB,EAAmBJ,GAAnB,EAAwB;YAC3B,IAAImF,GAAG,GAAG1H,QAAQ,CAAC0F,SAAT,CAAmBnD,GAAnB,EAAwBf,IAAI,CAACmB,CAAD,CAA5B,CAAV;;YACA,IAAI,OAAO+E,GAAP,KAAe,QAAf,IAA2B1H,QAAQ,CAACoJ,KAAT,CAAe+E,MAAf,CAAsBzG,GAAtB,CAA/B,EAA2D;cACvD,OAAO,MAAMA,GAAb;YACH,CAFD,MAGK,IAAIA,GAAG,YAAYP,IAAnB,EAAyB;cAC1B,IAAI6M,OAAO,GAAGxS,IAAI,CAACmB,CAAD,CAAJ,CAAQJ,GAAR,CAAd;cACA,OAAO,MAAMyR,OAAO,CAACzC,MAAR,EAAb;YACH,CAHI,MAIA;cACD,OAAO,OAAO7J,GAAP,GAAa,GAApB;YACH;UACJ,CAdO;UAeR,QAAQ,UAAUlG,IAAV,EAAgBmB,CAAhB,EAAmB;YAAE,OAAO,EAAP;UAAY;QAfjC,CAAZ;QAiBAgB,GAAG,CAACX,IAAJ,CAAS,OAAO6N,WAAhB;QACAlN,GAAG,CAACX,IAAJ,CAAS,iDAAT,EAA4D,EAA5D;QACAW,GAAG,CAACX,IAAJ,CAAS,YAAY,OAAZ,IAAuByB,EAAE,CAACpD,UAAH,CAAciK,SAAd,IAA2B7G,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoDpI,CAAC,CAACyE,GAA7E,IACHqM,KAAK,CAACrM,GAAN,CAAUhD,OAAO,CAACE,cAAlB,EAAkCjC,CAAlC,EAAqCM,CAAC,CAACV,GAAvC,CADG,GAC2C,WADpD;QAEAoB,GAAG,CAACX,IAAJ,CAAS,mBAAmB,iCAA5B;QACAW,GAAG,CAACX,IAAJ,CAAS,WAAW2Q,QAAQ,CAACC,IAA7B;QACAjQ,GAAG,CAACX,IAAJ,CAAS,EAAT,EAAayC,CAAC,GAAGyD,IAAI,CAACC,SAAL,CAAe1D,CAAf,CAAH,GAAuB,EAArC;MACH,CAzBD;IA0BH,CA3BD,CA9C6D,CA0E7D;;;IACA,KAAK,IAAI9C,CAAC,GAAG,CAAR,EAAW+Q,CAAC,GAAGhP,OAAO,CAACE,cAAR,CAAuBxC,MAA3C,EAAmDO,CAAC,GAAG+Q,CAAvD,EAA0D/Q,CAAC,EAA3D,EAA+D;MAC3DmR,OAAO,CAACnR,CAAD,EAAI+Q,CAAJ,CAAP;IACH;;IACD/P,GAAG,CAACX,IAAJ,CAAS,OAAO6N,WAAP,GAAqB,IAA9B,EAAoC,EAApC;IACA,OAAO;MACHzP,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEA,GAFF;MAGH6B,WAAW,EAAE,+BAA+BsH,WAHzC;MAIHrP,IAAI,EAAEmC,GAAG,CAACgL,IAAJ,CAAS,MAAT;IAJH,CAAP;EAMH,CArFD;EAsFA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACI6E,aAAa,CAAC/T,SAAd,CAAwBoM,UAAxB,GAAqC,UAAUpH,EAAV,EAAcmD,OAAd,EAAuBuH,QAAvB,EAAiC;IAClEvH,OAAO,CAACwH,gBAAR,CAAyB,QAAzB,EAAmC,gDAAnC;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIoE,aAAa,CAAC/T,SAAd,CAAwB8B,eAAxB,GAA0C,UAAUC,IAAV,EAAgBlB,EAAhB,EAAoBmB,KAApB,EAA2BC,GAA3B,EAAgCkG,OAAhC,EAAyClD,OAAzC,EAAkD;IACxF,IAAI4E,OAAO,GAAG,SAAd;IACA,IAAIhI,GAAG,GAAGsG,OAAO,IAAIA,OAAO,CAAC0B,OAAD,CAA5B;IACA,IAAItI,KAAK,GAAG,IAAZ;IACA,IAAIqC,IAAI,GAAG,EAAX;;IACA,IAAIuE,OAAO,IAAIA,OAAO,CAACxG,IAAR,CAAagN,WAAb,OAA+B,MAA9C,EAAsD;MAClD,IAAI4B,YAAY,GAAGtO,GAAG,IAAIkG,OAAO,CAACoC,iBAAR,CAA0B,oBAA1B,CAA1B;MACA,IAAIiG,OAAO,GAAID,YAAY,IAAIE,QAAQ,CAACF,YAAD,EAAe,EAAf,CAAzB,IAAgD,CAA9D;;MACA,IAAIvO,KAAK,IAAIA,KAAK,CAAC+B,eAAnB,EAAoC;QAChC,IAAI,CAACxD,QAAQ,CAAC2I,MAAT,CAAgBnH,IAAI,CAACyS,KAArB,CAAL,EAAkC;UAC9BjT,KAAK,GAAGQ,IAAI,CAACyS,KAAb;QACH;MACJ;;MACD,IAAIhE,OAAO,GAAG,CAAV,IAAezO,IAAI,CAAC0S,KAAxB,EAA+B;QAC3B1S,IAAI,GAAGA,IAAI,CAAC0S,KAAZ;MACH;;MACD7Q,IAAI,CAACrC,KAAL,GAAaA,KAAb;MACAqC,IAAI,CAACpB,MAAL,GAAcT,IAAd;MACA,KAAKmJ,kBAAL,CAAwBrJ,GAAxB,EAA6BE,IAA7B,EAAmC6B,IAAnC,EAAyC,IAAzC,EAA+C5B,KAA/C;IACH;;IACD4B,IAAI,CAACpB,MAAL,GAAcoB,IAAI,CAACpB,MAAL,IAAeT,IAA7B;IACA,OAAOxB,QAAQ,CAAC2I,MAAT,CAAgB3H,KAAhB,IAAyBqC,IAAI,CAACpB,MAA9B,GAAuC;MAAEA,MAAM,EAAEoB,IAAI,CAACpB,MAAf;MAAuBjB,KAAK,EAAEqC,IAAI,CAACrC,KAAnC;MAA0CE,UAAU,EAAEmC,IAAI,CAACnC;IAA3D,CAA9C;EACH,CAtBD;;EAuBA,OAAOsS,aAAP;AACH,CApLkC,CAoLjC3G,YApLiC,CAAnC;;AAqLA,SAAS2G,aAAT;AACA;AACA;AACA;AACA;;AACA,IAAIW,gBAAgB;AAAG;AAAe,UAAUvS,MAAV,EAAkB;EACpD/C,SAAS,CAACsV,gBAAD,EAAmBvS,MAAnB,CAAT;;EACA,SAASuS,gBAAT,GAA4B;IACxB,OAAOvS,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACC,KAAP,CAAa,IAAb,EAAmBC,SAAnB,CAAnB,IAAoD,IAA3D;EACH;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIqS,gBAAgB,CAAC1U,SAAjB,CAA2BsC,YAA3B,GAA0C,UAAU0C,EAAV,EAAchD,KAAd,EAAqB4F,gBAArB,EAAuC;IAC7E,IAAIlC,GAAG,GAAG,IAAIiC,UAAJ,GAAiBrF,YAAjB,CAA8B0C,EAA9B,EAAkChD,KAAlC,EAAyC4F,gBAAzC,CAAV;IACA,IAAI+M,OAAO,GAAG,MAAd;IACA,IAAI5S,IAAI,GAAGxB,QAAQ,CAACoJ,KAAT,CAAee,SAAf,CAAyBhF,GAAG,CAACiP,OAAD,CAA5B,CAAX;IACA,IAAInS,MAAM,GAAG,EAAb;IACA,IAAIW,KAAK,GAAG,OAAZ;;IACA,IAAIpB,IAAI,CAACmI,KAAT,EAAgB;MACZ,KAAK,IAAIhH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,IAAI,CAACmI,KAAL,CAAWvH,MAA/B,EAAuCO,CAAC,EAAxC,EAA4C;QACxC,IAAIgH,KAAK,GAAGnI,IAAI,CAACmI,KAAL,CAAWhH,CAAX,CAAZ;QACA,IAAIJ,GAAG,GAAGtD,MAAM,CAACsJ,IAAP,CAAYoB,KAAZ,EAAmB,CAAnB,CAAV;QACA1H,MAAM,CAACM,GAAD,CAAN,GAAcoH,KAAK,CAACpH,GAAD,CAAnB;MACH;IACJ;;IACDN,MAAM,CAACW,KAAD,CAAN,GAAgBpB,IAAhB;IACA,IAAI8H,OAAO,GAAG,SAAd;IACA,IAAI5B,GAAG,GAAG,KAAV;IACA,OAAO;MACHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAelH,MAAf,CADH;MAEHyF,GAAG,EAAEvC,GAAG,CAACuC,GAAD,CAFL;MAGH4B,OAAO,EAAEnE,GAAG,CAACmE,OAAD,CAHT;MAIHlI,IAAI,EAAE,MAJH;MAKHmI,WAAW,EAAE;IALV,CAAP;EAOH,CAvBD;;EAwBA,OAAO4K,gBAAP;AACH,CAtCqC,CAsCpC/M,UAtCoC,CAAtC;;AAuCA,SAAS+M,gBAAT;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIE,iBAAiB;AAAG;AAAe,UAAUzS,MAAV,EAAkB;EACrD/C,SAAS,CAACwV,iBAAD,EAAoBzS,MAApB,CAAT;EACA;AACJ;AACA;;;EACI,SAASyS,iBAAT,GAA6B;IACzB,IAAItH,KAAK,GAAGnL,MAAM,CAACsB,IAAP,CAAY,IAAZ,KAAqB,IAAjC;;IACApD,QAAQ,CAAC,YAAD,EAAesH,UAAU,CAAC3H,SAAX,CAAqBoM,UAApC,EAAgDkB,KAAhD,CAAR;IACA,OAAOA,KAAP;EACH;;EACDsH,iBAAiB,CAAC5U,SAAlB,CAA4BqF,MAA5B,GAAqC,UAAUL,EAAV,EAAcjD,IAAd,EAAoBuF,SAApB,EAA+BtF,KAA/B,EAAsCuF,QAAtC,EAAgD;IACjF,KAAK1F,GAAL,CAAS0F,QAAT,GAAoBA,QAApB;IACA,KAAKyG,UAAL,GAAkB,KAAlB;IACA,OAAO;MACH/F,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAcyK,SAAd,IAA2BrH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoD5G,EAAE,CAACpD,UAAH,CAAcqG,GADpE;MAEHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5BgD,KAAK,EAAEpB,IADqB;QAE5BmK,KAAK,EAAE5E,SAFqB;QAG5BuD,MAAM,EAAE;MAHoB,CAAL,EAIxBtK,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CAJwB,CAArB;IAFH,CAAP;EAQH,CAXD;;EAYA4S,iBAAiB,CAAC5U,SAAlB,CAA4BwF,MAA5B,GAAqC,UAAUR,EAAV,EAAcyC,QAAd,EAAwBuD,GAAxB,EAA6B1D,SAA7B,EAAwCtF,KAAxC,EAA+C;IAChFG,MAAM,CAACnC,SAAP,CAAiBwF,MAAjB,CAAwB/B,IAAxB,CAA6B,IAA7B,EAAmCuB,EAAnC,EAAuCyC,QAAvC,EAAiDuD,GAAjD;;IACA,OAAO;MACHrJ,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAciK,SAAd,IAA2B7G,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoD5G,EAAE,CAACpD,UAAH,CAAcqG,GAFpE;MAGHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5B2C,GAAG,EAAEkI,GADuB;QAE5BsB,SAAS,EAAE7E,QAFiB;QAG5ByE,KAAK,EAAE5E,SAHqB;QAI5BuD,MAAM,EAAE;MAJoB,CAAL,EAKxBtK,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CALwB,CAArB;IAHH,CAAP;EAUH,CAZD;;EAaA4S,iBAAiB,CAAC5U,SAAlB,CAA4BuF,MAA5B,GAAqC,UAAUP,EAAV,EAAcyC,QAAd,EAAwBuD,GAAxB,EAA6B1D,SAA7B,EAAwCtF,KAAxC,EAA+C;IAChF,KAAKgM,UAAL,GAAkB,QAAlB;IACA,KAAK6G,SAAL,GAAiBpN,QAAjB;IACA,OAAO;MACH9F,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAc2K,SAAd,IAA2BvH,EAAE,CAACpD,UAAH,CAAcgK,OAAzC,IAAoD5G,EAAE,CAACpD,UAAH,CAAcqG,GAFpE;MAGHlG,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5BgD,KAAK,EAAE6H,GADqB;QAE5BH,MAAM,EAAE,QAFoB;QAG5ByB,SAAS,EAAE7E,QAHiB;QAI5B3E,GAAG,EAAEkI,GAAG,CAACvD,QAAD,CAJoB;QAK5ByE,KAAK,EAAE5E;MALqB,CAAL,EAMxB/G,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CANwB,CAArB;IAHH,CAAP;EAWH,CAdD;;EAeA4S,iBAAiB,CAAC5U,SAAlB,CAA4B8B,eAA5B,GAA8C,UAAUC,IAAV,EAAgBlB,EAAhB,EAAoBmB,KAApB,EAA2BC,GAA3B,EAAgCkG,OAAhC,EAAyClD,OAAzC,EAAkDzB,CAAlD,EAAqD;IAC/F,IAAIN,CAAJ;IACAnB,IAAI,GAAGoG,OAAO,GAAGsB,IAAI,CAACE,KAAL,CAAWxB,OAAO,CAACpG,IAAnB,CAAH,GAA8BA,IAA5C;;IACA,IAAI,KAAKiM,UAAL,KAAoB,KAAxB,EAA+B;MAC3B7L,MAAM,CAACnC,SAAP,CAAiBqF,MAAjB,CAAwB5B,IAAxB,CAA6B,IAA7B,EAAmC5C,EAAnC,EAAuCkB,IAAvC,EAA6C,IAA7C,EAAmD,IAAnD,EAAyD,KAAKF,GAAL,CAAS0F,QAAlE;IACH;;IACD,IAAI,KAAKyG,UAAL,KAAoB,QAAxB,EAAkC;MAC9B7L,MAAM,CAACnC,SAAP,CAAiBuF,MAAjB,CAAwB9B,IAAxB,CAA6B,IAA7B,EAAmC5C,EAAnC,EAAuC,KAAKgU,SAA5C,EAAuD9S,IAAvD;IACH;;IACD,KAAKiM,UAAL,GAAkBrK,SAAlB;;IACA,IAAI5B,IAAI,CAACiK,KAAT,EAAgB;MACZ,KAAK9I,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGnB,IAAI,CAACiK,KAAL,CAAWrJ,MAA3B,EAAmCO,CAAC,EAApC,EAAwC;QACpCf,MAAM,CAACnC,SAAP,CAAiBqF,MAAjB,CAAwB5B,IAAxB,CAA6B,IAA7B,EAAmC5C,EAAnC,EAAuCkB,IAAI,CAACiK,KAAL,CAAW9I,CAAX,CAAvC;MACH;IACJ;;IACD,IAAInB,IAAI,CAACgK,OAAT,EAAkB;MACd,KAAK7I,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGnB,IAAI,CAACgK,OAAL,CAAapJ,MAA7B,EAAqCO,CAAC,EAAtC,EAA0C;QACtCf,MAAM,CAACnC,SAAP,CAAiBuF,MAAjB,CAAwB9B,IAAxB,CAA6B,IAA7B,EAAmC5C,EAAnC,EAAuC2C,CAAC,CAACV,GAAzC,EAA8Cf,IAAI,CAACgK,OAAL,CAAa7I,CAAb,CAA9C;MACH;IACJ;;IACD,IAAInB,IAAI,CAACkK,OAAT,EAAkB;MACd,KAAK/I,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGnB,IAAI,CAACkK,OAAL,CAAatJ,MAA7B,EAAqCO,CAAC,EAAtC,EAA0C;QACtCf,MAAM,CAACnC,SAAP,CAAiBwF,MAAjB,CAAwB/B,IAAxB,CAA6B,IAA7B,EAAmC5C,EAAnC,EAAuC2C,CAAC,CAACV,GAAzC,EAA8Cf,IAAI,CAACkK,OAAL,CAAa/I,CAAb,CAA9C;MACH;IACJ;;IACD,OAAOnB,IAAP;EACH,CA1BD;EA2BA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACI6S,iBAAiB,CAAC5U,SAAlB,CAA4B+E,YAA5B,GAA2C,UAAUC,EAAV,EAAcC,OAAd,EAAuBzB,CAAvB,EAA0BxB,KAA1B,EAAiC0J,QAAjC,EAA2C;IAClF,OAAO;MACH/J,IAAI,EAAE,MADH;MAEHsG,GAAG,EAAEjD,EAAE,CAACpD,UAAH,CAAc+J,QAAd,IAA0B3G,EAAE,CAACpD,UAAH,CAAcgK,OAAxC,IAAmD5G,EAAE,CAACpD,UAAH,CAAcqG,GAFnE;MAGH6B,WAAW,EAAE,iCAHV;MAIHgC,QAAQ,EAAE,MAJP;MAKH/J,IAAI,EAAE0H,IAAI,CAACC,SAAL,CAAevJ,MAAM,CAAC,EAAD,EAAK;QAC5B4L,OAAO,EAAE9G,OAAO,CAACK,cADW;QAE5B0G,KAAK,EAAE/G,OAAO,CAACG,YAFa;QAG5B6G,OAAO,EAAEhH,OAAO,CAACE,cAHW;QAI5B0F,MAAM,EAAE,OAJoB;QAK5BqB,KAAK,EAAE1I,CAAC,CAACyE,GALmB;QAM5BnF,GAAG,EAAEU,CAAC,CAACV;MANqB,CAAL,EAOxBvC,QAAQ,CAAC4L,YAAT,CAAsB,IAAtB,EAA4BnH,EAA5B,EAAgChD,KAAhC,CAPwB,CAArB;IALH,CAAP;EAcH,CAfD;;EAgBA4S,iBAAiB,CAAC5U,SAAlB,CAA4BkN,SAA5B,GAAwC,UAAUpM,OAAV,EAAmB;IACvD,IAAIgU,SAAS,GAAG,IAAInN,UAAJ,EAAhB;IACAmN,SAAS,CAAC5H,SAAV,CAAoBpM,OAApB;EACH,CAHD;;EAIA,OAAO8T,iBAAP;AACH,CA1GsC,CA0GrC1S,WA1GqC,CAAvC;;AA2GA,SAAS0S,iBAAT;AACA;AACA;AACA;AACA;;AACA,IAAIG,WAAW;AAAG;AAAe,UAAU5S,MAAV,EAAkB;EAC/C/C,SAAS,CAAC2V,WAAD,EAAc5S,MAAd,CAAT;;EACA,SAAS4S,WAAT,CAAqB1H,KAArB,EAA4B;IACxB,IAAIC,KAAK,GAAGnL,MAAM,CAACsB,IAAP,CAAY,IAAZ,KAAqB,IAAjC,CADwB,CAExB;;;IACA6J,KAAK,CAACxM,OAAN,GAAgBX,MAAM,CAAC,EAAD,EAAKmN,KAAK,CAACxM,OAAX,EAAoB;MACtC6T,OAAO,EAAE,IAAIK,QAAJ,EAD6B;MAEtCC,SAAS,EAAE,IAAID,QAAJ,EAF2B;MAGtCE,YAAY,EAAE,IAAIF,QAAJ,EAHwB;MAItCG,YAAY,EAAE,IAAIH,QAAJ,EAJwB;MAKtCI,WAAW,EAAE,IAAIJ,QAAJ;IALyB,CAApB,CAAtB;IAOA7U,MAAM,CAACmN,KAAK,CAACxM,OAAP,EAAgBuM,KAAK,IAAI,EAAzB,CAAN;IACA,OAAOC,KAAP;EACH;;EACDyH,WAAW,CAAC/U,SAAZ,CAAsBiO,aAAtB,GAAsC,YAAY;IAC9C,OAAO,aAAP;EACH,CAFD;;EAGA,OAAO8G,WAAP;AACH,CAnBgC,CAmB/BpN,UAnB+B,CAAjC;;AAoBA,SAASoN,WAAT;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIM,YAAY;AAAG;AAAe,UAAUlT,MAAV,EAAkB;EAChD/C,SAAS,CAACiW,YAAD,EAAelT,MAAf,CAAT;EACA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI,SAASkT,YAAT,CAAsBC,OAAtB,EAA+BC,SAA/B,EAA0C1O,QAA1C,EAAoD;IAChD,IAAIyG,KAAK,GAAGnL,MAAM,CAACsB,IAAP,CAAY,IAAZ,KAAqB,IAAjC;;IACA6J,KAAK,CAACkI,YAAN,GAAqB,KAArB;IACAlI,KAAK,CAACmI,cAAN,GAAuB,KAAvB;;IACA,IAAI,CAACrV,iBAAiB,CAACkV,OAAD,CAAtB,EAAiC;MAC7BhI,KAAK,CAACoI,YAAN,GAAqBJ,OAArB;IACH;;IACDhI,KAAK,CAACzG,QAAN,GAAiBA,QAAjB;IACAyG,KAAK,CAACqI,MAAN,GAAepV,QAAQ,CAAC8Q,OAAT,CAAiB,cAAjB,CAAf;IACA,IAAI3L,GAAG,GAAG;MAAEoD,IAAI,EAAE,EAAR;MAAYqH,OAAO,EAAE;IAArB,CAAV;IACAyF,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BxI,KAAK,CAACqI,MAAlC,EAA0ClM,IAAI,CAACC,SAAL,CAAehE,GAAf,CAA1C;IACA,IAAI4I,IAAI,GAAGhB,KAAK,CAACqI,MAAjB;;IACA,IAAI,CAACvV,iBAAiB,CAACmV,SAAD,CAAtB,EAAmC;MAC/BQ,WAAW,CAAC,YAAY;QACpB,IAAIhU,IAAJ;QACAA,IAAI,GAAGxB,QAAQ,CAACoJ,KAAT,CAAee,SAAf,CAAyBkL,MAAM,CAACC,YAAP,CAAoBG,OAApB,CAA4B1H,IAA5B,CAAzB,CAAP;QACA,IAAI2H,MAAM,GAAG,EAAb;;QACA,KAAK,IAAI/S,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,IAAI,CAACoO,OAAL,CAAaxN,MAAjC,EAAyCO,CAAC,EAA1C,EAA8C;UAC1C,IAAIgT,WAAW,GAAG,CAAC,IAAIxO,IAAJ,EAAnB;UACA,IAAIyO,WAAW,GAAG,CAAC,IAAIzO,IAAJ,CAAS3F,IAAI,CAACoO,OAAL,CAAajN,CAAb,EAAgBqS,SAAzB,CAAnB;UACAxT,IAAI,CAACoO,OAAL,CAAajN,CAAb,EAAgBqS,SAAhB,GAA4BW,WAAW,GAAGC,WAA1C;;UACA,IAAID,WAAW,GAAGC,WAAd,GAA4BZ,SAAhC,EAA2C;YACvCU,MAAM,CAAC1S,IAAP,CAAYL,CAAZ;UACH;QACJ;;QACD,KAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+S,MAAM,CAACtT,MAA3B,EAAmCO,CAAC,EAApC,EAAwC;UACpCnB,IAAI,CAACoO,OAAL,CAAa3I,MAAb,CAAoByO,MAAM,CAAC/S,CAAD,CAA1B,EAA+B,CAA/B;UACAnB,IAAI,CAAC+G,IAAL,CAAUtB,MAAV,CAAiByO,MAAM,CAAC/S,CAAD,CAAvB,EAA4B,CAA5B;QACH;;QACD0S,MAAM,CAACC,YAAP,CAAoBO,UAApB,CAA+B9H,IAA/B;QACAsH,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BxH,IAA5B,EAAkC7E,IAAI,CAACC,SAAL,CAAe3H,IAAf,CAAlC;MACH,CAlBU,EAkBRwT,SAlBQ,CAAX;IAmBH;;IACD,OAAOjI,KAAP;EACH;EACD;AACJ;AACA;AACA;AACA;AACA;;;EACI+H,YAAY,CAACrV,SAAb,CAAuBqW,WAAvB,GAAqC,UAAUpO,GAAV,EAAejG,KAAf,EAAsB;IACvD,IAAIqB,OAAO,GAAG,KAAKwE,eAAL,CAAqB7F,KAArB,CAAd;IACA,IAAI8F,OAAO,GAAGtH,KAAK,CAACuH,gBAAN,CAAuB/F,KAAK,CAACqB,OAA7B,EAAsC,CAAC,UAAD,EAAa,QAAb,EAAuB,QAAvB,EAAiC,QAAjC,EAA2C,SAA3C,CAAtC,CAAd;IACA,IAAIP,GAAG,GAAGmF,GAAV;IACA,IAAIhF,IAAI,GAAG,QAAX;;IACA,IAAIA,IAAI,IAAI6E,OAAZ,EAAqB;MACjBhF,GAAG,IAAIgF,OAAO,CAAC7E,IAAD,CAAP,CAAc8D,SAArB;IACH;;IACD1D,OAAO,CAAC+E,KAAR,CAAc6J,OAAd,CAAsB,UAAUvM,GAAV,EAAe;MACjC5C,GAAG,IAAI4C,GAAG,CAAClC,CAAJ,CAAMkF,SAAN,GAAkBhD,GAAG,CAAClC,CAAJ,CAAMa,SAA/B;IACH,CAFD;IAGAhB,OAAO,CAACgF,MAAR,CAAe4J,OAAf,CAAuB,UAAUvM,GAAV,EAAe;MAClC5C,GAAG,IAAI4C,GAAG,CAAClC,CAAJ,CAAMa,SAAb;IACH,CAFD;IAGAhB,OAAO,CAACkF,QAAR,CAAiB0J,OAAjB,CAAyB,UAAUvM,GAAV,EAAe;MACpC5C,GAAG,IAAI4C,GAAG,CAAClC,CAAJ,CAAM0C,SAAb;IACH,CAFD;;IAGA,KAAK,IAAIT,MAAM,GAAG,CAAlB,EAAqBA,MAAM,GAAGpC,OAAO,CAACiF,OAAR,CAAgB3F,MAA9C,EAAsD8C,MAAM,EAA5D,EAAgE;MAC5D,IAAI6Q,aAAa,GAAGjT,OAAO,CAACiF,OAAR,CAAgB7C,MAAhB,CAApB;;MACA,IAAI6Q,aAAa,CAAC9S,CAAd,CAAgB4L,SAApB,EAA+B;QAC3B,IAAImH,QAAQ,GAAGvU,KAAK,CAACwU,KAAN,EAAf;QACAD,QAAQ,CAAClT,OAAT,GAAmB,EAAnB;;QACA,KAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoT,aAAa,CAAC9S,CAAd,CAAgBwL,UAAhB,CAA2BrM,MAA/C,EAAuDO,CAAC,EAAxD,EAA4D;UACxDqT,QAAQ,CAAClT,OAAT,CAAiBE,IAAjB,CAAsB;YAAED,EAAE,EAAE,SAAN;YAAiBE,CAAC,EAAE8S,aAAa,CAAC9S,CAAd,CAAgBwL,UAAhB,CAA2B9L,CAA3B,CAApB;YAAmDuC,MAAM,EAAEzD,KAAK,CAACqB,OAAN,CAAcoC;UAAzE,CAAtB;QACH;;QACD3C,GAAG,IAAIwT,aAAa,CAAC9S,CAAd,CAAgB2L,SAAhB,GAA4B,KAAKkH,WAAL,CAAiBpO,GAAjB,EAAsBsO,QAAtB,CAAnC;MACH,CAPD,MAQK;QACDzT,GAAG,IAAIwT,aAAa,CAAC9S,CAAd,CAAgBE,KAAhB,GAAwB4S,aAAa,CAAC9S,CAAd,CAAgB4F,QAAxC,GAAmDkN,aAAa,CAAC9S,CAAd,CAAgBL,KAA1E;MACH;IACJ;;IACD,OAAOL,GAAP;EACH,CAhCD;EAiCA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACIuS,YAAY,CAACrV,SAAb,CAAuBsC,YAAvB,GAAsC,UAAU0C,EAAV,EAAchD,KAAd,EAAqB4F,gBAArB,EAAuC;IACzE,IAAI9E,GAAG,GAAG,KAAKuT,WAAL,CAAiBrR,EAAE,CAACpD,UAAH,CAAcqG,GAA/B,EAAoCjG,KAApC,CAAV;IACA,IAAIyU,WAAJ;IACAA,WAAW,GAAGlW,QAAQ,CAACoJ,KAAT,CAAee,SAAf,CAAyBkL,MAAM,CAACC,YAAP,CAAoBG,OAApB,CAA4B,KAAKL,MAAjC,CAAzB,CAAd;IACA,IAAI5T,IAAI,GAAG0U,WAAW,GAAGA,WAAW,CAACtG,OAAZ,CAAoBsG,WAAW,CAAC3N,IAAZ,CAAiBkB,OAAjB,CAAyBlH,GAAzB,CAApB,CAAH,GAAwD,IAA9E;;IACA,IAAIf,IAAI,IAAI,IAAR,IAAgB,CAAC,KAAKyT,YAAtB,IAAsC,CAAC,KAAKC,cAAhD,EAAgE;MAC5D,OAAO1T,IAAP;IACH;;IACD,KAAKyT,YAAL,GAAoB,IAApB;IACA,KAAKC,cAAL,GAAsB,IAAtB;IACA,OAAO,KAAKC,YAAL,CAAkBpT,YAAlB,CAA+BF,KAA/B,CAAqC,KAAKsT,YAA1C,EAAwD,GAAGhT,KAAH,CAASe,IAAT,CAAcpB,SAAd,EAAyB,CAAzB,CAAxD,CAAP;EACH,CAXD;EAYA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIgT,YAAY,CAACrV,SAAb,CAAuB8B,eAAvB,GAAyC,UAAUC,IAAV,EAAgBlB,EAAhB,EAAoBmB,KAApB,EAA2BC,GAA3B,EAAgCkG,OAAhC,EAAyClD,OAAzC,EAAkD;IACvF,IAAI,KAAKwQ,cAAL,IAAwBtN,OAAO,IAAI,KAAKuN,YAAL,CAAkB5U,OAAlB,CAA0B2M,KAArC,IACxBlN,QAAQ,CAACiG,QAAT,CAAkB2B,OAAO,CAACF,GAA1B,EAA+B,KAAKyN,YAAL,CAAkB5U,OAAlB,CAA0B2M,KAAzD,CADwB,IAC2CtF,OAAO,CAACxG,IAAR,CAAagN,WAAb,OAA+B,MADtG,EAC+G;MAC3G,OAAO,KAAK+G,YAAL,CAAkB5T,eAAlB,CAAkCC,IAAlC,EAAwClB,EAAxC,EAA4CmB,KAA5C,EAAmDC,GAAnD,EAAwDkG,OAAxD,EAAiElD,OAAjE,CAAP;IACH;;IACDlD,IAAI,GAAG,KAAK2T,YAAL,CAAkB5T,eAAlB,CAAkCM,KAAlC,CAAwC,KAAKsT,YAA7C,EAA2D,GAAGhT,KAAH,CAASe,IAAT,CAAcpB,SAAd,EAAyB,CAAzB,CAA3D,CAAP;IACA,IAAIS,GAAG,GAAGd,KAAK,GAAG,KAAKqU,WAAL,CAAiBxV,EAAE,CAACe,UAAH,CAAcqG,GAA/B,EAAoCjG,KAApC,CAAH,GAAgDnB,EAAE,CAACe,UAAH,CAAcqG,GAA7E;IACA,IAAIvC,GAAG,GAAG,EAAV;IACAA,GAAG,GAAGnF,QAAQ,CAACoJ,KAAT,CAAee,SAAf,CAAyBkL,MAAM,CAACC,YAAP,CAAoBG,OAApB,CAA4B,KAAKL,MAAjC,CAAzB,CAAN;IACA,IAAIe,KAAK,GAAGhR,GAAG,CAACoD,IAAJ,CAASkB,OAAT,CAAiBlH,GAAjB,CAAZ;;IACA,IAAI4T,KAAK,KAAK,CAAC,CAAf,EAAkB;MACdhR,GAAG,CAACyK,OAAJ,CAAY3I,MAAZ,CAAmBkP,KAAnB,EAA0B,CAA1B;MACAhR,GAAG,CAACoD,IAAJ,CAAStB,MAAT,CAAgBkP,KAAhB,EAAuB,CAAvB;IACH;;IACDhR,GAAG,CAACyK,OAAJ,CAAYzK,GAAG,CAACoD,IAAJ,CAASvF,IAAT,CAAcT,GAAd,IAAqB,CAAjC,IAAsC;MAAEgG,IAAI,EAAEhG,GAAR;MAAaN,MAAM,EAAET,IAAI,CAACS,MAA1B;MAAkC+S,SAAS,EAAE,IAAI7N,IAAJ,EAA7C;MAAyDnG,KAAK,EAAEQ,IAAI,CAACR;IAArE,CAAtC;;IACA,OAAOmE,GAAG,CAACyK,OAAJ,CAAYxN,MAAZ,GAAqB,KAAKkE,QAAjC,EAA2C;MACvCnB,GAAG,CAACyK,OAAJ,CAAY3I,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB;MACA9B,GAAG,CAACoD,IAAJ,CAAStB,MAAT,CAAgB,CAAhB,EAAmB,CAAnB;IACH;;IACDoO,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,KAAKH,MAAjC,EAAyClM,IAAI,CAACC,SAAL,CAAehE,GAAf,CAAzC;IACA,OAAO3D,IAAP;EACH,CArBD;EAsBA;AACJ;AACA;AACA;AACA;AACA;;;EACIsT,YAAY,CAACrV,SAAb,CAAuBoM,UAAvB,GAAoC,UAAUpH,EAAV,EAAcmD,OAAd,EAAuBuH,QAAvB,EAAiC;IACjE,IAAI,CAACtP,iBAAiB,CAAC,KAAKsV,YAAL,CAAkB5U,OAAlB,CAA0B2M,KAA3B,CAAlB,IAAuDlN,QAAQ,CAACiG,QAAT,CAAkBkJ,QAAQ,CAACzH,GAA3B,EAAgC,KAAKyN,YAAL,CAAkB5U,OAAlB,CAA0B2M,KAA1D,CAAvD,IACGiC,QAAQ,CAAC/N,IAAT,CAAcgN,WAAd,OAAgC,MADvC,EAC+C;MAC3CxG,OAAO,CAACwH,gBAAR,CAAyB,QAAzB,EAAmC,KAAK+F,YAAL,CAAkB5U,OAAlB,CAA0B0M,eAA7D;IACH;;IACD,IAAI,CAACxI,EAAE,CAACpD,UAAH,CAAc+U,WAAnB,EAAgC;MAC5BxO,OAAO,CAACwH,gBAAR,CAAyB,QAAzB,EAAmC,KAAK+F,YAAL,CAAkB5U,OAAlB,CAA0ByM,MAA7D;IACH;EACJ,CARD;EASA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI8H,YAAY,CAACrV,SAAb,CAAuBuF,MAAvB,GAAgC,UAAUP,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0C;IACtE,KAAKkO,YAAL,GAAoB,IAApB;IACA,OAAO,KAAKE,YAAL,CAAkBnQ,MAAlB,CAAyBP,EAAzB,EAA6ByC,QAA7B,EAAuCtE,KAAvC,EAA8CmE,SAA9C,CAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;AACA;;;EACI+N,YAAY,CAACrV,SAAb,CAAuBqF,MAAvB,GAAgC,UAAUL,EAAV,EAAcjD,IAAd,EAAoBuF,SAApB,EAA+B;IAC3D,KAAKmO,cAAL,GAAsB,IAAtB;IACA,OAAO,KAAKC,YAAL,CAAkBrQ,MAAlB,CAAyBL,EAAzB,EAA6BjD,IAA7B,EAAmCuF,SAAnC,CAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI+N,YAAY,CAACrV,SAAb,CAAuBwF,MAAvB,GAAgC,UAAUR,EAAV,EAAcyC,QAAd,EAAwBtE,KAAxB,EAA+BmE,SAA/B,EAA0C;IACtE,KAAKkO,YAAL,GAAoB,IAApB;IACA,OAAO,KAAKE,YAAL,CAAkBlQ,MAAlB,CAAyBR,EAAzB,EAA6ByC,QAA7B,EAAuCtE,KAAvC,EAA8CmE,SAA9C,CAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI+N,YAAY,CAACrV,SAAb,CAAuB+E,YAAvB,GAAsC,UAAUC,EAAV,EAAcC,OAAd,EAAuBzB,CAAvB,EAA0B;IAC5D,OAAO,KAAKkS,YAAL,CAAkB3Q,YAAlB,CAA+BC,EAA/B,EAAmCC,OAAnC,EAA4CzB,CAA5C,CAAP;EACH,CAFD;;EAGA,OAAO6R,YAAP;AACH,CAhMiC,CAgMhC1N,UAhMgC,CAAlC;;AAiMA,SAAS0N,YAAT"},"metadata":{},"sourceType":"module"}