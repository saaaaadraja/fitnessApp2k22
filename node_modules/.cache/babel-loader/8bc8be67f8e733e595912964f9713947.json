{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Property, Complex, ChildProperty } from '@syncfusion/ej2-base';\nimport { measureText, Rect, TextOption, Size, PathOption } from '@syncfusion/ej2-svg-base';\nimport { Font, Border, Margin, ContainerPadding } from '../model/base';\nimport { Theme } from '../model/theme';\nimport { subtractThickness, Thickness, drawSymbol, ChartLocation, titlePositionX, getTitle, textTrim } from '../utils/helper';\nimport { RectOption, textElement, stringToNumber } from '../utils/helper';\nimport { removeElement, showTooltip, getElement, appendChildElement } from '../utils/helper';\n/**\n * Configures the location for the legend.\n */\n\nvar Location =\n/** @class */\nfunction (_super) {\n  __extends(Location, _super);\n\n  function Location() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([Property(0)], Location.prototype, \"x\", void 0);\n\n  __decorate([Property(0)], Location.prototype, \"y\", void 0);\n\n  return Location;\n}(ChildProperty);\n\nexport { Location };\n/**\n * Configures the legends in charts.\n */\n\nvar LegendSettings =\n/** @class */\nfunction (_super) {\n  __extends(LegendSettings, _super);\n\n  function LegendSettings() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([Property(true)], LegendSettings.prototype, \"visible\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"height\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"width\", void 0);\n\n  __decorate([Complex({\n    x: 0,\n    y: 0\n  }, Location)], LegendSettings.prototype, \"location\", void 0);\n\n  __decorate([Property('Auto')], LegendSettings.prototype, \"position\", void 0);\n\n  __decorate([Property(8)], LegendSettings.prototype, \"padding\", void 0);\n\n  __decorate([Property('Center')], LegendSettings.prototype, \"alignment\", void 0);\n\n  __decorate([Complex(Theme.legendLabelFont, Font)], LegendSettings.prototype, \"textStyle\", void 0);\n\n  __decorate([Property(10)], LegendSettings.prototype, \"shapeHeight\", void 0);\n\n  __decorate([Property(10)], LegendSettings.prototype, \"shapeWidth\", void 0);\n\n  __decorate([Complex({}, Border)], LegendSettings.prototype, \"border\", void 0);\n\n  __decorate([Complex({\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0\n  }, Margin)], LegendSettings.prototype, \"margin\", void 0);\n\n  __decorate([Complex({\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0\n  }, ContainerPadding)], LegendSettings.prototype, \"containerPadding\", void 0);\n\n  __decorate([Property(5)], LegendSettings.prototype, \"shapePadding\", void 0);\n\n  __decorate([Property('transparent')], LegendSettings.prototype, \"background\", void 0);\n\n  __decorate([Property(1)], LegendSettings.prototype, \"opacity\", void 0);\n\n  __decorate([Property(true)], LegendSettings.prototype, \"toggleVisibility\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"description\", void 0);\n\n  __decorate([Property(3)], LegendSettings.prototype, \"tabIndex\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"title\", void 0);\n\n  __decorate([Complex(Theme.legendTitleFont, Font)], LegendSettings.prototype, \"titleStyle\", void 0);\n\n  __decorate([Property('Top')], LegendSettings.prototype, \"titlePosition\", void 0);\n\n  __decorate([Property(100)], LegendSettings.prototype, \"maximumTitleWidth\", void 0);\n\n  __decorate([Property(true)], LegendSettings.prototype, \"enablePages\", void 0);\n\n  return LegendSettings;\n}(ChildProperty);\n\nexport { LegendSettings };\n/**\n * Legend base class for Chart and Accumulation chart.\n * @private\n */\n\nvar BaseLegend =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the dateTime module.\n   * @private\n   */\n  function BaseLegend(chart) {\n    this.fivePixel = 5;\n    this.rowCount = 0; // legend row counts per page\n\n    this.columnCount = 0; // legend column counts per page\n\n    this.pageButtonSize = 8;\n    this.pageXCollections = []; // pages of x locations\n\n    this.maxColumns = 0;\n    this.isTrimmed = false;\n    this.maxWidth = 0;\n    this.currentPage = 1;\n    this.backwardArrowOpacity = 0;\n    this.forwardArrowOpacity = 1;\n    this.arrowWidth = 2 * (this.fivePixel + this.pageButtonSize + this.fivePixel);\n    this.arrowHeight = this.arrowWidth;\n    this.legendTitleCollections = [];\n    this.isTop = false;\n    this.isTitle = false;\n    this.currentPageNumber = 1;\n    this.legendRegions = [];\n    this.pagingRegions = [];\n    this.chart = chart;\n    this.legend = chart.legendSettings;\n    this.legendID = chart.element.id + '_chart_legend';\n    this.isChartControl = chart.getModuleName() === 'chart';\n    this.isBulletChartControl = chart.getModuleName() === 'bulletChart';\n    this.bulletChart = this.chart;\n  }\n  /**\n   * Calculate the bounds for the legends.\n   * @return {void}\n   * @private\n   */\n\n\n  BaseLegend.prototype.calculateLegendBounds = function (rect, availableSize, maxLabelSize) {\n    var legend = this.legend;\n    this.getPosition(legend.position, availableSize);\n    this.legendBounds = new Rect(rect.x, rect.y, 0, 0);\n    var defaultValue = this.isBulletChartControl ? '40%' : '20%';\n    this.isVertical = this.position === 'Left' || this.position === 'Right';\n\n    if (this.isVertical) {\n      this.legendBounds.height = stringToNumber(legend.height, availableSize.height - (rect.y - this.chart.margin.top)) || rect.height;\n      this.legendBounds.width = stringToNumber(legend.width || defaultValue, availableSize.width);\n    } else {\n      this.legendBounds.width = stringToNumber(legend.width, availableSize.width) || rect.width;\n      this.legendBounds.height = stringToNumber(legend.height || defaultValue, availableSize.height);\n    }\n\n    this.library.getLegendBounds(availableSize, this.legendBounds, legend);\n\n    if (!this.isBulletChartControl) {\n      this.legendBounds.width += this.legend.containerPadding.left + this.legend.containerPadding.right;\n      this.legendBounds.height += this.legend.containerPadding.top + this.legend.containerPadding.bottom;\n    }\n\n    this.getLocation(this.position, legend.alignment, this.legendBounds, rect, availableSize, maxLabelSize);\n  };\n  /**\n   * To find legend position based on available size for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.getPosition = function (position, availableSize) {\n    var chart = this.chart;\n    var accumulation = this.chart;\n\n    if (this.isChartControl || this.isBulletChartControl) {\n      this.position = position !== 'Auto' ? position : 'Bottom';\n    } else {\n      if (position === 'Auto' && ((chart || accumulation).visibleSeries && (chart || accumulation).visibleSeries[0].type === 'Funnel' || (chart || accumulation).visibleSeries[0].type === 'Pyramid')) {\n        position = 'Top';\n      }\n\n      this.position = position !== 'Auto' ? position : availableSize.width > availableSize.height ? 'Right' : 'Bottom';\n    }\n  };\n  /**\n   * To set bounds for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.setBounds = function (computedWidth, computedHeight, legend, legendBounds) {\n    var titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n\n    if (this.isVertical && this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n      titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n      titleHeight += this.pageButtonSize + this.fivePixel;\n    }\n\n    computedWidth = Math.min(computedWidth, legendBounds.width);\n    computedHeight = Math.min(computedHeight, legendBounds.height);\n    legendBounds.width = !legend.width ? computedWidth : legendBounds.width;\n    legendBounds.height = !legend.height ? computedHeight : legendBounds.height;\n\n    if (!this.isBulletChartControl) {\n      if (this.isTop && legend.titleStyle.textOverflow !== 'None') {\n        this.calculateLegendTitle(legend, legendBounds);\n        legendBounds.height += legend.titleStyle.textOverflow === 'Wrap' && this.legendTitleCollections.length > 1 ? this.legendTitleSize.height - this.legendTitleSize.height / this.legendTitleCollections.length : 0;\n      }\n    }\n\n    this.rowCount = Math.max(1, Math.ceil((legendBounds.height - legend.padding - titleHeight) / (this.maxItemHeight + legend.padding)));\n  };\n  /**\n   * To find legend location based on position, alignment for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.getLocation = function (position, alignment, legendBounds, rect, availableSize, maxLabelSize) {\n    var padding = this.legend.border.width;\n    var isBulletChart = this.isBulletChartControl;\n    var bulletChart = this.bulletChart;\n    var labelIns = bulletChart.labelPosition === 'Inside';\n    var ticklIns = bulletChart.tickPosition === 'Inside';\n    var isVertical = bulletChart.orientation === 'Vertical'; // tslint:disable-next-line:max-line-length\n\n    var categoryFieldValue = isBulletChart && bulletChart.categoryField !== '' ? maxLabelSize.width + this.chart.border.width + padding * 3 : 0;\n    var legendHeight = legendBounds.height + padding + this.legend.margin.top + this.legend.margin.bottom;\n    var legendWidth = legendBounds.width + padding + this.legend.margin.left + this.legend.margin.right;\n    var marginBottom = this.chart.margin.bottom;\n\n    if (position === 'Bottom') {\n      legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment); // tslint:disable-next-line:max-line-length\n\n      legendBounds.y = rect.y + (rect.height - legendHeight) + padding + this.legend.margin.top;\n      legendBounds.y += isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns // tslint:disable-next-line:max-line-length\n      //tslint:disable-next-line:max-line-length\n      && !isVertical ? bulletChart.majorTickLines.height + marginBottom + this.legend.border.width + padding * 2 : isVertical && bulletChart.categoryField !== '' ? maxLabelSize.height + padding * 2 : 0;\n      subtractThickness(rect, new Thickness(0, 0, 0, legendHeight));\n    } else if (position === 'Top') {\n      legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment);\n      legendBounds.y = rect.y + padding + this.legend.margin.top;\n      legendBounds.y -= isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns && // // tslint:disable-next-line:max-line-length\n      !isVertical ? bulletChart.majorTickLines.height + this.chart.margin.top : 0;\n      legendHeight -= isBulletChart ? -padding * 2 : 0;\n      subtractThickness(rect, new Thickness(0, 0, legendHeight, 0));\n    } else if (position === 'Right') {\n      legendBounds.x = rect.x + (rect.width - legendBounds.width) - this.legend.margin.right;\n      legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n      legendWidth += isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns && isVertical ? this.chart.margin.left + this.chart.margin.right + bulletChart.majorTickLines.height : 0;\n      subtractThickness(rect, new Thickness(0, legendWidth, 0, 0));\n    } else if (position === 'Left') {\n      legendBounds.x = legendBounds.x + this.legend.margin.left;\n      legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n      legendWidth += isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns && // tslint:disable-next-line:max-line-length\n      // tslint:disable-next-line:max-line-length\n      isVertical ? legendBounds.x - this.chart.margin.left + padding + bulletChart.majorTickLines.height : bulletChart.orientation !== 'Vertical' && bulletChart.categoryField !== '' ? categoryFieldValue : 0;\n      subtractThickness(rect, new Thickness(legendWidth, 0, 0, 0));\n    } else {\n      legendBounds.x = this.legend.location.x;\n      legendBounds.y = this.legend.location.y;\n      subtractThickness(rect, new Thickness(0, 0, 0, 0));\n    }\n  };\n  /**\n   * To find legend alignment for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.alignLegend = function (start, size, legendSize, alignment) {\n    switch (alignment) {\n      case 'Far':\n        start = size - legendSize - start;\n        break;\n\n      case 'Center':\n        start = (size - legendSize) / 2;\n        break;\n    }\n\n    return start;\n  };\n  /**\n   * Renders the legend.\n   * @return {void}\n   * @private\n   */\n\n\n  BaseLegend.prototype.renderLegend = function (chart, legend, legendBounds, redraw) {\n    var firstLegend = this.findFirstLegendPosition(this.legendCollections);\n    var padding = legend.padding;\n    var titleHeight = 0;\n    var titlePlusArrowWidth = 0;\n    var isPaging = legend.enablePages;\n    var titlePosition = legend.titlePosition;\n    var upArrowHeight = this.isPaging && !legend.enablePages && this.isVertical ? this.pageButtonSize : 0;\n    this.legendRegions = [];\n    this.maxItemHeight = Math.max(this.legendCollections[0].textSize.height, legend.shapeHeight);\n    var legendGroup = chart.renderer.createGroup({\n      id: this.legendID + '_g'\n    });\n    var legendTranslateGroup = this.createLegendElements(chart, legendBounds, legendGroup, legend, this.legendID, redraw); // For new legend navigation\n\n    if (!isPaging && this.isPaging && !this.isVertical) {\n      titlePlusArrowWidth = !this.isTitle ? 0 : titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n      titlePlusArrowWidth += this.pageButtonSize + 2 * this.fivePixel;\n    } else if (!this.isPaging && !this.isVertical) {\n      titlePlusArrowWidth = this.isTitle && titlePosition === 'Left' ? this.fivePixel + this.legendTitleSize.width : 0;\n    }\n\n    titleHeight = !this.isTitle ? 0 : this.isTop || this.isVertical ? this.legendTitleSize.height : 0;\n    var pagingLegendBounds = new Rect(0, 0, 0, 0);\n    var requireLegendBounds = new Rect(0, 0, 0, 0);\n\n    if (firstLegend !== this.legendCollections.length) {\n      var legendSeriesGroup = void 0; // legendItem group for each series group element\n\n      var start = void 0; // starting shape center x,y position && to resolve lint error used new line for declaration\n\n      start = new ChartLocation(this.isBulletChartControl ? legendBounds.x + titlePlusArrowWidth + padding + legend.shapeWidth / 2 : legendBounds.x + titlePlusArrowWidth + padding + legend.shapeWidth / 2 + legend.containerPadding.left, this.isBulletChartControl ? legendBounds.y + titleHeight + upArrowHeight + padding + this.maxItemHeight / 2 : legendBounds.y + titleHeight + upArrowHeight + padding + this.maxItemHeight / 2 + legend.containerPadding.top);\n      var anchor = chart.isRtlEnabled ? 'end' : 'start';\n      var textOptions = new TextOption('', start.x, start.y, anchor); //  initialization for totalPages legend click totalpage again calculate\n\n      this.totalPages = this.totalPages = this.isChartControl || this.isBulletChartControl ? this.totalPages : 0;\n      var textPadding = legend.shapePadding + padding + legend.shapeWidth;\n      var count = 0;\n      this.pageXCollections = [];\n      this.legendCollections[firstLegend].location = start;\n      var previousLegend = this.legendCollections[firstLegend];\n\n      if (!legend.enablePages && this.isPaging) {\n        var x = start.x - this.fivePixel;\n        var y = start.y - this.fivePixel;\n        var rightSpace = this.isTitle && !this.isVertical && titlePosition === 'Right' ? this.legendTitleSize.width + this.fivePixel : 0;\n        var leftSpace = this.isTitle && !this.isVertical && titlePosition === 'Left' ? this.legendTitleSize.width + this.fivePixel : 0;\n        rightSpace += this.isVertical ? 0 : this.fivePixel + this.pageButtonSize + this.fivePixel;\n        var bottomSapce = this.isVertical ? this.pageButtonSize + Math.abs(y - legendBounds.y) : 0;\n        pagingLegendBounds = new Rect(x, y, legendBounds.width - rightSpace - leftSpace, legendBounds.height - bottomSapce);\n        requireLegendBounds = pagingLegendBounds;\n      } else {\n        requireLegendBounds = legendBounds;\n      }\n\n      for (var _i = 0, _a = this.legendCollections; _i < _a.length; _i++) {\n        var legendOption = _a[_i];\n\n        if (this.chart.getModuleName() === 'accumulationchart') {\n          // tslint:disable-next-line:max-line-length\n          legendOption.fill = (this.chart || this.chart).visibleSeries[0].points[legendOption.pointIndex].color;\n        }\n\n        this.accessbilityText = this.isBulletChartControl ? 'Legend of bullet chart' + '' + legendOption.text : 'Click to show or hide the ' + legendOption.text + ' series';\n\n        if (legendOption.render && legendOption.text !== '') {\n          legendSeriesGroup = chart.renderer.createGroup({\n            id: this.legendID + this.generateId(legendOption, '_g_', count)\n          });\n\n          if (legendSeriesGroup) {\n            legendSeriesGroup.setAttribute('tabindex', legend.tabIndex.toString());\n            legendSeriesGroup.setAttribute('aria-label', legend.description || this.accessbilityText);\n          }\n\n          this.library.getRenderPoint(legendOption, start, textPadding, previousLegend, requireLegendBounds, count, firstLegend);\n          this.renderSymbol(legendOption, legendSeriesGroup, count);\n          this.renderText(chart, legendOption, legendSeriesGroup, textOptions, count);\n\n          if (legendSeriesGroup) {\n            legendSeriesGroup.setAttribute('style', 'cursor: ' + (!legend.toggleVisibility && (chart.selectionMode === 'None' || chart.highlightMode === 'None' || chart.selectionMode === 'None') || this.isBulletChartControl ? 'auto' : 'pointer'));\n          }\n\n          if (legendTranslateGroup) {\n            legendTranslateGroup.appendChild(legendSeriesGroup);\n          }\n\n          previousLegend = legendOption;\n        }\n\n        count++;\n      }\n\n      if (this.isPaging) {\n        this.renderPagingElements(chart, legendBounds, textOptions, legendGroup);\n      } else {\n        this.totalPages = 1;\n      }\n    }\n\n    appendChildElement(chart.enableCanvas, chart.svgObject, legendGroup, redraw);\n  };\n  /**\n   * To find first valid legend text index for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.findFirstLegendPosition = function (legendCollection) {\n    var count = 0;\n\n    for (var _i = 0, legendCollection_1 = legendCollection; _i < legendCollection_1.length; _i++) {\n      var legend = legendCollection_1[_i];\n\n      if (legend.render && legend.text !== '') {\n        break;\n      }\n\n      count++;\n    }\n\n    return count;\n  };\n  /**\n   * To get the legend title text width and height.\n   * @param legend\n   * @param legendBounds\n   */\n\n\n  BaseLegend.prototype.calculateLegendTitle = function (legend, legendBounds) {\n    if (legend.title) {\n      this.isTop = legend.titlePosition === 'Top';\n      var padding = legend.titleStyle.textOverflow === 'Trim' ? 2 * legend.padding : 0;\n\n      if (this.isTop || this.isVertical) {\n        this.legendTitleCollections = getTitle(legend.title, legend.titleStyle, legendBounds.width - padding);\n      } else {\n        this.legendTitleCollections[0] = textTrim(legend.maximumTitleWidth, legend.title, legend.titleStyle);\n      }\n\n      var text = this.isTop ? legend.title : this.legendTitleCollections[0];\n      this.legendTitleSize = measureText(text, legend.titleStyle);\n      this.legendTitleSize.height *= this.legendTitleCollections.length;\n    } else {\n      this.legendTitleSize = new Size(0, 0);\n    }\n  };\n  /**\n   * Render the legend title\n   * @param chart\n   * @param legend\n   * @param legendBounds\n   * @param legendGroup\n   */\n\n\n  BaseLegend.prototype.renderLegendTitle = function (chart, legend, legendBounds, legendGroup) {\n    var padding = legend.padding;\n    this.isTop = legend.titlePosition === 'Top';\n    var alignment = legend.titleStyle.textAlignment;\n    var anchor = alignment === 'Near' ? 'start' : alignment === 'Far' ? 'end' : 'middle';\n    anchor = this.isTop || this.isVertical ? anchor : '';\n    var x = titlePositionX(legendBounds, legend.titleStyle);\n    x = alignment === 'Near' ? x + padding : alignment === 'Far' ? x - padding : x;\n    x = this.isTop || this.isVertical ? x : legendBounds.x + (legend.titlePosition === 'Left' ? 5 : legendBounds.width - this.legendTitleSize.width - 5);\n    var topPadding = legendBounds.height / 2 + this.legendTitleSize.height / 4;\n    var y = legendBounds.y + (!this.isTop && !this.isVertical ? topPadding : this.legendTitleSize.height / this.legendTitleCollections.length);\n    var legendTitleTextOptions = new TextOption(this.legendID + '_title', x, y, anchor, this.legendTitleCollections);\n    textElement(chart.renderer, legendTitleTextOptions, legend.titleStyle, legend.titleStyle.color, legendGroup);\n  };\n  /**\n   * To create legend rendering elements for chart and accumulation chart\n   * @param chart\n   * @param legendBounds\n   * @param legendGroup\n   * @param legend\n   * @param id\n   * @param redraw\n   */\n\n\n  BaseLegend.prototype.createLegendElements = function (chart, legendBounds, legendGroup, legend, id, redraw) {\n    var padding = legend.padding;\n    var options = new RectOption(id + '_element', legend.background, legend.border, legend.opacity, legendBounds);\n    legendGroup ? legendGroup.appendChild(chart.renderer.drawRectangle(options)) : chart.renderer.drawRectangle(options);\n\n    if (legend.title) {\n      this.renderLegendTitle(chart, legend, legendBounds, legendGroup);\n    }\n\n    var legendItemsGroup = chart.renderer.createGroup({\n      id: id + '_collections'\n    });\n    var isCanvas = chart.enableCanvas;\n\n    if (!isCanvas) {\n      legendGroup.appendChild(legendItemsGroup);\n    }\n\n    this.legendTranslateGroup = chart.renderer.createGroup({\n      id: id + '_translate_g'\n    });\n\n    if (!isCanvas) {\n      legendItemsGroup.appendChild(this.legendTranslateGroup);\n    }\n\n    var clippath = chart.renderer.createClipPath({\n      id: id + '_clipPath'\n    });\n    options.y += padding + (this.isTop ? this.legendTitleSize.height : 0);\n    options.id += '_clipPath_rect';\n    options.width = !this.isChartControl && chart.getModuleName() !== 'bulletChart' && this.isVertical ? this.maxWidth - padding + legend.containerPadding.left + legend.containerPadding.right : legendBounds.width;\n\n    if (!isCanvas) {\n      this.clipRect = chart.renderer.drawRectangle(options);\n      clippath.appendChild(this.clipRect);\n    } else {\n      this.pagingClipRect = options;\n    }\n\n    appendChildElement(isCanvas, chart.svgObject, clippath, redraw);\n\n    if (!isCanvas) {\n      legendItemsGroup.setAttribute('style', 'clip-path:url(#' + clippath.id + ')');\n    }\n\n    return this.legendTranslateGroup;\n  };\n  /**\n   * To render legend symbols for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.renderSymbol = function (legendOption, group, i) {\n    var borderColor;\n    var control = this.isBulletChartControl ? this.chart : null;\n    var symbolColor = legendOption.visible ? legendOption.fill : '#D3D3D3';\n    var shape = legendOption.shape === 'SeriesType' ? legendOption.type : legendOption.shape;\n    shape = shape === 'Scatter' ? legendOption.markerShape : shape;\n    var isStrokeWidth = this.chart.getModuleName() === 'chart' && legendOption.shape === 'SeriesType' && legendOption.type.toLowerCase().indexOf('line') > -1 && legendOption.type.toLowerCase().indexOf('area') === -1;\n    var strokewidth = isStrokeWidth ? this.chart.visibleSeries[i].width : this.isBulletChartControl && legendOption.shape === 'Multiply' ? 4 : 1;\n    var isCustomBorder = this.chart.getModuleName() === 'chart' && (legendOption.type === 'Scatter' || legendOption.type === 'Bubble');\n\n    if (isCustomBorder && i < this.chart.visibleSeries.length) {\n      var seriesBorder = this.chart.visibleSeries[i].border;\n      borderColor = seriesBorder.color ? seriesBorder.color : symbolColor;\n      strokewidth = seriesBorder.width ? seriesBorder.width : 1;\n    }\n\n    var symbolOption = new PathOption(this.legendID + this.generateId(legendOption, '_shape_', i), symbolColor, strokewidth, isCustomBorder ? borderColor : symbolColor, 1, '', '');\n    var regionPadding;\n    var isCanvas = this.chart.enableCanvas;\n\n    if (!isCanvas) {\n      group.appendChild(drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), // tslint:disable-next-line:max-line-length\n      // tslint:disable-next-line:align\n      legendOption.url, symbolOption, this.accessbilityText, this.chart.renderer, null, this.isBulletChartControl, control));\n    } else {\n      regionPadding = -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber);\n      drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), '', // tslint:disable-next-line:align\n      symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ? new Rect(0, regionPadding, 0, 0) : null, this.isBulletChartControl, control);\n      this.legendRegions.push({\n        rect: new Rect(legendOption.location.x, legendOption.location.y, // tslint:disable-next-line:align\n        this.legend.shapeWidth, this.legend.shapeHeight + regionPadding),\n        index: i\n      });\n    }\n\n    if (shape === 'Line' && legendOption.markerVisibility && legendOption.markerShape !== 'Image' || legendOption.type === 'Doughnut') {\n      symbolOption.id = this.legendID + this.generateId(legendOption, '_shape_marker_', i);\n      shape = legendOption.type === 'Doughnut' ? 'Circle' : legendOption.markerShape;\n      symbolOption.fill = legendOption.type === 'Doughnut' ? '#FFFFFF' : symbolOption.fill;\n\n      if (!isCanvas) {\n        // tslint:disable-next-line:max-line-length\n        group.appendChild(drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), // tslint:disable-next-line:align\n        '', symbolOption, this.accessbilityText, null, null, this.isBulletChartControl, control));\n      } else {\n        drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), // tslint:disable-next-line:align\n        '', symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ? new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null, this.isBulletChartControl, control);\n      }\n    }\n  };\n  /**\n   * To render legend text for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.renderText = function (chart, legendOption, group, textOptions, i) {\n    var legend = chart.legendSettings;\n    var hiddenColor = '#D3D3D3';\n    textOptions.id = this.legendID + this.generateId(legendOption, '_text_', i);\n    var fontcolor = legendOption.visible ? legend.textStyle.color || chart.themeStyle.legendLabel : hiddenColor;\n    textOptions.text = legendOption.text;\n    textOptions.x = legendOption.location.x + legend.shapeWidth / 2 + legend.shapePadding;\n    textOptions.y = legendOption.location.y + this.maxItemHeight / 4;\n    var isCanvas = this.chart.enableCanvas;\n    var element = textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, group, false, false, false, false, null, this.currentPageNumber && isCanvas ? new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n\n    if (element) {\n      element.setAttribute('aria-label', legend.description || this.accessbilityText);\n    }\n\n    if (isCanvas) {\n      var textSize = measureText(textOptions.text, legend.textStyle);\n      this.legendRegions[i].rect.y = textOptions.y < this.legendRegions[i].rect.y ? textOptions.y : this.legendRegions[i].rect.y;\n      this.legendRegions[i].rect.width += textSize.width;\n      this.legendRegions[i].rect.height = textSize.height;\n      this.legendRegions[i].rect.y -= textSize.height * 0.5;\n    }\n  };\n  /**\n   * To render legend paging elements for chart and accumulation chart\n   */\n  // tslint:disable-next-line:max-func-body-length\n\n\n  BaseLegend.prototype.renderPagingElements = function (chart, bounds, textOption, legendGroup) {\n    var paginggroup = chart.renderer.createGroup({\n      id: this.legendID + '_navigation'\n    });\n    this.pagingRegions = [];\n    var pageTextElement;\n    var isCanvas = chart.enableCanvas;\n    var titleHeight = this.isBulletChartControl ? 0 : this.legendTitleSize.height;\n    this.backwardArrowOpacity = this.currentPage !== 1 ? 1 : 0;\n    this.forwardArrowOpacity = this.currentPage === this.totalPages ? 0 : 1;\n\n    if (!isCanvas) {\n      legendGroup.appendChild(paginggroup);\n    }\n\n    var grayColor = '#545454';\n    var legend = chart.legendSettings; // to solve parameter lint error, legend declaration is here\n\n    var padding = 8; // const padding for paging elements\n\n    if (this.isChartControl || this.isBulletChartControl || !this.isVertical) {\n      this.totalPages = Math.ceil(this.totalPages / Math.max(1, this.rowCount - 1));\n    } else {\n      this.totalPages = Math.ceil(this.totalPages / this.maxColumns);\n    }\n\n    var symbolOption = new PathOption(this.legendID + '_pageup', 'transparent', 5, grayColor, 1, '', '');\n    var iconSize = this.pageButtonSize;\n\n    if (paginggroup) {\n      paginggroup.setAttribute('style', 'cursor: pointer');\n    } // Page left arrow drawing calculation started here\n\n\n    var rowCount = !legend.enablePages && this.isPaging && !this.isVertical && !this.isBulletChartControl ? 1 : this.rowCount - 1;\n    this.clipPathHeight = rowCount * (this.maxItemHeight + legend.padding);\n\n    if (!isCanvas) {\n      this.clipRect.setAttribute('height', this.clipPathHeight.toString());\n    } else {\n      //paging clipRect only for canvas mode\n      this.pagingClipRect.height = this.legendBounds.height - this.clipPathHeight - (this.pagingClipRect.y - this.legendBounds.y) - legend.border.width;\n      this.pagingClipRect.y = this.pagingClipRect.y + this.clipPathHeight;\n      this.pagingClipRect.x += legend.border.width;\n      this.pagingClipRect.width -= legend.border.width + legend.border.width / 2;\n      this.chart.renderer.clearRect(new Rect(this.pagingClipRect.x, this.pagingClipRect.y, this.pagingClipRect.width, this.pagingClipRect.height));\n    }\n\n    var titleWidth = this.isTitle && legend.titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n    var x = bounds.x + iconSize / 2;\n    var y = bounds.y + this.clipPathHeight + (titleHeight + bounds.height - this.clipPathHeight) / 2;\n\n    if (this.isPaging && !legend.enablePages && !this.isVertical && !this.isBulletChartControl) {\n      x = bounds.x + this.fivePixel + this.pageButtonSize + titleWidth;\n      y = legend.title && this.isTop ? bounds.y + padding + titleHeight + iconSize / 1 + 0.5 : bounds.y + padding + iconSize + 0.5;\n    }\n\n    var size = measureText(this.totalPages + '/' + this.totalPages, legend.textStyle);\n\n    if (!isCanvas) {\n      if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n        x = bounds.x + bounds.width / 2;\n        y = bounds.y + iconSize / 2 + padding + titleHeight;\n        symbolOption.opacity = this.backwardArrowOpacity;\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'UpArrow', new Size(iconSize, iconSize), '', symbolOption, 'UpArrow'));\n      } else {\n        symbolOption.opacity = this.isBulletChartControl ? symbolOption.opacity : legend.enablePages ? 1 : this.backwardArrowOpacity;\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow'));\n      }\n    } else {\n      drawSymbol({\n        x: x,\n        y: y\n      }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow', this.chart.renderer, new Rect(bounds.width - (2 * (iconSize + padding) + padding + size.width), 0, 0, 0));\n    }\n\n    this.pagingRegions.push(new Rect(x + bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5, y - iconSize * 0.5, iconSize, iconSize)); // Page numbering rendering calculation started here\n\n    textOption.x = x + iconSize / 2 + padding;\n    textOption.y = y + size.height / 4;\n    textOption.id = this.legendID + '_pagenumber';\n    textOption.text = '1/' + this.totalPages;\n\n    if (isCanvas && this.totalNoOfPages) {\n      textOption.text = this.currentPageNumber + '/' + this.totalNoOfPages;\n    }\n\n    if (legend.enablePages || this.isBulletChartControl) {\n      pageTextElement = textElement(chart.renderer, textOption, legend.textStyle, legend.textStyle.color, paginggroup, false, false, false, false, null, new Rect(bounds.width - (2 * (iconSize + padding) + padding + size.width), 0, 0, 0));\n    } // Page right arrow rendering calculation started here\n\n\n    x = textOption.x + padding + iconSize / 2 + size.width;\n\n    if (this.isPaging && !legend.enablePages && !this.isVertical) {\n      x = bounds.x + bounds.width - this.fivePixel - this.pageButtonSize - (legend.title && legend.titlePosition === 'Right' ? this.legendTitleSize.width + this.fivePixel : 0);\n    }\n\n    symbolOption.id = this.legendID + '_pagedown';\n    symbolOption.opacity = !legend.enablePages ? this.forwardArrowOpacity : 1;\n\n    if (!isCanvas) {\n      if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n        x = bounds.x + bounds.width / 2;\n        y = bounds.y + bounds.height - iconSize / 2 - padding;\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'DownArrow', new Size(iconSize, iconSize), '', symbolOption, 'DownArrow'));\n      } else {\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow'));\n      }\n    } else {\n      drawSymbol({\n        x: x,\n        y: y\n      }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow', this.chart.renderer, new Rect(bounds.width - (2 * (iconSize + padding) + padding + size.width), 0, 0, 0));\n    }\n\n    this.pagingRegions.push(new Rect(x + (bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5), y - iconSize * 0.5, iconSize, iconSize));\n\n    if (!isCanvas && (legend.enablePages || this.isBulletChartControl)) {\n      //placing the navigation buttons and page numbering in legend right corner\n      paginggroup.setAttribute('transform', 'translate(' + (bounds.width - (2 * (iconSize + padding) + padding + size.width)) + ', ' + 0 + ')');\n    } else {\n      if (this.currentPageNumber === 1 && this.calTotalPage && (legend.enablePages || this.isBulletChartControl)) {\n        this.totalNoOfPages = this.totalPages;\n        this.calTotalPage = false;\n      }\n\n      if (!legend.enablePages && !this.isBulletChartControl) {\n        // For new legend page navigation\n        this.translatePage(null, this.currentPage - 1, this.currentPage, legend);\n      }\n    }\n\n    if (legend.enablePages || this.isBulletChartControl) {\n      this.translatePage(pageTextElement, this.currentPage - 1, this.currentPage, legend);\n    }\n  };\n  /**\n   * To translate legend pages for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.translatePage = function (pagingText, page, pageNumber, legend) {\n    var size = this.clipPathHeight * page;\n    var translate = 'translate(0,-' + size + ')';\n\n    if (!this.isChartControl && !this.isBulletChartControl && this.isVertical) {\n      var pageLength = page * this.maxColumns;\n      size = this.pageXCollections[page * this.maxColumns] - this.legendBounds.x;\n      size = size < 0 ? 0 : size; // to avoid small pixel variation\n\n      translate = 'translate(-' + size + ',0)';\n    }\n\n    if (!this.chart.enableCanvas) {\n      this.legendTranslateGroup.setAttribute('transform', translate);\n    }\n\n    if (!this.chart.enableCanvas && (legend.enablePages || this.isBulletChartControl)) {\n      pagingText.textContent = pageNumber + '/' + this.totalPages;\n    }\n\n    this.currentPage = pageNumber;\n    return size;\n  };\n  /**\n   * To change legend pages for chart and accumulation chart\n   */\n\n\n  BaseLegend.prototype.changePage = function (event, pageUp) {\n    var legend = this.chart.legendSettings;\n    var backwardArrow = document.getElementById(this.legendID + '_pageup');\n    var forwardArrow = document.getElementById(this.legendID + '_pagedown');\n    var pageText = legend.enablePages || this.isBulletChartControl ? document.getElementById(this.legendID + '_pagenumber') : null;\n    var page = legend.enablePages || this.isBulletChartControl ? parseInt(pageText.textContent.split('/')[0], 10) : this.currentPage;\n\n    if (pageUp && page > 1) {\n      this.translatePage(pageText, page - 2, page - 1, legend);\n    } else if (!pageUp && page < this.totalPages) {\n      this.translatePage(pageText, page, page + 1, legend);\n    }\n\n    if (this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n      this.currentPage === this.totalPages ? this.hideArrow(forwardArrow) : this.showArrow(forwardArrow);\n      this.currentPage === 1 ? this.hideArrow(backwardArrow) : this.showArrow(backwardArrow);\n    }\n  };\n  /**\n   * To hide the backward and forward arrow\n   * @param arrowElement\n   */\n\n\n  BaseLegend.prototype.hideArrow = function (arrowElement) {\n    arrowElement.setAttribute('opacity', '0');\n  };\n  /**\n   * To show the  backward and forward arrow\n   * @param arrowElement\n   */\n\n\n  BaseLegend.prototype.showArrow = function (arrowElement) {\n    arrowElement.setAttribute('opacity', '1');\n  };\n  /**\n   * To find legend elements id based on chart or accumulation chart\n   * @private\n   */\n\n\n  BaseLegend.prototype.generateId = function (option, prefix, count) {\n    if (this.isChartControl) {\n      return prefix + count;\n    } else {\n      return prefix + option.pointIndex;\n    }\n  };\n  /**\n   * To show or hide trimmed text tooltip for legend.\n   * @return {void}\n   * @private\n   */\n\n\n  BaseLegend.prototype.move = function (event) {\n    var _this = this;\n\n    var x = this.chart.mouseX;\n    var y = this.chart.mouseY;\n\n    if (event.target.textContent.indexOf('...') > -1) {\n      var targetId = event.target.id.split(this.legendID + '_text_');\n\n      if (targetId.length === 2) {\n        var index = parseInt(targetId[1], 10);\n        var element = this.chart.element;\n\n        if (!isNaN(index)) {\n          if (this.chart.isTouch) {\n            removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n          }\n\n          if (this.isChartControl) {\n            showTooltip(this.chart.series[index].name, x, y, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n          } else {\n            showTooltip(this.chart.visibleSeries[0].points[index].x.toString(), x + 10, y + 10, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n          }\n        }\n      }\n    } else {\n      removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n    }\n\n    if (this.chart.isTouch) {\n      clearTimeout(this.clearTooltip);\n      this.clearTooltip = setTimeout(function () {\n        removeElement(_this.chart.element.id + '_EJ2_Legend_Tooltip');\n      }, 1000);\n    }\n  };\n\n  return BaseLegend;\n}();\n\nexport { BaseLegend };\n/**\n * Class for legend options\n * @private\n */\n\nvar LegendOptions =\n/** @class */\nfunction () {\n  function LegendOptions(text, fill, shape, visible, type, url, markerShape, markerVisibility, pointIndex, seriesIndex) {\n    this.location = {\n      x: 0,\n      y: 0\n    };\n    this.text = text;\n    this.fill = fill;\n    this.shape = shape;\n    this.url = url;\n    this.visible = visible;\n    this.type = type;\n    this.markerVisibility = markerVisibility;\n    this.markerShape = markerShape;\n    this.pointIndex = pointIndex;\n    this.seriesIndex = seriesIndex;\n  }\n\n  return LegendOptions;\n}();\n\nexport { LegendOptions };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Property","Complex","ChildProperty","measureText","Rect","TextOption","Size","PathOption","Font","Border","Margin","ContainerPadding","Theme","subtractThickness","Thickness","drawSymbol","ChartLocation","titlePositionX","getTitle","textTrim","RectOption","textElement","stringToNumber","removeElement","showTooltip","getElement","appendChildElement","Location","_super","apply","LegendSettings","x","y","legendLabelFont","left","right","top","bottom","legendTitleFont","BaseLegend","chart","fivePixel","rowCount","columnCount","pageButtonSize","pageXCollections","maxColumns","isTrimmed","maxWidth","currentPage","backwardArrowOpacity","forwardArrowOpacity","arrowWidth","arrowHeight","legendTitleCollections","isTop","isTitle","currentPageNumber","legendRegions","pagingRegions","legend","legendSettings","legendID","element","id","isChartControl","getModuleName","isBulletChartControl","bulletChart","calculateLegendBounds","rect","availableSize","maxLabelSize","getPosition","position","legendBounds","defaultValue","isVertical","height","margin","width","library","getLegendBounds","containerPadding","getLocation","alignment","accumulation","visibleSeries","type","setBounds","computedWidth","computedHeight","titleHeight","title","titlePosition","legendTitleSize","isPaging","enablePages","Math","min","titleStyle","textOverflow","calculateLegendTitle","max","ceil","padding","maxItemHeight","border","isBulletChart","labelIns","labelPosition","ticklIns","tickPosition","orientation","categoryFieldValue","categoryField","legendHeight","legendWidth","marginBottom","alignLegend","opposedPosition","majorTickLines","location","start","size","legendSize","renderLegend","redraw","firstLegend","findFirstLegendPosition","legendCollections","titlePlusArrowWidth","upArrowHeight","textSize","shapeHeight","legendGroup","renderer","createGroup","legendTranslateGroup","createLegendElements","pagingLegendBounds","requireLegendBounds","legendSeriesGroup","shapeWidth","anchor","isRtlEnabled","textOptions","totalPages","textPadding","shapePadding","count","previousLegend","rightSpace","leftSpace","bottomSapce","abs","_i","_a","legendOption","fill","points","pointIndex","color","accessbilityText","text","render","generateId","setAttribute","tabIndex","toString","description","getRenderPoint","renderSymbol","renderText","toggleVisibility","selectionMode","highlightMode","appendChild","renderPagingElements","enableCanvas","svgObject","legendCollection","legendCollection_1","maximumTitleWidth","renderLegendTitle","textAlignment","topPadding","legendTitleTextOptions","options","background","opacity","drawRectangle","legendItemsGroup","isCanvas","clippath","createClipPath","clipRect","pagingClipRect","group","borderColor","control","symbolColor","visible","shape","markerShape","isStrokeWidth","toLowerCase","indexOf","strokewidth","isCustomBorder","seriesBorder","symbolOption","regionPadding","url","translatePage","push","index","markerVisibility","hiddenColor","fontcolor","textStyle","themeStyle","legendLabel","bounds","textOption","paginggroup","pageTextElement","grayColor","iconSize","clipPathHeight","clearRect","titleWidth","totalNoOfPages","calTotalPage","pagingText","page","pageNumber","translate","pageLength","textContent","changePage","event","pageUp","backwardArrow","document","getElementById","forwardArrow","pageText","parseInt","split","hideArrow","showArrow","arrowElement","option","prefix","move","_this","mouseX","mouseY","targetId","isNaN","isTouch","series","name","offsetWidth","clearTimeout","clearTooltip","setTimeout","LegendOptions","seriesIndex"],"sources":["D:/Theme/package/node_modules/@syncfusion/ej2-charts/src/common/legend/legend.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, Complex, ChildProperty } from '@syncfusion/ej2-base';\nimport { measureText, Rect, TextOption, Size, PathOption } from '@syncfusion/ej2-svg-base';\nimport { Font, Border, Margin, ContainerPadding } from '../model/base';\nimport { Theme } from '../model/theme';\nimport { subtractThickness, Thickness, drawSymbol, ChartLocation, titlePositionX, getTitle, textTrim } from '../utils/helper';\nimport { RectOption, textElement, stringToNumber } from '../utils/helper';\nimport { removeElement, showTooltip, getElement, appendChildElement } from '../utils/helper';\n/**\n * Configures the location for the legend.\n */\nvar Location = /** @class */ (function (_super) {\n    __extends(Location, _super);\n    function Location() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Location.prototype, \"x\", void 0);\n    __decorate([\n        Property(0)\n    ], Location.prototype, \"y\", void 0);\n    return Location;\n}(ChildProperty));\nexport { Location };\n/**\n * Configures the legends in charts.\n */\nvar LegendSettings = /** @class */ (function (_super) {\n    __extends(LegendSettings, _super);\n    function LegendSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], LegendSettings.prototype, \"visible\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"height\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"width\", void 0);\n    __decorate([\n        Complex({ x: 0, y: 0 }, Location)\n    ], LegendSettings.prototype, \"location\", void 0);\n    __decorate([\n        Property('Auto')\n    ], LegendSettings.prototype, \"position\", void 0);\n    __decorate([\n        Property(8)\n    ], LegendSettings.prototype, \"padding\", void 0);\n    __decorate([\n        Property('Center')\n    ], LegendSettings.prototype, \"alignment\", void 0);\n    __decorate([\n        Complex(Theme.legendLabelFont, Font)\n    ], LegendSettings.prototype, \"textStyle\", void 0);\n    __decorate([\n        Property(10)\n    ], LegendSettings.prototype, \"shapeHeight\", void 0);\n    __decorate([\n        Property(10)\n    ], LegendSettings.prototype, \"shapeWidth\", void 0);\n    __decorate([\n        Complex({}, Border)\n    ], LegendSettings.prototype, \"border\", void 0);\n    __decorate([\n        Complex({ left: 0, right: 0, top: 0, bottom: 0 }, Margin)\n    ], LegendSettings.prototype, \"margin\", void 0);\n    __decorate([\n        Complex({ left: 0, right: 0, top: 0, bottom: 0 }, ContainerPadding)\n    ], LegendSettings.prototype, \"containerPadding\", void 0);\n    __decorate([\n        Property(5)\n    ], LegendSettings.prototype, \"shapePadding\", void 0);\n    __decorate([\n        Property('transparent')\n    ], LegendSettings.prototype, \"background\", void 0);\n    __decorate([\n        Property(1)\n    ], LegendSettings.prototype, \"opacity\", void 0);\n    __decorate([\n        Property(true)\n    ], LegendSettings.prototype, \"toggleVisibility\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"description\", void 0);\n    __decorate([\n        Property(3)\n    ], LegendSettings.prototype, \"tabIndex\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"title\", void 0);\n    __decorate([\n        Complex(Theme.legendTitleFont, Font)\n    ], LegendSettings.prototype, \"titleStyle\", void 0);\n    __decorate([\n        Property('Top')\n    ], LegendSettings.prototype, \"titlePosition\", void 0);\n    __decorate([\n        Property(100)\n    ], LegendSettings.prototype, \"maximumTitleWidth\", void 0);\n    __decorate([\n        Property(true)\n    ], LegendSettings.prototype, \"enablePages\", void 0);\n    return LegendSettings;\n}(ChildProperty));\nexport { LegendSettings };\n/**\n * Legend base class for Chart and Accumulation chart.\n * @private\n */\nvar BaseLegend = /** @class */ (function () {\n    /**\n     * Constructor for the dateTime module.\n     * @private\n     */\n    function BaseLegend(chart) {\n        this.fivePixel = 5;\n        this.rowCount = 0; // legend row counts per page\n        this.columnCount = 0; // legend column counts per page\n        this.pageButtonSize = 8;\n        this.pageXCollections = []; // pages of x locations\n        this.maxColumns = 0;\n        this.isTrimmed = false;\n        this.maxWidth = 0;\n        this.currentPage = 1;\n        this.backwardArrowOpacity = 0;\n        this.forwardArrowOpacity = 1;\n        this.arrowWidth = (2 * (this.fivePixel + this.pageButtonSize + this.fivePixel));\n        this.arrowHeight = this.arrowWidth;\n        this.legendTitleCollections = [];\n        this.isTop = false;\n        this.isTitle = false;\n        this.currentPageNumber = 1;\n        this.legendRegions = [];\n        this.pagingRegions = [];\n        this.chart = chart;\n        this.legend = chart.legendSettings;\n        this.legendID = chart.element.id + '_chart_legend';\n        this.isChartControl = (chart.getModuleName() === 'chart');\n        this.isBulletChartControl = (chart.getModuleName() === 'bulletChart');\n        this.bulletChart = this.chart;\n    }\n    /**\n     * Calculate the bounds for the legends.\n     * @return {void}\n     * @private\n     */\n    BaseLegend.prototype.calculateLegendBounds = function (rect, availableSize, maxLabelSize) {\n        var legend = this.legend;\n        this.getPosition(legend.position, availableSize);\n        this.legendBounds = new Rect(rect.x, rect.y, 0, 0);\n        var defaultValue = (this.isBulletChartControl) ? '40%' : '20%';\n        this.isVertical = (this.position === 'Left' || this.position === 'Right');\n        if (this.isVertical) {\n            this.legendBounds.height = stringToNumber(legend.height, availableSize.height - (rect.y - this.chart.margin.top)) || rect.height;\n            this.legendBounds.width = stringToNumber(legend.width || defaultValue, availableSize.width);\n        }\n        else {\n            this.legendBounds.width = stringToNumber(legend.width, availableSize.width) || rect.width;\n            this.legendBounds.height = stringToNumber(legend.height || defaultValue, availableSize.height);\n        }\n        this.library.getLegendBounds(availableSize, this.legendBounds, legend);\n        if (!this.isBulletChartControl) {\n            this.legendBounds.width += (this.legend.containerPadding.left + this.legend.containerPadding.right);\n            this.legendBounds.height += (this.legend.containerPadding.top + this.legend.containerPadding.bottom);\n        }\n        this.getLocation(this.position, legend.alignment, this.legendBounds, rect, availableSize, maxLabelSize);\n    };\n    /**\n     * To find legend position based on available size for chart and accumulation chart\n     */\n    BaseLegend.prototype.getPosition = function (position, availableSize) {\n        var chart = this.chart;\n        var accumulation = this.chart;\n        if (this.isChartControl || this.isBulletChartControl) {\n            this.position = (position !== 'Auto') ? position : 'Bottom';\n        }\n        else {\n            if (position === 'Auto' && ((chart || accumulation).visibleSeries && (chart || accumulation).visibleSeries[0].type === 'Funnel' || (chart || accumulation).visibleSeries[0].type === 'Pyramid')) {\n                position = 'Top';\n            }\n            this.position = (position !== 'Auto') ? position :\n                (availableSize.width > availableSize.height ? 'Right' : 'Bottom');\n        }\n    };\n    /**\n     * To set bounds for chart and accumulation chart\n     */\n    BaseLegend.prototype.setBounds = function (computedWidth, computedHeight, legend, legendBounds) {\n        var titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n        if (this.isVertical && this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n            titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n            titleHeight += (this.pageButtonSize + this.fivePixel);\n        }\n        computedWidth = Math.min(computedWidth, legendBounds.width);\n        computedHeight = Math.min(computedHeight, legendBounds.height);\n        legendBounds.width = !legend.width ? computedWidth : legendBounds.width;\n        legendBounds.height = !legend.height ? computedHeight : legendBounds.height;\n        if (!this.isBulletChartControl) {\n            if (this.isTop && legend.titleStyle.textOverflow !== 'None') {\n                this.calculateLegendTitle(legend, legendBounds);\n                legendBounds.height += legend.titleStyle.textOverflow === 'Wrap' && this.legendTitleCollections.length > 1 ?\n                    (this.legendTitleSize.height - (this.legendTitleSize.height / this.legendTitleCollections.length)) : 0;\n            }\n        }\n        this.rowCount = Math.max(1, Math.ceil((legendBounds.height - legend.padding - titleHeight) /\n            (this.maxItemHeight + legend.padding)));\n    };\n    /**\n     * To find legend location based on position, alignment for chart and accumulation chart\n     */\n    BaseLegend.prototype.getLocation = function (position, alignment, legendBounds, rect, availableSize, maxLabelSize) {\n        var padding = this.legend.border.width;\n        var isBulletChart = this.isBulletChartControl;\n        var bulletChart = this.bulletChart;\n        var labelIns = bulletChart.labelPosition === 'Inside';\n        var ticklIns = bulletChart.tickPosition === 'Inside';\n        var isVertical = bulletChart.orientation === 'Vertical';\n        // tslint:disable-next-line:max-line-length\n        var categoryFieldValue = (isBulletChart && bulletChart.categoryField !== '') ? maxLabelSize.width + this.chart.border.width + padding * 3 : 0;\n        var legendHeight = legendBounds.height + padding + this.legend.margin.top + this.legend.margin.bottom;\n        var legendWidth = legendBounds.width + padding + this.legend.margin.left + this.legend.margin.right;\n        var marginBottom = this.chart.margin.bottom;\n        if (position === 'Bottom') {\n            legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment);\n            // tslint:disable-next-line:max-line-length\n            legendBounds.y = rect.y + (rect.height - legendHeight) + padding + this.legend.margin.top;\n            legendBounds.y += (isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns\n                // tslint:disable-next-line:max-line-length\n                //tslint:disable-next-line:max-line-length\n                && !isVertical) ? bulletChart.majorTickLines.height + marginBottom + this.legend.border.width + padding * 2 :\n                (isVertical && bulletChart.categoryField !== '') ? maxLabelSize.height + padding * 2 : 0;\n            subtractThickness(rect, new Thickness(0, 0, 0, legendHeight));\n        }\n        else if (position === 'Top') {\n            legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment);\n            legendBounds.y = rect.y + padding + this.legend.margin.top;\n            legendBounds.y -= (isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns &&\n                // // tslint:disable-next-line:max-line-length\n                !isVertical) ? bulletChart.majorTickLines.height + this.chart.margin.top : 0;\n            legendHeight -= (isBulletChart) ? -padding * 2 : 0;\n            subtractThickness(rect, new Thickness(0, 0, legendHeight, 0));\n        }\n        else if (position === 'Right') {\n            legendBounds.x = rect.x + (rect.width - legendBounds.width) - this.legend.margin.right;\n            legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n            legendWidth += (isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns &&\n                isVertical) ? (this.chart.margin.left + this.chart.margin.right + bulletChart.majorTickLines.height) : 0;\n            subtractThickness(rect, new Thickness(0, legendWidth, 0, 0));\n        }\n        else if (position === 'Left') {\n            legendBounds.x = legendBounds.x + this.legend.margin.left;\n            legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n            legendWidth += (isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns &&\n                // tslint:disable-next-line:max-line-length\n                // tslint:disable-next-line:max-line-length\n                isVertical) ? (legendBounds.x - this.chart.margin.left + padding + bulletChart.majorTickLines.height) :\n                (bulletChart.orientation !== 'Vertical' && bulletChart.categoryField !== '') ? categoryFieldValue : 0;\n            subtractThickness(rect, new Thickness(legendWidth, 0, 0, 0));\n        }\n        else {\n            legendBounds.x = this.legend.location.x;\n            legendBounds.y = this.legend.location.y;\n            subtractThickness(rect, new Thickness(0, 0, 0, 0));\n        }\n    };\n    /**\n     * To find legend alignment for chart and accumulation chart\n     */\n    BaseLegend.prototype.alignLegend = function (start, size, legendSize, alignment) {\n        switch (alignment) {\n            case 'Far':\n                start = (size - legendSize) - start;\n                break;\n            case 'Center':\n                start = ((size - legendSize) / 2);\n                break;\n        }\n        return start;\n    };\n    /**\n     * Renders the legend.\n     * @return {void}\n     * @private\n     */\n    BaseLegend.prototype.renderLegend = function (chart, legend, legendBounds, redraw) {\n        var firstLegend = this.findFirstLegendPosition(this.legendCollections);\n        var padding = legend.padding;\n        var titleHeight = 0;\n        var titlePlusArrowWidth = 0;\n        var isPaging = legend.enablePages;\n        var titlePosition = legend.titlePosition;\n        var upArrowHeight = this.isPaging && !legend.enablePages && this.isVertical ? this.pageButtonSize : 0;\n        this.legendRegions = [];\n        this.maxItemHeight = Math.max(this.legendCollections[0].textSize.height, legend.shapeHeight);\n        var legendGroup = chart.renderer.createGroup({ id: this.legendID + '_g' });\n        var legendTranslateGroup = this.createLegendElements(chart, legendBounds, legendGroup, legend, this.legendID, redraw);\n        // For new legend navigation\n        if (!isPaging && this.isPaging && !this.isVertical) {\n            titlePlusArrowWidth = !this.isTitle ? 0 : titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n            titlePlusArrowWidth += (this.pageButtonSize + (2 * this.fivePixel));\n        }\n        else if (!this.isPaging && !this.isVertical) {\n            titlePlusArrowWidth = this.isTitle && titlePosition === 'Left' ? (this.fivePixel + this.legendTitleSize.width) : 0;\n        }\n        titleHeight = !this.isTitle ? 0 : (this.isTop || this.isVertical ? this.legendTitleSize.height : 0);\n        var pagingLegendBounds = new Rect(0, 0, 0, 0);\n        var requireLegendBounds = new Rect(0, 0, 0, 0);\n        if (firstLegend !== this.legendCollections.length) {\n            var legendSeriesGroup = void 0; // legendItem group for each series group element\n            var start = void 0; // starting shape center x,y position && to resolve lint error used new line for declaration\n            start = new ChartLocation(this.isBulletChartControl ? legendBounds.x + titlePlusArrowWidth + padding + (legend.shapeWidth / 2) :\n                legendBounds.x + titlePlusArrowWidth + padding + (legend.shapeWidth / 2) + legend.containerPadding.left, this.isBulletChartControl ? legendBounds.y + titleHeight + upArrowHeight + padding + (this.maxItemHeight / 2) :\n                legendBounds.y + titleHeight + upArrowHeight + padding + (this.maxItemHeight / 2) + legend.containerPadding.top);\n            var anchor = chart.isRtlEnabled ? 'end' : 'start';\n            var textOptions = new TextOption('', start.x, start.y, anchor);\n            //  initialization for totalPages legend click totalpage again calculate\n            this.totalPages = this.totalPages = (this.isChartControl || this.isBulletChartControl) ? this.totalPages : 0;\n            var textPadding = legend.shapePadding + padding + legend.shapeWidth;\n            var count = 0;\n            this.pageXCollections = [];\n            this.legendCollections[firstLegend].location = start;\n            var previousLegend = this.legendCollections[firstLegend];\n            if (!legend.enablePages && this.isPaging) {\n                var x = start.x - this.fivePixel;\n                var y = start.y - this.fivePixel;\n                var rightSpace = this.isTitle && !this.isVertical && titlePosition === 'Right' ?\n                    this.legendTitleSize.width + this.fivePixel : 0;\n                var leftSpace = this.isTitle && !this.isVertical && titlePosition === 'Left' ?\n                    this.legendTitleSize.width + this.fivePixel : 0;\n                rightSpace += this.isVertical ? 0 : (this.fivePixel + this.pageButtonSize + this.fivePixel);\n                var bottomSapce = this.isVertical ? (this.pageButtonSize) + Math.abs(y - legendBounds.y) : 0;\n                pagingLegendBounds = new Rect(x, y, legendBounds.width - rightSpace - leftSpace, legendBounds.height - bottomSapce);\n                requireLegendBounds = pagingLegendBounds;\n            }\n            else {\n                requireLegendBounds = legendBounds;\n            }\n            for (var _i = 0, _a = this.legendCollections; _i < _a.length; _i++) {\n                var legendOption = _a[_i];\n                if (this.chart.getModuleName() === 'accumulationchart') {\n                    // tslint:disable-next-line:max-line-length\n                    legendOption.fill = (this.chart || this.chart).visibleSeries[0].points[legendOption.pointIndex].color;\n                }\n                this.accessbilityText = (this.isBulletChartControl) ? 'Legend of bullet chart' + '' + legendOption.text\n                    : 'Click to show or hide the ' + legendOption.text + ' series';\n                if (legendOption.render && legendOption.text !== '') {\n                    legendSeriesGroup = chart.renderer.createGroup({\n                        id: this.legendID + this.generateId(legendOption, '_g_', count)\n                    });\n                    if (legendSeriesGroup) {\n                        legendSeriesGroup.setAttribute('tabindex', legend.tabIndex.toString());\n                        legendSeriesGroup.setAttribute('aria-label', legend.description ||\n                            this.accessbilityText);\n                    }\n                    this.library.getRenderPoint(legendOption, start, textPadding, previousLegend, requireLegendBounds, count, firstLegend);\n                    this.renderSymbol(legendOption, legendSeriesGroup, count);\n                    this.renderText(chart, legendOption, legendSeriesGroup, textOptions, count);\n                    if (legendSeriesGroup) {\n                        legendSeriesGroup.setAttribute('style', 'cursor: ' + ((!legend.toggleVisibility && (chart.selectionMode === 'None' ||\n                            chart.highlightMode === 'None' ||\n                            chart.selectionMode === 'None') || this.isBulletChartControl) ? 'auto' : 'pointer'));\n                    }\n                    if (legendTranslateGroup) {\n                        legendTranslateGroup.appendChild(legendSeriesGroup);\n                    }\n                    previousLegend = legendOption;\n                }\n                count++;\n            }\n            if (this.isPaging) {\n                this.renderPagingElements(chart, legendBounds, textOptions, legendGroup);\n            }\n            else {\n                this.totalPages = 1;\n            }\n        }\n        appendChildElement(chart.enableCanvas, chart.svgObject, legendGroup, redraw);\n    };\n    /**\n     * To find first valid legend text index for chart and accumulation chart\n     */\n    BaseLegend.prototype.findFirstLegendPosition = function (legendCollection) {\n        var count = 0;\n        for (var _i = 0, legendCollection_1 = legendCollection; _i < legendCollection_1.length; _i++) {\n            var legend = legendCollection_1[_i];\n            if (legend.render && legend.text !== '') {\n                break;\n            }\n            count++;\n        }\n        return count;\n    };\n    /**\n     * To get the legend title text width and height.\n     * @param legend\n     * @param legendBounds\n     */\n    BaseLegend.prototype.calculateLegendTitle = function (legend, legendBounds) {\n        if (legend.title) {\n            this.isTop = legend.titlePosition === 'Top';\n            var padding = legend.titleStyle.textOverflow === 'Trim' ? 2 * legend.padding : 0;\n            if (this.isTop || this.isVertical) {\n                this.legendTitleCollections = getTitle(legend.title, legend.titleStyle, (legendBounds.width - padding));\n            }\n            else {\n                this.legendTitleCollections[0] = textTrim(legend.maximumTitleWidth, legend.title, legend.titleStyle);\n            }\n            var text = this.isTop ? legend.title : this.legendTitleCollections[0];\n            this.legendTitleSize = measureText(text, legend.titleStyle);\n            this.legendTitleSize.height *= this.legendTitleCollections.length;\n        }\n        else {\n            this.legendTitleSize = new Size(0, 0);\n        }\n    };\n    /**\n     * Render the legend title\n     * @param chart\n     * @param legend\n     * @param legendBounds\n     * @param legendGroup\n     */\n    BaseLegend.prototype.renderLegendTitle = function (chart, legend, legendBounds, legendGroup) {\n        var padding = legend.padding;\n        this.isTop = legend.titlePosition === 'Top';\n        var alignment = legend.titleStyle.textAlignment;\n        var anchor = alignment === 'Near' ? 'start' : alignment === 'Far' ? 'end' : 'middle';\n        anchor = this.isTop || this.isVertical ? anchor : '';\n        var x = titlePositionX(legendBounds, legend.titleStyle);\n        x = alignment === 'Near' ? (x + padding) : alignment === 'Far' ? (x - padding) : x;\n        x = (this.isTop || this.isVertical) ? x : ((legendBounds.x) + (legend.titlePosition === 'Left' ? 5 :\n            (legendBounds.width - this.legendTitleSize.width - 5)));\n        var topPadding = (legendBounds.height / 2) + (this.legendTitleSize.height / 4);\n        var y = legendBounds.y + (!this.isTop && !this.isVertical ? topPadding :\n            (this.legendTitleSize.height / this.legendTitleCollections.length));\n        var legendTitleTextOptions = new TextOption(this.legendID + '_title', x, y, anchor, this.legendTitleCollections);\n        textElement(chart.renderer, legendTitleTextOptions, legend.titleStyle, legend.titleStyle.color, legendGroup);\n    };\n    /**\n     * To create legend rendering elements for chart and accumulation chart\n     * @param chart\n     * @param legendBounds\n     * @param legendGroup\n     * @param legend\n     * @param id\n     * @param redraw\n     */\n    BaseLegend.prototype.createLegendElements = function (chart, legendBounds, legendGroup, legend, id, redraw) {\n        var padding = legend.padding;\n        var options = new RectOption(id + '_element', legend.background, legend.border, legend.opacity, legendBounds);\n        legendGroup ? legendGroup.appendChild(chart.renderer.drawRectangle(options)) : chart.renderer.drawRectangle(options);\n        if (legend.title) {\n            this.renderLegendTitle(chart, legend, legendBounds, legendGroup);\n        }\n        var legendItemsGroup = chart.renderer.createGroup({ id: id + '_collections' });\n        var isCanvas = chart.enableCanvas;\n        if (!isCanvas) {\n            legendGroup.appendChild(legendItemsGroup);\n        }\n        this.legendTranslateGroup = chart.renderer.createGroup({ id: id + '_translate_g' });\n        if (!isCanvas) {\n            legendItemsGroup.appendChild(this.legendTranslateGroup);\n        }\n        var clippath = chart.renderer.createClipPath({ id: id + '_clipPath' });\n        options.y += padding + (this.isTop ? this.legendTitleSize.height : 0);\n        options.id += '_clipPath_rect';\n        options.width = ((!this.isChartControl && chart.getModuleName() !== 'bulletChart') && this.isVertical) ? this.maxWidth - padding + legend.containerPadding.left + legend.containerPadding.right\n            : legendBounds.width;\n        if (!isCanvas) {\n            this.clipRect = chart.renderer.drawRectangle(options);\n            clippath.appendChild(this.clipRect);\n        }\n        else {\n            this.pagingClipRect = options;\n        }\n        appendChildElement(isCanvas, chart.svgObject, clippath, redraw);\n        if (!isCanvas) {\n            legendItemsGroup.setAttribute('style', 'clip-path:url(#' + clippath.id + ')');\n        }\n        return this.legendTranslateGroup;\n    };\n    /**\n     * To render legend symbols for chart and accumulation chart\n     */\n    BaseLegend.prototype.renderSymbol = function (legendOption, group, i) {\n        var borderColor;\n        var control = this.isBulletChartControl ? this.chart : null;\n        var symbolColor = legendOption.visible ? legendOption.fill : '#D3D3D3';\n        var shape = (legendOption.shape === 'SeriesType') ? legendOption.type : legendOption.shape;\n        shape = shape === 'Scatter' ? legendOption.markerShape : shape;\n        var isStrokeWidth = (this.chart.getModuleName() === 'chart' && (legendOption.shape === 'SeriesType') &&\n            (legendOption.type.toLowerCase().indexOf('line') > -1) && (legendOption.type.toLowerCase().indexOf('area') === -1));\n        var strokewidth = isStrokeWidth ? this.chart.visibleSeries[i].width :\n            (this.isBulletChartControl && legendOption.shape === 'Multiply') ? 4 : 1;\n        var isCustomBorder = this.chart.getModuleName() === 'chart' &&\n            (legendOption.type === 'Scatter' || legendOption.type === 'Bubble');\n        if (isCustomBorder && i < this.chart.visibleSeries.length) {\n            var seriesBorder = this.chart.visibleSeries[i].border;\n            borderColor = seriesBorder.color ? seriesBorder.color : symbolColor;\n            strokewidth = seriesBorder.width ? seriesBorder.width : 1;\n        }\n        var symbolOption = new PathOption(this.legendID + this.generateId(legendOption, '_shape_', i), symbolColor, strokewidth, (isCustomBorder ? borderColor : symbolColor), 1, '', '');\n        var regionPadding;\n        var isCanvas = this.chart.enableCanvas;\n        if (!isCanvas) {\n            group.appendChild(drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), \n            // tslint:disable-next-line:max-line-length\n            // tslint:disable-next-line:align\n            legendOption.url, symbolOption, this.accessbilityText, this.chart.renderer, null, this.isBulletChartControl, control));\n        }\n        else {\n            regionPadding = -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber);\n            drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), '', \n            // tslint:disable-next-line:align\n            symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ? new Rect(0, regionPadding, 0, 0) : null, this.isBulletChartControl, control);\n            this.legendRegions.push({\n                rect: new Rect(legendOption.location.x, legendOption.location.y, \n                // tslint:disable-next-line:align\n                this.legend.shapeWidth, this.legend.shapeHeight + regionPadding), index: i\n            });\n        }\n        if (shape === 'Line' && legendOption.markerVisibility && legendOption.markerShape !== 'Image' ||\n            legendOption.type === 'Doughnut') {\n            symbolOption.id = this.legendID + this.generateId(legendOption, '_shape_marker_', i);\n            shape = legendOption.type === 'Doughnut' ? 'Circle' : legendOption.markerShape;\n            symbolOption.fill = legendOption.type === 'Doughnut' ? '#FFFFFF' : symbolOption.fill;\n            if (!isCanvas) {\n                // tslint:disable-next-line:max-line-length\n                group.appendChild(drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), \n                // tslint:disable-next-line:align\n                '', symbolOption, this.accessbilityText, null, null, this.isBulletChartControl, control));\n            }\n            else {\n                drawSymbol(legendOption.location, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), \n                // tslint:disable-next-line:align\n                '', symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ?\n                    new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null, this.isBulletChartControl, control);\n            }\n        }\n    };\n    /**\n     * To render legend text for chart and accumulation chart\n     */\n    BaseLegend.prototype.renderText = function (chart, legendOption, group, textOptions, i) {\n        var legend = chart.legendSettings;\n        var hiddenColor = '#D3D3D3';\n        textOptions.id = this.legendID + this.generateId(legendOption, '_text_', i);\n        var fontcolor = legendOption.visible ? legend.textStyle.color || chart.themeStyle.legendLabel : hiddenColor;\n        textOptions.text = legendOption.text;\n        textOptions.x = legendOption.location.x + (legend.shapeWidth / 2) + legend.shapePadding;\n        textOptions.y = legendOption.location.y + this.maxItemHeight / 4;\n        var isCanvas = this.chart.enableCanvas;\n        var element = textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, group, false, false, false, false, null, this.currentPageNumber && isCanvas ?\n            new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n        if (element) {\n            element.setAttribute('aria-label', legend.description || this.accessbilityText);\n        }\n        if (isCanvas) {\n            var textSize = measureText(textOptions.text, legend.textStyle);\n            this.legendRegions[i].rect.y = textOptions.y < this.legendRegions[i].rect.y ? textOptions.y : this.legendRegions[i].rect.y;\n            this.legendRegions[i].rect.width += textSize.width;\n            this.legendRegions[i].rect.height = textSize.height;\n            this.legendRegions[i].rect.y -= textSize.height * 0.5;\n        }\n    };\n    /**\n     * To render legend paging elements for chart and accumulation chart\n     */\n    // tslint:disable-next-line:max-func-body-length\n    BaseLegend.prototype.renderPagingElements = function (chart, bounds, textOption, legendGroup) {\n        var paginggroup = chart.renderer.createGroup({ id: this.legendID + '_navigation' });\n        this.pagingRegions = [];\n        var pageTextElement;\n        var isCanvas = chart.enableCanvas;\n        var titleHeight = this.isBulletChartControl ? 0 : this.legendTitleSize.height;\n        this.backwardArrowOpacity = this.currentPage !== 1 ? 1 : 0;\n        this.forwardArrowOpacity = this.currentPage === this.totalPages ? 0 : 1;\n        if (!isCanvas) {\n            legendGroup.appendChild(paginggroup);\n        }\n        var grayColor = '#545454';\n        var legend = chart.legendSettings; // to solve parameter lint error, legend declaration is here\n        var padding = 8; // const padding for paging elements\n        if (this.isChartControl || this.isBulletChartControl || !this.isVertical) {\n            this.totalPages = Math.ceil(this.totalPages / Math.max(1, this.rowCount - 1));\n        }\n        else {\n            this.totalPages = Math.ceil(this.totalPages / this.maxColumns);\n        }\n        var symbolOption = new PathOption(this.legendID + '_pageup', 'transparent', 5, grayColor, 1, '', '');\n        var iconSize = this.pageButtonSize;\n        if (paginggroup) {\n            paginggroup.setAttribute('style', 'cursor: pointer');\n        }\n        // Page left arrow drawing calculation started here\n        var rowCount = !legend.enablePages && this.isPaging && !this.isVertical && !this.isBulletChartControl ? 1 :\n            (this.rowCount - 1);\n        this.clipPathHeight = rowCount * (this.maxItemHeight + legend.padding);\n        if (!isCanvas) {\n            this.clipRect.setAttribute('height', this.clipPathHeight.toString());\n        }\n        else {\n            //paging clipRect only for canvas mode\n            this.pagingClipRect.height = this.legendBounds.height - this.clipPathHeight -\n                (this.pagingClipRect.y - this.legendBounds.y) - legend.border.width;\n            this.pagingClipRect.y = this.pagingClipRect.y + this.clipPathHeight;\n            this.pagingClipRect.x += legend.border.width;\n            this.pagingClipRect.width -= (legend.border.width + legend.border.width / 2);\n            this.chart.renderer.clearRect(new Rect(this.pagingClipRect.x, this.pagingClipRect.y, this.pagingClipRect.width, this.pagingClipRect.height));\n        }\n        var titleWidth = this.isTitle && legend.titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n        var x = (bounds.x + iconSize / 2);\n        var y = bounds.y + this.clipPathHeight + ((titleHeight + bounds.height - this.clipPathHeight) / 2);\n        if (this.isPaging && !legend.enablePages && !this.isVertical && !this.isBulletChartControl) {\n            x = (bounds.x + this.fivePixel + this.pageButtonSize + titleWidth);\n            y = legend.title && this.isTop ? (bounds.y + padding + titleHeight + (iconSize / 1) + 0.5) :\n                (bounds.y + padding + iconSize + 0.5);\n        }\n        var size = measureText(this.totalPages + '/' + this.totalPages, legend.textStyle);\n        if (!isCanvas) {\n            if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n                x = bounds.x + (bounds.width / 2);\n                y = bounds.y + (iconSize / 2) + padding + titleHeight;\n                symbolOption.opacity = this.backwardArrowOpacity;\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'UpArrow', new Size(iconSize, iconSize), '', symbolOption, 'UpArrow'));\n            }\n            else {\n                symbolOption.opacity = this.isBulletChartControl ? symbolOption.opacity :\n                    (legend.enablePages ? 1 : this.backwardArrowOpacity);\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow'));\n            }\n        }\n        else {\n            drawSymbol({ x: x, y: y }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow', this.chart.renderer, new Rect(bounds.width - (2 * (iconSize + padding) + padding + size.width), 0, 0, 0));\n        }\n        this.pagingRegions.push(new Rect(x + bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5, y - iconSize * 0.5, iconSize, iconSize));\n        // Page numbering rendering calculation started here\n        textOption.x = x + (iconSize / 2) + padding;\n        textOption.y = y + (size.height / 4);\n        textOption.id = this.legendID + '_pagenumber';\n        textOption.text = '1/' + this.totalPages;\n        if (isCanvas && this.totalNoOfPages) {\n            textOption.text = this.currentPageNumber + '/' + this.totalNoOfPages;\n        }\n        if (legend.enablePages || this.isBulletChartControl) {\n            pageTextElement = textElement(chart.renderer, textOption, legend.textStyle, legend.textStyle.color, paginggroup, false, false, false, false, null, new Rect(bounds.width - (2 * (iconSize + padding) + padding + size.width), 0, 0, 0));\n        }\n        // Page right arrow rendering calculation started here\n        x = textOption.x + padding + (iconSize / 2) + size.width;\n        if (this.isPaging && !legend.enablePages && !this.isVertical) {\n            x = (bounds.x + bounds.width - this.fivePixel - this.pageButtonSize - (legend.title && legend.titlePosition === 'Right' ?\n                this.legendTitleSize.width + this.fivePixel : 0));\n        }\n        symbolOption.id = this.legendID + '_pagedown';\n        symbolOption.opacity = !legend.enablePages ? this.forwardArrowOpacity : 1;\n        if (!isCanvas) {\n            if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n                x = bounds.x + (bounds.width / 2);\n                y = bounds.y + bounds.height - (iconSize / 2) - padding;\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'DownArrow', new Size(iconSize, iconSize), '', symbolOption, 'DownArrow'));\n            }\n            else {\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow'));\n            }\n        }\n        else {\n            drawSymbol({ x: x, y: y }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow', this.chart.renderer, new Rect(bounds.width - (2 * (iconSize + padding) + padding + size.width), 0, 0, 0));\n        }\n        this.pagingRegions.push(new Rect(x + (bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5), y - iconSize * 0.5, iconSize, iconSize));\n        if (!isCanvas && (legend.enablePages || this.isBulletChartControl)) {\n            //placing the navigation buttons and page numbering in legend right corner\n            paginggroup.setAttribute('transform', 'translate(' + (bounds.width - (2 * (iconSize + padding) +\n                padding + size.width)) + ', ' + 0 + ')');\n        }\n        else {\n            if (this.currentPageNumber === 1 && this.calTotalPage && (legend.enablePages || this.isBulletChartControl)) {\n                this.totalNoOfPages = this.totalPages;\n                this.calTotalPage = false;\n            }\n            if (!legend.enablePages && !this.isBulletChartControl) { // For new legend page navigation\n                this.translatePage(null, this.currentPage - 1, this.currentPage, legend);\n            }\n        }\n        if (legend.enablePages || this.isBulletChartControl) {\n            this.translatePage(pageTextElement, this.currentPage - 1, this.currentPage, legend);\n        }\n    };\n    /**\n     * To translate legend pages for chart and accumulation chart\n     */\n    BaseLegend.prototype.translatePage = function (pagingText, page, pageNumber, legend) {\n        var size = (this.clipPathHeight) * page;\n        var translate = 'translate(0,-' + size + ')';\n        if (!this.isChartControl && !this.isBulletChartControl && this.isVertical) {\n            var pageLength = page * this.maxColumns;\n            size = this.pageXCollections[page * this.maxColumns] - this.legendBounds.x;\n            size = size < 0 ? 0 : size; // to avoid small pixel variation\n            translate = 'translate(-' + size + ',0)';\n        }\n        if (!this.chart.enableCanvas) {\n            this.legendTranslateGroup.setAttribute('transform', translate);\n        }\n        if (!this.chart.enableCanvas && (legend.enablePages || this.isBulletChartControl)) {\n            pagingText.textContent = (pageNumber) + '/' + this.totalPages;\n        }\n        this.currentPage = pageNumber;\n        return size;\n    };\n    /**\n     * To change legend pages for chart and accumulation chart\n     */\n    BaseLegend.prototype.changePage = function (event, pageUp) {\n        var legend = this.chart.legendSettings;\n        var backwardArrow = document.getElementById(this.legendID + '_pageup');\n        var forwardArrow = document.getElementById(this.legendID + '_pagedown');\n        var pageText = (legend.enablePages || this.isBulletChartControl) ?\n            document.getElementById(this.legendID + '_pagenumber') : null;\n        var page = (legend.enablePages || this.isBulletChartControl) ? parseInt(pageText.textContent.split('/')[0], 10) :\n            this.currentPage;\n        if (pageUp && page > 1) {\n            this.translatePage(pageText, (page - 2), (page - 1), legend);\n        }\n        else if (!pageUp && page < this.totalPages) {\n            this.translatePage(pageText, page, (page + 1), legend);\n        }\n        if (this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n            this.currentPage === this.totalPages ? this.hideArrow(forwardArrow) : this.showArrow(forwardArrow);\n            this.currentPage === 1 ? this.hideArrow(backwardArrow) : this.showArrow(backwardArrow);\n        }\n    };\n    /**\n     * To hide the backward and forward arrow\n     * @param arrowElement\n     */\n    BaseLegend.prototype.hideArrow = function (arrowElement) {\n        arrowElement.setAttribute('opacity', '0');\n    };\n    /**\n     * To show the  backward and forward arrow\n     * @param arrowElement\n     */\n    BaseLegend.prototype.showArrow = function (arrowElement) {\n        arrowElement.setAttribute('opacity', '1');\n    };\n    /**\n     * To find legend elements id based on chart or accumulation chart\n     * @private\n     */\n    BaseLegend.prototype.generateId = function (option, prefix, count) {\n        if (this.isChartControl) {\n            return prefix + count;\n        }\n        else {\n            return prefix + option.pointIndex;\n        }\n    };\n    /**\n     * To show or hide trimmed text tooltip for legend.\n     * @return {void}\n     * @private\n     */\n    BaseLegend.prototype.move = function (event) {\n        var _this = this;\n        var x = this.chart.mouseX;\n        var y = this.chart.mouseY;\n        if (event.target.textContent.indexOf('...') > -1) {\n            var targetId = event.target.id.split(this.legendID + '_text_');\n            if (targetId.length === 2) {\n                var index = parseInt(targetId[1], 10);\n                var element = this.chart.element;\n                if (!isNaN(index)) {\n                    if (this.chart.isTouch) {\n                        removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n                    }\n                    if (this.isChartControl) {\n                        showTooltip(this.chart.series[index].name, x, y, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n                    }\n                    else {\n                        showTooltip(this.chart.visibleSeries[0].points[index].x.toString(), x + 10, y + 10, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n                    }\n                }\n            }\n        }\n        else {\n            removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n        }\n        if (this.chart.isTouch) {\n            clearTimeout(this.clearTooltip);\n            this.clearTooltip = setTimeout(function () { removeElement(_this.chart.element.id + '_EJ2_Legend_Tooltip'); }, 1000);\n        }\n    };\n    return BaseLegend;\n}());\nexport { BaseLegend };\n/**\n * Class for legend options\n * @private\n */\nvar LegendOptions = /** @class */ (function () {\n    function LegendOptions(text, fill, shape, visible, type, url, markerShape, markerVisibility, pointIndex, seriesIndex) {\n        this.location = { x: 0, y: 0 };\n        this.text = text;\n        this.fill = fill;\n        this.shape = shape;\n        this.url = url;\n        this.visible = visible;\n        this.type = type;\n        this.markerVisibility = markerVisibility;\n        this.markerShape = markerShape;\n        this.pointIndex = pointIndex;\n        this.seriesIndex = seriesIndex;\n    }\n    return LegendOptions;\n}());\nexport { LegendOptions };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}