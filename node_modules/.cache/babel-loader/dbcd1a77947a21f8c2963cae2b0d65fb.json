{"ast":null,"code":"import { measureText, TextOption, renderTextElement, CircleOption, PathOption, RectOption } from '../../smithchart/utils/helper';\nimport { SmithchartRect, LegendSeries } from '../../smithchart/utils/utils';\nimport { legendRender } from '../model/constant';\n/* tslint:disable:no-string-literal */\n\nvar SmithchartLegend =\n/** @class */\nfunction () {\n  function SmithchartLegend() {\n    this.legendSeries = [];\n  }\n\n  SmithchartLegend.prototype.renderLegend = function (smithchart) {\n    this.calculateLegendBounds(smithchart);\n\n    this._drawLegend(smithchart);\n\n    return this.legendActualBounds;\n  };\n\n  SmithchartLegend.prototype.calculateLegendBounds = function (smithchart) {\n    var legendSeries = new LegendSeries();\n    this.legendSeries = [];\n    var padding = 10;\n    var legend = smithchart.legendSettings;\n    var legendSizeHeight = legend.height;\n    var legendSizeWidth = legend.width;\n    var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n    var position = legend.position.toLowerCase();\n    var font = legend.title.textStyle;\n    var width = 0;\n    var height = 0;\n    var legendItemWidth = 0;\n    var legendItemHeight = 0;\n    var legendHeight = 0;\n    var svgObjectWidth = smithchart.availableSize.width - (smithchart.elementSpacing * 4 - legend.border.width * 2 + smithchart.border.width * 2);\n    var svgObjectHeight = smithchart.availableSize.height - (smithchart.elementSpacing * 4 - legend.border.width * 2 + smithchart.border.width * 2);\n    var rowCount = legend.rowCount;\n    var columnCount = legend.columnCount;\n    var titleSize = measureText(smithchart.legendSettings['title']['text'], font);\n    var maxRowWidth = 0;\n    var totalRowHeight = 0;\n    var curRowWidth = 0;\n    var curRowHeight = 0;\n    var allowItems;\n    var itemsCountRow = 0;\n    var length = smithchart.series.length;\n    var legendBounds;\n\n    if (smithchart.legendSettings.visible && length !== 0) {\n      if (position === 'bottom' || position === 'top' || position === 'custom') {\n        if (rowCount && columnCount && rowCount <= columnCount) {\n          rowCount = length / columnCount;\n        } else if (rowCount == null && columnCount != null) {\n          rowCount = length / columnCount;\n        } else if (rowCount == null && columnCount == null) {\n          rowCount = 1;\n        }\n\n        if (rowCount) {\n          allowItems = Math.ceil(length / rowCount);\n        }\n      } else {\n        if (rowCount && columnCount && rowCount <= columnCount) {\n          columnCount = length / rowCount;\n        } else if (rowCount != null && columnCount == null) {\n          columnCount = length / rowCount;\n        } else if (rowCount == null && columnCount == null) {\n          columnCount = 1;\n        }\n\n        if (columnCount) {\n          allowItems = columnCount;\n        }\n      }\n\n      for (var i = 0; i < length; i++) {\n        this.legendSeries.push({\n          text: smithchart.series[i]['name'] ? smithchart.series[i]['name'] : 'series' + i,\n          seriesIndex: i,\n          shape: smithchart.legendSettings.shape,\n          fill: smithchart.series[i].fill || smithchart.seriesColors[i % smithchart.seriesColors.length],\n          bounds: null\n        });\n\n        var legendsize = this._getLegendSize(smithchart, this.legendSeries[i]);\n\n        legendItemWidth = Math.max(legendsize['width'], legendItemWidth);\n        legendItemHeight = Math.max(legendsize['height'], legendItemHeight);\n        this.legendSeries[i]['bounds'] = {\n          width: legendItemWidth,\n          height: legendItemHeight\n        };\n        itemsCountRow = itemsCountRow + 1;\n        curRowWidth = curRowWidth + legendItemWidth + itemPadding;\n        curRowHeight = Math.max(legendItemHeight, curRowHeight);\n\n        if (position === 'top' || position === 'bottom' || position === 'custom') {\n          if (curRowWidth > svgObjectWidth) {\n            curRowWidth -= legendsize.width + itemPadding;\n            maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n            curRowWidth = legendsize.width + itemPadding;\n            totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n          }\n        }\n\n        if (itemsCountRow === allowItems || i === length - 1) {\n          maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n          totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n          legendHeight = totalRowHeight;\n          itemsCountRow = 0;\n          curRowHeight = 0;\n          curRowWidth = 0;\n        }\n      }\n\n      width = titleSize.width > maxRowWidth - itemPadding ? titleSize.width + padding * 2 + itemPadding : maxRowWidth + padding * 2 - smithchart.border.width * 2;\n      height = legendHeight + smithchart.elementSpacing;\n      legendBounds = {\n        x: 0,\n        y: 0,\n        width: width,\n        height: height\n      };\n    }\n\n    this.legendActualBounds = legendBounds;\n\n    if (legendSizeWidth != null) {\n      this.legendActualBounds.width = legendSizeWidth;\n    }\n\n    if (legendSizeHeight != null) {\n      this.legendActualBounds.height = legendSizeHeight;\n    }\n  };\n\n  SmithchartLegend.prototype._getLegendSize = function (smithchart, series) {\n    var legend = smithchart.legendSettings;\n    var symbolWidth = legend.itemStyle.width;\n    var symbolHeight = legend.itemStyle.height;\n    var textSize = measureText(series.text, legend.textStyle);\n    var width = symbolWidth + textSize.width + legend.shapePadding;\n    var height = Math.max(symbolHeight, textSize.height);\n    return {\n      width: width,\n      height: height\n    };\n  }; // tslint:disable:max-func-body-length\n\n\n  SmithchartLegend.prototype._drawLegend = function (smithchart) {\n    var legend = smithchart.legendSettings;\n    var legendPosition = legend.position.toLowerCase();\n    var alignment = legend.alignment;\n    var legendBounds = this.legendActualBounds;\n    var maxWidth = 0;\n    var startX;\n    var startY;\n    var titleFont = smithchart.title.font ? smithchart.title.font : smithchart.title.textStyle;\n    var smithchartTitleHeight = measureText(smithchart.title.text, titleFont).height;\n    var smithchartSubtitleHeight = measureText(smithchart.title.subtitle.text, smithchart.title.subtitle.textStyle).height;\n    var elementSpacing = smithchart.elementSpacing;\n    var offset = smithchartTitleHeight + smithchartSubtitleHeight + elementSpacing + smithchart.margin.top;\n    var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n    var svgObjectWidth = smithchart.availableSize.width;\n    var svgObjectHeight = smithchart.availableSize.height;\n    var legendBorder = legend.border.width;\n    var legendWidth = 0;\n    var titleSize = measureText(legend['title']['text'], legend.title.textStyle);\n    var legendTitleHeight = titleSize.height;\n    var borderSize = smithchart.border.width;\n    var svgWidth = svgObjectWidth - borderSize * 2;\n    var svgHeight = svgObjectHeight - borderSize * 2;\n    legendBounds.height += legendTitleHeight;\n\n    if (legendPosition !== 'custom') {\n      switch (legendPosition) {\n        case 'bottom':\n          legendBounds.y = svgHeight - (legendBounds.height + legendBorder + elementSpacing);\n          break;\n\n        case 'top':\n          legendBounds.y = borderSize + offset;\n          break;\n\n        case 'right':\n          legendBounds.x = svgWidth - legendBounds.width - elementSpacing * 2;\n          break;\n\n        case 'left':\n          legendBounds.x = borderSize + elementSpacing * 2;\n          break;\n      }\n\n      if (legendPosition === 'left' || legendPosition === 'right') {\n        switch (alignment) {\n          case 'Center':\n            legendBounds.y = svgHeight / 2 - (legendBounds.height + legendBorder * 2) / 2 + elementSpacing / 2;\n            break;\n\n          case 'Near':\n            legendBounds.y = borderSize + elementSpacing * 2 + offset;\n            break;\n\n          case 'Far':\n            legendBounds.y = svgHeight - (legendBounds.height + legendBorder) - elementSpacing * 2;\n            break;\n        }\n      } else {\n        switch (alignment) {\n          case 'Center':\n            legendBounds.x = svgWidth / 2 - (legendBounds.width + legendBorder * 2) / 2 + elementSpacing / 2;\n            break;\n\n          case 'Near':\n            legendBounds.x = borderSize + elementSpacing * 2;\n            break;\n\n          case 'Far':\n            legendBounds.x = svgWidth - (legendBounds.width + legendBorder) - elementSpacing * 2;\n            break;\n        }\n      }\n    } else {\n      legendBounds.y = legend.location.y < svgHeight ? legend.location.y : 0;\n      legendBounds.x = legend.location.x < svgWidth ? legend.location.x : 0;\n    }\n\n    if (legendPosition === 'bottom' || legendPosition === 'top') {\n      for (var i = 0; i < this.legendSeries.length; i++) {\n        legendWidth += this.legendSeries[i].bounds.width + itemPadding;\n\n        if (legendWidth > svgWidth) {\n          legendBounds.x = svgWidth / 2 - (legendBounds.width + legendBorder * 2) / 2 + elementSpacing / 2;\n          break;\n        }\n      }\n    }\n\n    var gLegendEle = smithchart.renderer.createGroup({\n      'id': smithchart.element.id + '_legend_group'\n    });\n    smithchart.svgObject.appendChild(gLegendEle);\n    this.legendItemGroup = smithchart.renderer.createGroup({\n      'id': smithchart.element.id + 'legendItem_Group'\n    });\n    var currentX = startX = elementSpacing;\n    var currentY = startY = elementSpacing;\n\n    if (legend.title.text !== '' && legend.title.visible) {\n      gLegendEle.appendChild(this.drawLegendTitle(smithchart, legend, legendBounds, gLegendEle));\n      currentY = startY = elementSpacing + legendTitleHeight;\n    }\n\n    for (var k = 0; k < this.legendSeries.length; k++) {\n      if ((legend.rowCount < legend.columnCount || legend.rowCount === legend.columnCount) && (legendPosition === 'top' || legendPosition === 'bottom' || legendPosition === 'custom')) {\n        if (currentX + this.legendSeries[k]['bounds'].width > legendBounds.width + startX) {\n          currentX = elementSpacing;\n          currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n        }\n\n        this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, currentX, currentY, legendBounds);\n        gLegendEle.appendChild(this.legendGroup);\n        currentX += this.legendSeries[k]['bounds'].width + itemPadding;\n      } else {\n        if (currentY + this.legendSeries[k]['bounds'].height + itemPadding + legendTitleHeight + borderSize > legendBounds.height + startY) {\n          currentY = startY;\n          currentX += maxWidth + itemPadding;\n        }\n\n        this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, currentX, currentY, legendBounds);\n        gLegendEle.appendChild(this.legendGroup);\n        currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n        maxWidth = Math.max(maxWidth, this.legendSeries[k]['bounds'].width);\n      }\n    }\n\n    gLegendEle.setAttribute('transform', 'translate(' + legendBounds.x.toString() + ',' + legendBounds.y.toString() + ')');\n    this.drawLegendBorder(gLegendEle, smithchart, legend, legendBounds);\n  };\n\n  SmithchartLegend.prototype.drawLegendBorder = function (gLegendEle, smithchart, legend, legendBounds) {\n    var borderRect = new RectOption(smithchart.element.id + '_svg' + '_legendRect', 'none', legend.border, 1, new SmithchartRect(0, 0, legendBounds.width, legendBounds.height));\n    gLegendEle.appendChild(smithchart.renderer.drawRectangle(borderRect));\n  };\n\n  SmithchartLegend.prototype.drawLegendTitle = function (smithchart, legend, legendBounds, gLegendEle) {\n    var elementSpacing = smithchart.elementSpacing;\n    var titleSize = measureText(legend.title.text, legend.title.textStyle);\n    var titleWidth = titleSize.width;\n    var titleHeight = titleSize.height;\n    var textAlignment = legend.title.textAlignment;\n    var startX = 0;\n    var legendBoundsWidth = legendBounds.width;\n    var startY = elementSpacing + titleHeight / 2;\n\n    switch (textAlignment) {\n      case 'Far':\n        startX = legendBoundsWidth - titleWidth - startX;\n        break;\n\n      case 'Center':\n        startX = legendBoundsWidth / 2 - titleWidth / 2;\n        break;\n    }\n\n    if (startX < 0) {\n      startX = 0;\n      legendBoundsWidth = titleWidth;\n    }\n\n    if (legendBoundsWidth < titleWidth + startX) {\n      legendBoundsWidth = titleWidth + startX;\n    }\n\n    var options = new TextOption(smithchart.element.id + '_LegendTitleText', startX, startY, 'start', legend.title.text);\n    var element = renderTextElement(options, legend.title.textStyle, smithchart.themeStyle.legendLabel, gLegendEle);\n    element.setAttribute('aria-label', legend.title.description || legend.title.text);\n    return element;\n  };\n\n  SmithchartLegend.prototype.drawLegendItem = function (smithchart, legend, legendSeries, k, x, y, legendBounds) {\n    var _this = this;\n\n    var location;\n    var radius;\n    var symbol = legend.itemStyle;\n    var itemPadding = legend.itemPadding;\n    var textHeight;\n    radius = Math.sqrt(symbol['width'] * symbol['width'] + symbol['height'] * symbol['height']) / 2;\n    textHeight = measureText(legendSeries['text'], legend.textStyle).height;\n    location = {\n      x: x + symbol['width'] / 2,\n      y: y + (textHeight > symbol['height'] ? textHeight : symbol['height']) / 2\n    };\n    var legendGroup = smithchart.renderer.createGroup({\n      id: smithchart.element.id + '_svg' + '_Legend' + k.toString()\n    });\n    legendGroup['style']['cursor'] = legend.toggleVisibility ? 'pointer' : 'default';\n    var legendEventArgs = {\n      text: legendSeries['text'],\n      fill: legendSeries['fill'],\n      shape: legendSeries['shape'],\n      name: legendRender,\n      cancel: false\n    };\n\n    var legendRenderSuccess = function (args) {\n      if (!args.cancel) {\n        var shape = _this.drawLegendShape(smithchart, legendSeries, location.x, location.y, k, legend, args);\n\n        legendGroup.appendChild(shape);\n        var options = new TextOption(smithchart.element.id + '_LegendItemText' + k.toString(), location.x + symbol['width'] / 2 + legend.shapePadding, location.y + textHeight / 4, 'start', args.text);\n        legend.textStyle.fontFamily = smithchart.themeStyle.fontFamily || legend.textStyle.fontFamily;\n        legend.textStyle.size = smithchart.themeStyle.fontSize || legend.textStyle.size;\n        var element = renderTextElement(options, legend.textStyle, smithchart.themeStyle.legendLabel, legendGroup);\n        element.setAttribute('aria-label', legend.description || 'Click to show or hide the ' + options.text + ' series');\n        legendGroup.appendChild(element);\n\n        _this.legendItemGroup.appendChild(legendGroup);\n      }\n    };\n\n    legendRenderSuccess.bind(this);\n    smithchart.trigger(legendRender, legendEventArgs, legendRenderSuccess);\n    return this.legendItemGroup;\n  };\n\n  SmithchartLegend.prototype.drawLegendShape = function (smithchart, legendSeries, locX, locY, index, legend, legendEventArgs) {\n    var element;\n    var circleOptions;\n    var pathOptions;\n    var path;\n    var symbol = legend.itemStyle;\n    var width = symbol['width'];\n    var height = symbol['height'];\n    var x = locX + -width / 2;\n    var y = locY + -height / 2;\n    var border = {\n      color: symbol.border.color,\n      width: symbol.border.width\n    };\n    var opacity = 1;\n    var fill = smithchart.series[index].visibility === 'visible' ? legendEventArgs.fill : 'grey';\n    var shape = legendEventArgs.shape.toLowerCase();\n    var radius = Math.sqrt(height * height + width * width) / 2;\n\n    switch (shape) {\n      case 'circle':\n        circleOptions = new CircleOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border, opacity, locX, locY, radius, null);\n        element = smithchart.renderer.drawCircle(circleOptions);\n        break;\n\n      case 'rectangle':\n        path = 'M' + ' ' + x + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (width / 2 + locX) + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (locX + width / 2) + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + (locY + -height / 2) + ' z';\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n\n      case 'diamond':\n        path = 'M' + ' ' + x + ' ' + locY + ' ' + 'L' + ' ' + locX + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (width / 2 + locX) + ' ' + locY + ' ' + 'L' + ' ' + locX + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + locY + ' z';\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n\n      case 'pentagon':\n        var eq = 72;\n\n        for (var j = 0; j <= 5; j++) {\n          var xValue = radius * Math.cos(Math.PI / 180 * (j * eq));\n          var yValue = radius * Math.sin(Math.PI / 180 * (j * eq));\n\n          if (j === 0) {\n            path = 'M' + ' ' + (xValue + locX) + ' ' + (locY + yValue) + ' ';\n          } else {\n            path = path.concat('L' + ' ' + (locX + xValue) + ' ' + (locY + yValue) + ' ');\n          }\n        }\n\n        path = path.concat('Z');\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n\n      case 'triangle':\n        path = 'M' + ' ' + x + ' ' + (height / 2 + locY) + ' ' + 'L' + ' ' + locX + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (locX + width / 2) + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + (locY + height / 2) + ' Z';\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n    }\n\n    return element;\n  };\n  /**\n   * Get module name.\n   */\n\n\n  SmithchartLegend.prototype.getModuleName = function () {\n    return 'SmithchartLegend';\n  };\n  /**\n   * To destroy the legend.\n   * @return {void}\n   * @private\n   */\n\n\n  SmithchartLegend.prototype.destroy = function (smithchart) {\n    /**\n     * Destroy method performed here\n     */\n  };\n\n  return SmithchartLegend;\n}();\n\nexport { SmithchartLegend };","map":{"version":3,"names":["measureText","TextOption","renderTextElement","CircleOption","PathOption","RectOption","SmithchartRect","LegendSeries","legendRender","SmithchartLegend","legendSeries","prototype","renderLegend","smithchart","calculateLegendBounds","_drawLegend","legendActualBounds","padding","legend","legendSettings","legendSizeHeight","height","legendSizeWidth","width","itemPadding","position","toLowerCase","font","title","textStyle","legendItemWidth","legendItemHeight","legendHeight","svgObjectWidth","availableSize","elementSpacing","border","svgObjectHeight","rowCount","columnCount","titleSize","maxRowWidth","totalRowHeight","curRowWidth","curRowHeight","allowItems","itemsCountRow","length","series","legendBounds","visible","Math","ceil","i","push","text","seriesIndex","shape","fill","seriesColors","bounds","legendsize","_getLegendSize","max","x","y","symbolWidth","itemStyle","symbolHeight","textSize","shapePadding","legendPosition","alignment","maxWidth","startX","startY","titleFont","smithchartTitleHeight","smithchartSubtitleHeight","subtitle","offset","margin","top","legendBorder","legendWidth","legendTitleHeight","borderSize","svgWidth","svgHeight","location","gLegendEle","renderer","createGroup","element","id","svgObject","appendChild","legendItemGroup","currentX","currentY","drawLegendTitle","k","legendGroup","drawLegendItem","setAttribute","toString","drawLegendBorder","borderRect","drawRectangle","titleWidth","titleHeight","textAlignment","legendBoundsWidth","options","themeStyle","legendLabel","description","_this","radius","symbol","textHeight","sqrt","toggleVisibility","legendEventArgs","name","cancel","legendRenderSuccess","args","drawLegendShape","fontFamily","size","fontSize","bind","trigger","locX","locY","index","circleOptions","pathOptions","path","color","opacity","visibility","drawCircle","drawPath","eq","j","xValue","cos","PI","yValue","sin","concat","getModuleName","destroy"],"sources":["D:/Theme/package/node_modules/@syncfusion/ej2-charts/src/smithchart/legend/legendrender.js"],"sourcesContent":["import { measureText, TextOption, renderTextElement, CircleOption, PathOption, RectOption } from '../../smithchart/utils/helper';\nimport { SmithchartRect, LegendSeries } from '../../smithchart/utils/utils';\nimport { legendRender } from '../model/constant';\n/* tslint:disable:no-string-literal */\nvar SmithchartLegend = /** @class */ (function () {\n    function SmithchartLegend() {\n        this.legendSeries = [];\n    }\n    SmithchartLegend.prototype.renderLegend = function (smithchart) {\n        this.calculateLegendBounds(smithchart);\n        this._drawLegend(smithchart);\n        return this.legendActualBounds;\n    };\n    SmithchartLegend.prototype.calculateLegendBounds = function (smithchart) {\n        var legendSeries = new LegendSeries();\n        this.legendSeries = [];\n        var padding = 10;\n        var legend = smithchart.legendSettings;\n        var legendSizeHeight = legend.height;\n        var legendSizeWidth = legend.width;\n        var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n        var position = legend.position.toLowerCase();\n        var font = legend.title.textStyle;\n        var width = 0;\n        var height = 0;\n        var legendItemWidth = 0;\n        var legendItemHeight = 0;\n        var legendHeight = 0;\n        var svgObjectWidth = smithchart.availableSize.width - ((smithchart.elementSpacing * 4) - (legend.border.width * 2)\n            + (smithchart.border.width * 2));\n        var svgObjectHeight = smithchart.availableSize.height - ((smithchart.elementSpacing * 4) - (legend.border.width * 2)\n            + (smithchart.border.width * 2));\n        var rowCount = legend.rowCount;\n        var columnCount = legend.columnCount;\n        var titleSize = measureText(smithchart.legendSettings['title']['text'], font);\n        var maxRowWidth = 0;\n        var totalRowHeight = 0;\n        var curRowWidth = 0;\n        var curRowHeight = 0;\n        var allowItems;\n        var itemsCountRow = 0;\n        var length = smithchart.series.length;\n        var legendBounds;\n        if (smithchart.legendSettings.visible && length !== 0) {\n            if (position === 'bottom' || position === 'top' || position === 'custom') {\n                if ((rowCount && columnCount) && (rowCount <= columnCount)) {\n                    rowCount = length / columnCount;\n                }\n                else if (rowCount == null && columnCount != null) {\n                    rowCount = length / columnCount;\n                }\n                else if (rowCount == null && columnCount == null) {\n                    rowCount = 1;\n                }\n                if (rowCount) {\n                    allowItems = Math.ceil(length / rowCount);\n                }\n            }\n            else {\n                if ((rowCount && columnCount) && (rowCount <= columnCount)) {\n                    columnCount = length / rowCount;\n                }\n                else if (rowCount != null && columnCount == null) {\n                    columnCount = length / rowCount;\n                }\n                else if (rowCount == null && columnCount == null) {\n                    columnCount = 1;\n                }\n                if (columnCount) {\n                    allowItems = columnCount;\n                }\n            }\n            for (var i = 0; i < length; i++) {\n                this.legendSeries.push({\n                    text: smithchart.series[i]['name'] ? smithchart.series[i]['name'] : 'series' + i,\n                    seriesIndex: i,\n                    shape: smithchart.legendSettings.shape,\n                    fill: smithchart.series[i].fill || smithchart.seriesColors[i % smithchart.seriesColors.length],\n                    bounds: null\n                });\n                var legendsize = this._getLegendSize(smithchart, this.legendSeries[i]);\n                legendItemWidth = Math.max(legendsize['width'], legendItemWidth);\n                legendItemHeight = Math.max(legendsize['height'], legendItemHeight);\n                this.legendSeries[i]['bounds'] = { width: legendItemWidth, height: legendItemHeight };\n                itemsCountRow = itemsCountRow + 1;\n                curRowWidth = curRowWidth + legendItemWidth + itemPadding;\n                curRowHeight = Math.max(legendItemHeight, curRowHeight);\n                if (position === 'top' || position === 'bottom' || position === 'custom') {\n                    if (curRowWidth > svgObjectWidth) {\n                        curRowWidth -= legendsize.width + itemPadding;\n                        maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n                        curRowWidth = legendsize.width + itemPadding;\n                        totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n                    }\n                }\n                if (itemsCountRow === allowItems || i === length - 1) {\n                    maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n                    totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n                    legendHeight = totalRowHeight;\n                    itemsCountRow = 0;\n                    curRowHeight = 0;\n                    curRowWidth = 0;\n                }\n            }\n            width = (titleSize.width) > maxRowWidth - itemPadding ? (titleSize.width + padding * 2 + itemPadding) :\n                maxRowWidth + padding * 2 - (smithchart.border.width * 2);\n            height = legendHeight + smithchart.elementSpacing;\n            legendBounds = { x: 0, y: 0, width: width, height: height };\n        }\n        this.legendActualBounds = legendBounds;\n        if (legendSizeWidth != null) {\n            this.legendActualBounds.width = legendSizeWidth;\n        }\n        if (legendSizeHeight != null) {\n            this.legendActualBounds.height = legendSizeHeight;\n        }\n    };\n    SmithchartLegend.prototype._getLegendSize = function (smithchart, series) {\n        var legend = smithchart.legendSettings;\n        var symbolWidth = legend.itemStyle.width;\n        var symbolHeight = legend.itemStyle.height;\n        var textSize = measureText(series.text, legend.textStyle);\n        var width = symbolWidth + textSize.width + legend.shapePadding;\n        var height = Math.max(symbolHeight, textSize.height);\n        return { width: width, height: height };\n    };\n    // tslint:disable:max-func-body-length\n    SmithchartLegend.prototype._drawLegend = function (smithchart) {\n        var legend = smithchart.legendSettings;\n        var legendPosition = legend.position.toLowerCase();\n        var alignment = legend.alignment;\n        var legendBounds = this.legendActualBounds;\n        var maxWidth = 0;\n        var startX;\n        var startY;\n        var titleFont = smithchart.title.font ? smithchart.title.font : smithchart.title.textStyle;\n        var smithchartTitleHeight = measureText(smithchart.title.text, titleFont).height;\n        var smithchartSubtitleHeight = measureText(smithchart.title.subtitle.text, smithchart.title.subtitle.textStyle).height;\n        var elementSpacing = smithchart.elementSpacing;\n        var offset = smithchartTitleHeight + smithchartSubtitleHeight + elementSpacing + smithchart.margin.top;\n        var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n        var svgObjectWidth = smithchart.availableSize.width;\n        var svgObjectHeight = smithchart.availableSize.height;\n        var legendBorder = legend.border.width;\n        var legendWidth = 0;\n        var titleSize = measureText(legend['title']['text'], legend.title.textStyle);\n        var legendTitleHeight = titleSize.height;\n        var borderSize = smithchart.border.width;\n        var svgWidth = svgObjectWidth - ((borderSize * 2));\n        var svgHeight = svgObjectHeight - ((borderSize * 2));\n        legendBounds.height += legendTitleHeight;\n        if (legendPosition !== 'custom') {\n            switch (legendPosition) {\n                case 'bottom':\n                    legendBounds.y = svgHeight - (legendBounds.height + (legendBorder) + elementSpacing);\n                    break;\n                case 'top':\n                    legendBounds.y = borderSize + offset;\n                    break;\n                case 'right':\n                    legendBounds.x = svgWidth - legendBounds.width - (elementSpacing * 2);\n                    break;\n                case 'left':\n                    legendBounds.x = borderSize + (elementSpacing * 2);\n                    break;\n            }\n            if (legendPosition === 'left' || legendPosition === 'right') {\n                switch (alignment) {\n                    case 'Center':\n                        legendBounds.y = (svgHeight / 2) - ((legendBounds.height + legendBorder * 2) / 2) + (elementSpacing / 2);\n                        break;\n                    case 'Near':\n                        legendBounds.y = borderSize + (elementSpacing * 2) + offset;\n                        break;\n                    case 'Far':\n                        legendBounds.y = svgHeight - (legendBounds.height + (legendBorder)) - (elementSpacing * 2);\n                        break;\n                }\n            }\n            else {\n                switch (alignment) {\n                    case 'Center':\n                        legendBounds.x = (svgWidth / 2) - ((legendBounds.width + legendBorder * 2) / 2) + (elementSpacing / 2);\n                        break;\n                    case 'Near':\n                        legendBounds.x = borderSize + (elementSpacing * 2);\n                        break;\n                    case 'Far':\n                        legendBounds.x = svgWidth - (legendBounds.width + (legendBorder)) - (elementSpacing * 2);\n                        break;\n                }\n            }\n        }\n        else {\n            legendBounds.y = (legend.location.y < svgHeight) ? legend.location.y : 0;\n            legendBounds.x = (legend.location.x < svgWidth) ? legend.location.x : 0;\n        }\n        if (legendPosition === 'bottom' || legendPosition === 'top') {\n            for (var i = 0; i < this.legendSeries.length; i++) {\n                legendWidth += this.legendSeries[i].bounds.width + itemPadding;\n                if (legendWidth > svgWidth) {\n                    legendBounds.x = (svgWidth / 2) - ((legendBounds.width + legendBorder * 2) / 2) + (elementSpacing / 2);\n                    break;\n                }\n            }\n        }\n        var gLegendEle = smithchart.renderer.createGroup({ 'id': smithchart.element.id + '_legend_group' });\n        smithchart.svgObject.appendChild(gLegendEle);\n        this.legendItemGroup = smithchart.renderer.createGroup({ 'id': smithchart.element.id + 'legendItem_Group' });\n        var currentX = startX = elementSpacing;\n        var currentY = startY = elementSpacing;\n        if (legend.title.text !== '' && legend.title.visible) {\n            gLegendEle.appendChild(this.drawLegendTitle(smithchart, legend, legendBounds, gLegendEle));\n            currentY = startY = elementSpacing + legendTitleHeight;\n        }\n        for (var k = 0; k < this.legendSeries.length; k++) {\n            if ((legend.rowCount < legend.columnCount || legend.rowCount === legend.columnCount) &&\n                (legendPosition === 'top' || legendPosition === 'bottom' || legendPosition === 'custom')) {\n                if ((currentX + this.legendSeries[k]['bounds'].width) > legendBounds.width + startX) {\n                    currentX = elementSpacing;\n                    currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n                }\n                this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, currentX, (currentY), legendBounds);\n                gLegendEle.appendChild(this.legendGroup);\n                currentX += this.legendSeries[k]['bounds'].width + itemPadding;\n            }\n            else {\n                if (((currentY + this.legendSeries[k]['bounds'].height + itemPadding) +\n                    legendTitleHeight + borderSize > legendBounds.height + startY)) {\n                    currentY = startY;\n                    currentX += maxWidth + (itemPadding);\n                }\n                this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, (currentX), (currentY), legendBounds);\n                gLegendEle.appendChild(this.legendGroup);\n                currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n                maxWidth = Math.max(maxWidth, this.legendSeries[k]['bounds'].width);\n            }\n        }\n        gLegendEle.setAttribute('transform', 'translate(' + legendBounds.x.toString() + ',' + legendBounds.y.toString() + ')');\n        this.drawLegendBorder(gLegendEle, smithchart, legend, legendBounds);\n    };\n    SmithchartLegend.prototype.drawLegendBorder = function (gLegendEle, smithchart, legend, legendBounds) {\n        var borderRect = new RectOption(smithchart.element.id + '_svg' + '_legendRect', 'none', legend.border, 1, new SmithchartRect(0, 0, legendBounds.width, legendBounds.height));\n        gLegendEle.appendChild(smithchart.renderer.drawRectangle(borderRect));\n    };\n    SmithchartLegend.prototype.drawLegendTitle = function (smithchart, legend, legendBounds, gLegendEle) {\n        var elementSpacing = smithchart.elementSpacing;\n        var titleSize = measureText(legend.title.text, legend.title.textStyle);\n        var titleWidth = titleSize.width;\n        var titleHeight = titleSize.height;\n        var textAlignment = legend.title.textAlignment;\n        var startX = 0;\n        var legendBoundsWidth = legendBounds.width;\n        var startY = elementSpacing + (titleHeight / 2);\n        switch (textAlignment) {\n            case 'Far':\n                startX = legendBoundsWidth - titleWidth - startX;\n                break;\n            case 'Center':\n                startX = legendBoundsWidth / 2 - (titleWidth) / 2;\n                break;\n        }\n        if (startX < 0) {\n            startX = 0;\n            legendBoundsWidth = titleWidth;\n        }\n        if (legendBoundsWidth < titleWidth + startX) {\n            legendBoundsWidth = titleWidth + startX;\n        }\n        var options = new TextOption(smithchart.element.id + '_LegendTitleText', startX, startY, 'start', legend.title.text);\n        var element = renderTextElement(options, legend.title.textStyle, smithchart.themeStyle.legendLabel, gLegendEle);\n        element.setAttribute('aria-label', legend.title.description || legend.title.text);\n        return element;\n    };\n    SmithchartLegend.prototype.drawLegendItem = function (smithchart, legend, legendSeries, k, x, y, legendBounds) {\n        var _this = this;\n        var location;\n        var radius;\n        var symbol = legend.itemStyle;\n        var itemPadding = legend.itemPadding;\n        var textHeight;\n        radius = Math.sqrt(symbol['width'] * symbol['width'] + symbol['height'] * symbol['height']) / 2;\n        textHeight = measureText(legendSeries['text'], legend.textStyle).height;\n        location = {\n            x: x + symbol['width'] / 2,\n            y: (y + (textHeight > symbol['height'] ? textHeight : symbol['height']) / 2)\n        };\n        var legendGroup = smithchart.renderer.createGroup({ id: smithchart.element.id + '_svg' + '_Legend' + k.toString() });\n        legendGroup['style']['cursor'] = legend.toggleVisibility ? 'pointer' : 'default';\n        var legendEventArgs = {\n            text: legendSeries['text'],\n            fill: legendSeries['fill'],\n            shape: legendSeries['shape'],\n            name: legendRender,\n            cancel: false\n        };\n        var legendRenderSuccess = function (args) {\n            if (!args.cancel) {\n                var shape = _this.drawLegendShape(smithchart, legendSeries, location.x, location.y, k, legend, args);\n                legendGroup.appendChild(shape);\n                var options = new TextOption(smithchart.element.id + '_LegendItemText' + k.toString(), location.x + symbol['width'] / 2 + legend.shapePadding, location.y + textHeight / 4, 'start', args.text);\n                legend.textStyle.fontFamily = smithchart.themeStyle.fontFamily || legend.textStyle.fontFamily;\n                legend.textStyle.size = smithchart.themeStyle.fontSize || legend.textStyle.size;\n                var element = renderTextElement(options, legend.textStyle, smithchart.themeStyle.legendLabel, legendGroup);\n                element.setAttribute('aria-label', legend.description || 'Click to show or hide the ' + options.text + ' series');\n                legendGroup.appendChild(element);\n                _this.legendItemGroup.appendChild(legendGroup);\n            }\n        };\n        legendRenderSuccess.bind(this);\n        smithchart.trigger(legendRender, legendEventArgs, legendRenderSuccess);\n        return this.legendItemGroup;\n    };\n    SmithchartLegend.prototype.drawLegendShape = function (smithchart, legendSeries, locX, locY, index, legend, legendEventArgs) {\n        var element;\n        var circleOptions;\n        var pathOptions;\n        var path;\n        var symbol = legend.itemStyle;\n        var width = symbol['width'];\n        var height = symbol['height'];\n        var x = locX + (-width / 2);\n        var y = locY + (-height / 2);\n        var border = { color: symbol.border.color, width: symbol.border.width };\n        var opacity = 1;\n        var fill = (smithchart.series[index].visibility === 'visible') ? legendEventArgs.fill : 'grey';\n        var shape = legendEventArgs.shape.toLowerCase();\n        var radius = Math.sqrt(height * height + width * width) / 2;\n        switch (shape) {\n            case 'circle':\n                circleOptions = new CircleOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border, opacity, locX, locY, radius, null);\n                element = smithchart.renderer.drawCircle(circleOptions);\n                break;\n            case 'rectangle':\n                path = 'M' + ' ' + x + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + ((width / 2) + locX) + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + (locX + (width / 2)) + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + (locY + (-height / 2)) + ' z';\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n            case 'diamond':\n                path = 'M' + ' ' + x + ' ' + locY + ' ' +\n                    'L' + ' ' + locX + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + ((width / 2) + locX) + ' ' + locY + ' ' +\n                    'L' + ' ' + locX + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + locY + ' z';\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n            case 'pentagon':\n                var eq = 72;\n                for (var j = 0; j <= 5; j++) {\n                    var xValue = radius * Math.cos((Math.PI / 180) * (j * eq));\n                    var yValue = radius * Math.sin((Math.PI / 180) * (j * eq));\n                    if (j === 0) {\n                        path = 'M' + ' ' + (xValue + locX) + ' ' + (locY + yValue) + ' ';\n                    }\n                    else {\n                        path = path.concat('L' + ' ' + (locX + xValue) + ' ' + (locY + yValue) + ' ');\n                    }\n                }\n                path = path.concat('Z');\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n            case 'triangle':\n                path = 'M' + ' ' + x + ' ' + ((height / 2) + locY) + ' ' +\n                    'L' + ' ' + locX + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + (locX + (width / 2)) + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + (locY + (height / 2)) + ' Z';\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n        }\n        return element;\n    };\n    /**\n     * Get module name.\n     */\n    SmithchartLegend.prototype.getModuleName = function () {\n        return 'SmithchartLegend';\n    };\n    /**\n     * To destroy the legend.\n     * @return {void}\n     * @private\n     */\n    SmithchartLegend.prototype.destroy = function (smithchart) {\n        /**\n         * Destroy method performed here\n         */\n    };\n    return SmithchartLegend;\n}());\nexport { SmithchartLegend };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}