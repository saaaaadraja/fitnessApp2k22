{"ast":null,"code":"/**\n * MaskedTextBox base module\n */\nimport { EventHandler, isNullOrUndefined, merge, attributes, addClass, removeClass, Browser, extend } from '@syncfusion/ej2-base';\nimport { Input } from '../../input/input';\nvar ERROR = 'e-error';\nvar INPUTGROUP = 'e-input-group';\nvar FLOATINPUT = 'e-float-input';\nvar UTILMASK = 'e-utility-mask';\nvar TOPLABEL = 'e-label-top';\nvar BOTTOMLABEL = 'e-label-bottom';\n/**\n * @hidden\n * Built-in masking elements collection.\n */\n\nexport var regularExpressions = {\n  '0': '[0-9]',\n  '9': '[0-9 ]',\n  '#': '[0-9 +-]',\n  'L': '[A-Za-z]',\n  '?': '[A-Za-z ]',\n  '&': '[^\\x7f ]+',\n  'C': '[^\\x7f]+',\n  'A': '[A-Za-z0-9]',\n  'a': '[A-Za-z0-9 ]'\n};\n/**\n * @hidden\n * Generate required masking elements to the MaskedTextBox from user mask input.\n */\n\nexport function createMask() {\n  attributes(this.element, {\n    'role': 'textbox',\n    'autocomplete': 'off',\n    'autocorrect': 'off',\n    'autocapitalize': 'off',\n    'spellcheck': 'false',\n    'aria-live': 'assertive',\n    'aria-valuenow': ''\n  });\n\n  if (this.mask) {\n    var splitMask = this.mask.split(']');\n\n    for (var i = 0; i < splitMask.length; i++) {\n      if (splitMask[i][splitMask[i].length - 1] === '\\\\') {\n        splitMask[i] = splitMask[i] + ']';\n        var splitInnerMask = splitMask[i].split('[');\n\n        for (var j = 0; j < splitInnerMask.length; j++) {\n          if (splitInnerMask[j][splitInnerMask[j].length - 1] === '\\\\') {\n            splitInnerMask[j] = splitInnerMask[j] + '[';\n          }\n\n          pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n        }\n      } else {\n        var splitInnerMask = splitMask[i].split('[');\n\n        if (splitInnerMask.length > 1) {\n          var chkSpace = false;\n\n          for (var j = 0; j < splitInnerMask.length; j++) {\n            if (splitInnerMask[j] === '\\\\') {\n              this.customRegExpCollec.push('[');\n              this.hiddenMask += splitInnerMask[j] + '[';\n            } else if (splitInnerMask[j] === '') {\n              chkSpace = true;\n            } else if (splitInnerMask[j] !== '' && chkSpace || j === splitInnerMask.length - 1) {\n              this.customRegExpCollec.push('[' + splitInnerMask[j] + ']');\n              this.hiddenMask += this.promptChar;\n              chkSpace = false;\n            } else {\n              pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n            }\n          }\n        } else {\n          pushIntoRegExpCollec.call(this, splitInnerMask[0]);\n        }\n      }\n    }\n\n    this.escapeMaskValue = this.hiddenMask;\n    this.promptMask = this.hiddenMask.replace(/[09?LCAa#&]/g, this.promptChar);\n\n    if (!isNullOrUndefined(this.customCharacters)) {\n      for (var i = 0; i < this.promptMask.length; i++) {\n        if (!isNullOrUndefined(this.customCharacters[this.promptMask[i]])) {\n          this.promptMask = this.promptMask.replace(new RegExp(this.promptMask[i], 'g'), this.promptChar);\n        }\n      }\n    }\n\n    var escapeNumber = 0;\n\n    if (this.hiddenMask.match(new RegExp(/\\\\/))) {\n      for (var i = 0; i < this.hiddenMask.length; i++) {\n        var j = 0;\n\n        if (i >= 1) {\n          j = i;\n        }\n\n        escapeNumber = this.hiddenMask.length - this.promptMask.length;\n        j = j - escapeNumber;\n\n        if (i > 0 && this.hiddenMask[i - 1] !== '\\\\' && (this.hiddenMask[i] === '>' || this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|')) {\n          this.promptMask = this.promptMask.substring(0, j) + this.promptMask.substring(i + 1 - escapeNumber, this.promptMask.length);\n          this.escapeMaskValue = this.escapeMaskValue.substring(0, j) + this.escapeMaskValue.substring(i + 1 - escapeNumber, this.escapeMaskValue.length);\n        }\n\n        if (this.hiddenMask[i] === '\\\\') {\n          this.promptMask = this.promptMask.substring(0, j) + this.hiddenMask[i + 1] + this.promptMask.substring(i + 2 - escapeNumber, this.promptMask.length);\n          this.escapeMaskValue = this.escapeMaskValue.substring(0, j) + this.escapeMaskValue[i + 1] + this.escapeMaskValue.substring(i + 2 - escapeNumber, this.escapeMaskValue.length);\n        }\n      }\n    } else {\n      this.promptMask = this.promptMask.replace(/[>|<]/g, '');\n      this.escapeMaskValue = this.hiddenMask.replace(/[>|<]/g, '');\n    }\n\n    attributes(this.element, {\n      'aria-invalid': 'false'\n    });\n  }\n}\n/**\n * @hidden\n * Apply mask ability with masking elements to the MaskedTextBox.\n */\n\nexport function applyMask() {\n  setElementValue.call(this, this.promptMask);\n  setMaskValue.call(this, this.value);\n}\n/**\n * @hidden\n * To wire required events to the MaskedTextBox.\n */\n\nexport function wireEvents() {\n  EventHandler.add(this.element, 'keydown', maskInputKeyDownHandler, this);\n  EventHandler.add(this.element, 'keypress', maskInputKeyPressHandler, this);\n  EventHandler.add(this.element, 'keyup', maskInputKeyUpHandler, this);\n  EventHandler.add(this.element, 'input', maskInputHandler, this);\n  EventHandler.add(this.element, 'focus', maskInputFocusHandler, this);\n  EventHandler.add(this.element, 'blur', maskInputBlurHandler, this);\n  EventHandler.add(this.element, 'paste', maskInputPasteHandler, this);\n  EventHandler.add(this.element, 'cut', maskInputCutHandler, this);\n  EventHandler.add(this.element, 'drop', maskInputDropHandler, this);\n\n  if (this.enabled) {\n    bindClearEvent.call(this);\n\n    if (this.formElement) {\n      EventHandler.add(this.formElement, 'reset', resetFormHandler, this);\n    }\n  }\n}\n/**\n * @hidden\n * To unwire events attached to the MaskedTextBox.\n */\n\nexport function unwireEvents() {\n  EventHandler.remove(this.element, 'keydown', maskInputKeyDownHandler);\n  EventHandler.remove(this.element, 'keypress', maskInputKeyPressHandler);\n  EventHandler.remove(this.element, 'keyup', maskInputKeyUpHandler);\n  EventHandler.remove(this.element, 'input', maskInputHandler);\n  EventHandler.remove(this.element, 'focus', maskInputFocusHandler);\n  EventHandler.remove(this.element, 'blur', maskInputBlurHandler);\n  EventHandler.remove(this.element, 'paste', maskInputPasteHandler);\n  EventHandler.remove(this.element, 'cut', maskInputCutHandler);\n\n  if (this.formElement) {\n    EventHandler.remove(this.formElement, 'reset', resetFormHandler);\n  }\n}\n/**\n * @hidden\n * To bind required events to the MaskedTextBox clearButton.\n */\n\nexport function bindClearEvent() {\n  if (this.showClearButton) {\n    EventHandler.add(this.inputObj.clearButton, 'mousedown touchstart', resetHandler, this);\n  }\n}\n\nfunction resetHandler(e) {\n  e.preventDefault();\n\n  if (!this.inputObj.clearButton.classList.contains('e-clear-icon-hide')) {\n    clear.call(this, e);\n    this.value = '';\n  }\n}\n\nfunction clear(event) {\n  var value = this.element.value;\n  setElementValue.call(this, this.promptMask);\n  this.redoCollec.unshift({\n    value: this.promptMask,\n    startIndex: this.element.selectionStart,\n    endIndex: this.element.selectionEnd\n  });\n  triggerMaskChangeEvent.call(this, event, value);\n  this.element.setSelectionRange(0, 0);\n}\n\nfunction resetFormHandler() {\n  if (this.element.tagName === 'EJS-MASKEDTEXTBOX') {\n    setElementValue.call(this, this.promptMask);\n  } else {\n    this.value = this.initInputValue;\n  }\n}\n/**\n * @hidden\n * To get masked value from the MaskedTextBox.\n */\n\n\nexport function unstrippedValue(element) {\n  return element.value;\n}\n/**\n * @hidden\n * To extract raw value from the MaskedTextBox.\n */\n\nexport function strippedValue(element, maskValues) {\n  var value = '';\n  var k = 0;\n  var checkMask = false;\n  var maskValue = !isNullOrUndefined(maskValues) ? maskValues : !isNullOrUndefined(element) && !isNullOrUndefined(this) ? element.value : maskValues;\n\n  if (maskValue !== this.promptMask) {\n    for (var i = 0; i < this.customRegExpCollec.length; i++) {\n      if (checkMask) {\n        checkMask = false;\n      }\n\n      if (this.customRegExpCollec[k] === '>' || this.customRegExpCollec[k] === '<' || this.customRegExpCollec[k] === '|' || this.customRegExpCollec[k] === '\\\\') {\n        --i;\n        checkMask = true;\n      }\n\n      if (!checkMask) {\n        if (maskValue[i] !== this.promptChar && !isNullOrUndefined(this.customRegExpCollec[k]) && (this._callPasteHandler || !isNullOrUndefined(this.regExpCollec[this.customRegExpCollec[k]]) || this.customRegExpCollec[k].length > 2 && this.customRegExpCollec[k][0] === '[' && this.customRegExpCollec[k][this.customRegExpCollec[k].length - 1] === ']' || !isNullOrUndefined(this.customCharacters) && !isNullOrUndefined(this.customCharacters[this.customRegExpCollec[k]])) && maskValue !== '') {\n          value += maskValue[i];\n        }\n      }\n\n      ++k;\n    }\n  }\n\n  if (this.mask === null || this.mask === '' && this.value !== undefined) {\n    value = maskValue;\n  }\n\n  return value;\n}\n\nfunction pushIntoRegExpCollec(value) {\n  for (var k = 0; k < value.length; k++) {\n    this.hiddenMask += value[k];\n\n    if (value[k] !== '\\\\') {\n      this.customRegExpCollec.push(value[k]);\n    }\n  }\n}\n\nexport function maskInputFocusHandler(event) {\n  var _this = this;\n\n  var eventArgs = {\n    selectionStart: 0,\n    event: event,\n    value: this.value,\n    maskedValue: this.element.value,\n    container: this.inputObj.container,\n    selectionEnd: this.promptMask.length > 0 ? this.promptMask.length : this.element.value.length\n  };\n  this.trigger('focus', eventArgs, function (eventArgs) {\n    if (_this.mask) {\n      _this.isFocus = true;\n\n      if (_this.element.value === '') {\n        setElementValue.call(_this, _this.promptMask);\n      } else {\n        setElementValue.call(_this, _this.element.value);\n      }\n\n      if (!Browser.isDevice && Browser.info.version === '11.0') {\n        _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n      } else {\n        var delay = Browser.isDevice && Browser.isIos ? 450 : 0;\n        setTimeout(function () {\n          _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n        }, delay);\n      }\n    }\n  });\n}\nexport function maskInputBlurHandler(event) {\n  this.blurEventArgs = {\n    event: event,\n    value: this.value,\n    maskedValue: this.element.value,\n    container: this.inputObj.container\n  };\n  this.trigger('blur', this.blurEventArgs);\n\n  if (this.mask) {\n    this.isFocus = false;\n\n    if (this.placeholder && this.element.value === this.promptMask && this.floatLabelType !== 'Always') {\n      setElementValue.call(this, '');\n      var labelElement = this.element.parentNode.querySelector('.e-float-text');\n\n      if (this.floatLabelType === 'Auto' && !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL)) {\n        removeClass([labelElement], TOPLABEL);\n      }\n    }\n  }\n}\n\nfunction maskInputPasteHandler(event) {\n  var _this = this;\n\n  if (this.mask && !this.readonly) {\n    var sIndex_1 = this.element.selectionStart;\n    var eIndex_1 = this.element.selectionEnd;\n    var oldValue_1 = this.element.value;\n    setElementValue.call(this, '');\n    this._callPasteHandler = true;\n    setTimeout(function () {\n      var value = _this.element.value.replace(/ /g, '');\n\n      if (_this.redoCollec.length > 0 && _this.redoCollec[0].value === _this.element.value) {\n        value = strippedValue.call(_this, _this.element);\n      }\n\n      setElementValue.call(_this, oldValue_1);\n      _this.element.selectionStart = sIndex_1;\n      _this.element.selectionEnd = eIndex_1;\n      var i = 0;\n      _this.maskKeyPress = true;\n\n      do {\n        validateValue.call(_this, value[i], false, null);\n        ++i;\n      } while (i < value.length);\n\n      _this.maskKeyPress = false;\n      _this._callPasteHandler = false;\n\n      if (_this.element.value === oldValue_1) {\n        var i_1 = 0;\n        _this.maskKeyPress = true;\n\n        do {\n          validateValue.call(_this, value[i_1], false, null);\n          ++i_1;\n        } while (i_1 < value.length);\n\n        _this.maskKeyPress = false;\n      } else {\n        triggerMaskChangeEvent.call(_this, event, oldValue_1);\n      }\n    }, 1);\n  }\n}\n\nfunction maskInputCutHandler(event) {\n  var _this = this;\n\n  if (this.mask && !this.readonly) {\n    var preValue_1 = this.element.value;\n    var sIndex_2 = this.element.selectionStart;\n    var eIndex = this.element.selectionEnd;\n    this.undoCollec.push({\n      value: this.element.value,\n      startIndex: this.element.selectionStart,\n      endIndex: this.element.selectionEnd\n    });\n    var value_1 = this.element.value.substring(0, sIndex_2) + this.promptMask.substring(sIndex_2, eIndex) + this.element.value.substring(eIndex);\n    setTimeout(function () {\n      setElementValue.call(_this, value_1);\n      _this.element.selectionStart = _this.element.selectionEnd = sIndex_2;\n\n      if (_this.element.value !== preValue_1) {\n        triggerMaskChangeEvent.call(_this, event, null);\n      }\n    }, 0);\n  }\n}\n\nexport function maskInputDropHandler(event) {\n  event.preventDefault();\n}\n\nfunction maskInputHandler(event) {\n  if (Browser.isIE === true && this.element.value === '' && this.floatLabelType === 'Never') {\n    return;\n  }\n\n  var eventArgs = {\n    ctrlKey: false,\n    keyCode: 229\n  }; // tslint:disable-next-line\n\n  extend(event, eventArgs);\n\n  if (this.mask) {\n    if (this.element.value === '') {\n      this.redoCollec.unshift({\n        value: this.promptMask,\n        startIndex: this.element.selectionStart,\n        endIndex: this.element.selectionEnd\n      });\n    }\n\n    if (this.element.value.length === 1) {\n      this.element.value = this.element.value + this.promptMask;\n      this.element.setSelectionRange(1, 1);\n    }\n\n    if (!this._callPasteHandler) {\n      removeMaskInputValues.call(this, event);\n    }\n\n    if (this.element.value.length > this.promptMask.length) {\n      var startIndex = this.element.selectionStart;\n      var addedValues = this.element.value.length - this.promptMask.length;\n      var value = this.element.value.substring(startIndex - addedValues, startIndex);\n      this.maskKeyPress = false;\n      var i = 0;\n\n      do {\n        validateValue.call(this, value[i], event.ctrlKey, event);\n        ++i;\n      } while (i < value.length);\n\n      if (this.element.value !== this.preEleVal) {\n        triggerMaskChangeEvent.call(this, event, null);\n      }\n    }\n\n    var val = strippedValue.call(this, this.element);\n    this.prevValue = val;\n    this.value = val;\n\n    if (val === '') {\n      setElementValue.call(this, this.promptMask);\n      this.element.setSelectionRange(0, 0);\n    }\n  }\n}\n\nfunction maskInputKeyDownHandler(event) {\n  if (this.mask && !this.readonly) {\n    var value = this;\n\n    if (event.keyCode !== 229) {\n      if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n        event.preventDefault();\n      }\n\n      removeMaskInputValues.call(this, event);\n    }\n\n    var startValue = this.element.value;\n\n    if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n      var collec = void 0;\n\n      if (event.keyCode === 90 && this.undoCollec.length > 0 && startValue !== this.undoCollec[this.undoCollec.length - 1].value) {\n        collec = this.undoCollec[this.undoCollec.length - 1];\n        this.redoCollec.unshift({\n          value: this.element.value,\n          startIndex: this.element.selectionStart,\n          endIndex: this.element.selectionEnd\n        });\n        setElementValue.call(this, collec.value);\n        this.element.selectionStart = collec.startIndex;\n        this.element.selectionEnd = collec.endIndex;\n        this.undoCollec.splice(this.undoCollec.length - 1, 1);\n      } else if (event.keyCode === 89 && this.redoCollec.length > 0 && startValue !== this.redoCollec[0].value) {\n        collec = this.redoCollec[0];\n        this.undoCollec.push({\n          value: this.element.value,\n          startIndex: this.element.selectionStart,\n          endIndex: this.element.selectionEnd\n        });\n        setElementValue.call(this, collec.value);\n        this.element.selectionStart = collec.startIndex;\n        this.element.selectionEnd = collec.endIndex;\n        this.redoCollec.splice(0, 1);\n      }\n    }\n  }\n}\n\nexport function mobileRemoveFunction() {\n  var collec;\n  var sIndex = this.element.selectionStart;\n  var eIndex = this.element.selectionEnd;\n\n  if (this.redoCollec.length > 0) {\n    collec = this.redoCollec[0];\n    setElementValue.call(this, collec.value);\n\n    if (collec.startIndex - sIndex === 1) {\n      this.element.selectionStart = collec.startIndex;\n      this.element.selectionEnd = collec.endIndex;\n    } else {\n      this.element.selectionStart = sIndex + 1;\n      this.element.selectionEnd = eIndex + 1;\n    }\n  } else {\n    setElementValue.call(this, this.promptMask);\n    this.element.selectionStart = this.element.selectionEnd = sIndex;\n  }\n}\n\nfunction autoFillMaskInputValues(isRemove, oldEventVal, event) {\n  if (event.type === 'input') {\n    isRemove = false;\n    oldEventVal = this.element.value;\n    setElementValue.call(this, this.promptMask);\n    setMaskValue.call(this, oldEventVal);\n  }\n\n  return isRemove;\n}\n\nfunction removeMaskInputValues(event) {\n  var isRemove = false;\n  var oldEventVal;\n  var isDeleted = false;\n\n  if (this.element.value.length < this.promptMask.length) {\n    isRemove = true;\n    oldEventVal = this.element.value;\n    isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n    mobileRemoveFunction.call(this);\n  }\n\n  if (this.element.value.length >= this.promptMask.length && event.type === 'input') {\n    isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n  }\n\n  var initStartIndex = this.element.selectionStart;\n  var initEndIndex = this.element.selectionEnd;\n  var startIndex = this.element.selectionStart;\n  var endIndex = this.element.selectionEnd;\n  var maskValue = this.hiddenMask.replace(/[>|\\\\<]/g, '');\n  var curMask = maskValue[startIndex - 1];\n  var parentElement = this.element.parentNode;\n  var deleteEndIndex = this.element.selectionEnd;\n\n  if (isRemove || event.keyCode === 8 || event.keyCode === 46) {\n    this.undoCollec.push({\n      value: this.element.value,\n      startIndex: this.element.selectionStart,\n      endIndex: endIndex\n    });\n    var multipleDel = false;\n    var preValue = this.element.value;\n\n    if (startIndex > 0 || (event.keyCode === 8 || event.keyCode === 46) && startIndex < this.element.value.length && this.element.selectionEnd - startIndex !== this.element.value.length) {\n      var index = startIndex;\n\n      if (startIndex !== endIndex) {\n        startIndex = endIndex;\n\n        if (event.keyCode === 46) {\n          multipleDel = true;\n        }\n      } else if (event.keyCode === 46) {\n        ++index;\n      } else {\n        --index;\n      }\n\n      for (var k = startIndex; event.keyCode === 8 || isRemove || multipleDel ? k > index : k < index; event.keyCode === 8 || isRemove || multipleDel ? k-- : k++) {\n        for (var i = startIndex; event.keyCode === 8 || isRemove || multipleDel ? i > 0 : i < this.element.value.length; event.keyCode === 8 || isRemove || multipleDel ? i-- : i++) {\n          var sIndex = void 0;\n\n          if ((event.keyCode === 8 || multipleDel) && (initStartIndex !== initEndIndex && initStartIndex !== startIndex || initStartIndex === initEndIndex) || isRemove) {\n            curMask = maskValue[i - 1];\n            sIndex = startIndex - 1;\n          } else {\n            curMask = maskValue[i];\n            sIndex = startIndex;\n            ++startIndex;\n          }\n\n          var oldValue = this.element.value[sIndex];\n\n          if (isNullOrUndefined(this.regExpCollec[curMask]) && !isNullOrUndefined(this.customCharacters) && isNullOrUndefined(this.customCharacters[curMask]) && this.hiddenMask[sIndex] !== this.promptChar && this.customRegExpCollec[sIndex][0] !== '[' && this.customRegExpCollec[sIndex][this.customRegExpCollec[sIndex].length - 1] !== ']' || this.promptMask[sIndex] !== this.promptChar && isNullOrUndefined(this.customCharacters)) {\n            this.element.selectionStart = this.element.selectionEnd = sIndex;\n            event.preventDefault();\n\n            if (event.keyCode === 46 && !multipleDel) {\n              ++this.element.selectionStart;\n            }\n          } else {\n            var value = this.element.value;\n            var prompt_1 = this.promptChar;\n            var elementValue = value.substring(0, sIndex) + prompt_1 + value.substring(startIndex, value.length);\n            setElementValue.call(this, elementValue);\n            event.preventDefault();\n\n            if (event.keyCode === 46 && !multipleDel) {\n              sIndex++;\n            }\n\n            this.element.selectionStart = this.element.selectionEnd = sIndex;\n            isDeleted = true;\n          }\n\n          startIndex = this.element.selectionStart;\n\n          if (!isDeleted && event.keyCode === 8 || multipleDel || !isDeleted && !(event.keyCode === 46)) {\n            sIndex = startIndex - 1;\n          } else {\n            sIndex = startIndex;\n            isDeleted = false;\n          }\n\n          oldValue = this.element.value[sIndex];\n\n          if (initStartIndex !== initEndIndex && this.element.selectionStart === initStartIndex || this.promptMask[sIndex] === this.promptChar || oldValue !== this.promptMask[sIndex] && this.promptMask[sIndex] !== this.promptChar && !isNullOrUndefined(this.customCharacters)) {\n            break;\n          }\n        }\n      }\n    }\n\n    if (event.keyCode === 46 && multipleDel && isDeleted) {\n      this.element.selectionStart = this.element.selectionEnd = deleteEndIndex;\n    }\n\n    if (this.element.selectionStart === 0 && this.element.selectionEnd === this.element.value.length) {\n      setElementValue.call(this, this.promptMask);\n      event.preventDefault();\n      this.element.selectionStart = this.element.selectionEnd = startIndex;\n    }\n\n    this.redoCollec.unshift({\n      value: this.element.value,\n      startIndex: this.element.selectionStart,\n      endIndex: this.element.selectionEnd\n    });\n\n    if (this.element.value !== preValue) {\n      triggerMaskChangeEvent.call(this, event, oldEventVal);\n    }\n  }\n}\n\nfunction maskInputKeyPressHandler(event) {\n  if (this.mask && !this.readonly) {\n    var oldValue = this.element.value;\n\n    if (!event.ctrlKey || event.ctrlKey && event.code !== 'KeyA' && event.code !== 'KeyY' && event.code !== 'KeyZ' && event.code !== 'KeyX' && event.code !== 'KeyC' && event.code !== 'KeyV') {\n      this.maskKeyPress = true;\n      var key = event.key;\n\n      if (key === 'Spacebar') {\n        key = String.fromCharCode(event.keyCode);\n      }\n\n      if (!key) {\n        this.isIosInvalid = true;\n        validateValue.call(this, String.fromCharCode(event.keyCode), event.ctrlKey, event);\n        event.preventDefault();\n        this.isIosInvalid = false;\n      } else if (key && key.length === 1) {\n        validateValue.call(this, key, event.ctrlKey, event);\n        event.preventDefault();\n      }\n\n      if (event.keyCode === 32 && key === ' ' && this.promptChar === ' ') {\n        this.element.selectionStart = this.element.selectionEnd = this.element.selectionStart - key.length;\n      }\n    }\n\n    if (this.element.value !== oldValue) {\n      triggerMaskChangeEvent.call(this, event, oldValue);\n    }\n  }\n}\n\nfunction triggerMaskChangeEvent(event, oldValue) {\n  var prevOnChange = this.isProtectedOnChange;\n\n  if (!isNullOrUndefined(this.changeEventArgs) && !this.isInitial) {\n    var eventArgs = {};\n    this.changeEventArgs = {\n      value: this.element.value,\n      maskedValue: this.element.value,\n      isInteraction: false,\n      isInteracted: false\n    };\n\n    if (this.mask) {\n      this.changeEventArgs.value = strippedValue.call(this, this.element);\n    }\n\n    if (!isNullOrUndefined(event)) {\n      this.changeEventArgs.isInteracted = true;\n      this.changeEventArgs.isInteraction = true;\n      this.changeEventArgs.event = event;\n    }\n\n    this.isProtectedOnChange = true;\n    this.value = this.changeEventArgs.value;\n    this.isProtectedOnChange = prevOnChange;\n    merge(eventArgs, this.changeEventArgs);\n    /* istanbul ignore next */\n\n    if (this.isAngular && this.preventChange) {\n      this.preventChange = false;\n    } else {\n      this.trigger('change', eventArgs);\n    }\n  }\n\n  this.preEleVal = this.element.value;\n  this.prevValue = strippedValue.call(this, this.element);\n  attributes(this.element, {\n    'aria-valuenow': this.element.value\n  });\n}\n\nfunction maskInputKeyUpHandler(event) {\n  if (this.mask && !this.readonly) {\n    var collec = void 0;\n\n    if (!this.maskKeyPress && event.keyCode === 229) {\n      var oldEventVal = void 0;\n\n      if (this.element.value.length === 1) {\n        this.element.value = this.element.value + this.promptMask;\n        this.element.setSelectionRange(1, 1);\n      }\n\n      if (this.element.value.length > this.promptMask.length) {\n        var startIndex = this.element.selectionStart;\n        var addedValues = this.element.value.length - this.promptMask.length;\n        var val_1 = this.element.value.substring(startIndex - addedValues, startIndex);\n\n        if (this.undoCollec.length > 0) {\n          collec = this.undoCollec[this.undoCollec.length - 1];\n          var startIndex_1 = this.element.selectionStart;\n          oldEventVal = collec.value;\n          var oldVal = collec.value.substring(startIndex_1 - addedValues, startIndex_1);\n          collec = this.redoCollec[0];\n          val_1 = val_1.trim();\n          var isSpace = Browser.isAndroid && val_1 === '';\n\n          if (!isSpace && oldVal !== val_1 && collec.value.substring(startIndex_1 - addedValues, startIndex_1) !== val_1) {\n            validateValue.call(this, val_1, event.ctrlKey, event);\n          } else if (isSpace) {\n            preventUnsupportedValues.call(this, event, startIndex_1 - 1, this.element.selectionEnd - 1, val_1, event.ctrlKey, false);\n          }\n        } else {\n          oldEventVal = this.promptMask;\n          validateValue.call(this, val_1, event.ctrlKey, event);\n        }\n\n        this.maskKeyPress = false;\n        triggerMaskChangeEvent.call(this, event, oldEventVal);\n      }\n    } else {\n      removeMaskError.call(this);\n    }\n\n    var val = strippedValue.call(this, this.element);\n\n    if (!(this.element.selectionStart === 0 && this.promptMask === this.element.value && val === '') || val === '' && this.value !== val) {\n      this.prevValue = val;\n      this.value = val;\n    }\n  } else {\n    triggerMaskChangeEvent.call(this, event);\n  }\n\n  if (this.element.selectionStart === 0 && this.element.selectionEnd === 0) {\n    // tslint:disable-next-line\n    var temp_1 = this.element;\n    setTimeout(function () {\n      temp_1.setSelectionRange(0, 0);\n    }, 0);\n  }\n}\n\nfunction mobileSwipeCheck(key) {\n  if (key.length > 1 && this.promptMask.length + key.length < this.element.value.length) {\n    var elementValue = this.redoCollec[0].value.substring(0, this.redoCollec[0].startIndex) + key + this.redoCollec[0].value.substring(this.redoCollec[0].startIndex, this.redoCollec[0].value.length);\n    setElementValue.call(this, elementValue);\n    this.element.selectionStart = this.element.selectionEnd = this.redoCollec[0].startIndex + key.length;\n  }\n\n  this.element.selectionStart = this.element.selectionStart - key.length;\n  this.element.selectionEnd = this.element.selectionEnd - key.length;\n}\n\nfunction mobileValidation(key) {\n  if (!this.maskKeyPress) {\n    mobileSwipeCheck.call(this, key);\n  }\n}\n\nfunction validateValue(key, isCtrlKey, event) {\n  mobileValidation.call(this, key);\n\n  if (isNullOrUndefined(this) || isNullOrUndefined(key)) {\n    return;\n  }\n\n  var startIndex = this.element.selectionStart;\n  var initStartIndex = startIndex;\n  var endIndex = this.element.selectionEnd;\n  var curMask;\n  var allowText = false;\n  var value = this.element.value;\n  var eventOldVal;\n  var prevSupport = false;\n  var isEqualVal = false;\n\n  for (var k = 0; k < key.length; k++) {\n    var keyValue = key[k];\n    startIndex = this.element.selectionStart;\n    endIndex = this.element.selectionEnd;\n\n    if (!this.maskKeyPress && initStartIndex === startIndex) {\n      startIndex = startIndex + k;\n    }\n\n    if (!this.maskKeyPress || startIndex < this.promptMask.length) {\n      for (var i = startIndex; i < this.promptMask.length; i++) {\n        var maskValue = this.escapeMaskValue;\n        curMask = maskValue[startIndex];\n\n        if (this.hiddenMask[startIndex] === '\\\\' && this.hiddenMask[startIndex + 1] === key) {\n          isEqualVal = true;\n        }\n\n        if (isNullOrUndefined(this.regExpCollec[curMask]) && (isNullOrUndefined(this.customCharacters) || !isNullOrUndefined(this.customCharacters) && isNullOrUndefined(this.customCharacters[curMask])) && this.hiddenMask[startIndex] !== this.promptChar && this.customRegExpCollec[startIndex][0] !== '[' && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] !== ']' || this.promptMask[startIndex] !== this.promptChar && isNullOrUndefined(this.customCharacters) || this.promptChar === curMask && this.escapeMaskValue === this.mask) {\n          this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n          startIndex = this.element.selectionStart;\n          curMask = this.hiddenMask[startIndex];\n        }\n      }\n\n      if (!isNullOrUndefined(this.customCharacters) && !isNullOrUndefined(this.customCharacters[curMask])) {\n        var customValStr = this.customCharacters[curMask];\n        var customValArr = customValStr.split(',');\n\n        for (var i = 0; i < customValArr.length; i++) {\n          if (keyValue.match(new RegExp('[' + customValArr[i] + ']'))) {\n            allowText = true;\n            break;\n          }\n        }\n      } else if (!isNullOrUndefined(this.regExpCollec[curMask]) && keyValue.match(new RegExp(this.regExpCollec[curMask])) && this.promptMask[startIndex] === this.promptChar) {\n        allowText = true;\n      } else if (this.promptMask[startIndex] === this.promptChar && this.customRegExpCollec[startIndex][0] === '[' && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] === ']' && keyValue.match(new RegExp(this.customRegExpCollec[startIndex]))) {\n        allowText = true;\n      }\n\n      if ((!this.maskKeyPress || startIndex < this.hiddenMask.length) && allowText) {\n        if (k === 0) {\n          if (this.maskKeyPress) {\n            this.undoCollec.push({\n              value: value,\n              startIndex: startIndex,\n              endIndex: startIndex\n            });\n          } else {\n            var sIndex = this.element.selectionStart;\n            var eIndex = this.element.selectionEnd;\n\n            if (this.redoCollec.length > 0) {\n              eventOldVal = this.redoCollec[0].value;\n              setElementValue.call(this, eventOldVal);\n              this.undoCollec.push(this.redoCollec[0]);\n            } else {\n              this.undoCollec.push({\n                value: this.promptMask,\n                startIndex: startIndex,\n                endIndex: startIndex\n              });\n              eventOldVal = this.promptMask;\n              setElementValue.call(this, eventOldVal);\n            }\n\n            this.element.selectionStart = sIndex;\n            this.element.selectionEnd = eIndex;\n          }\n        }\n\n        startIndex = this.element.selectionStart;\n        applySupportedValues.call(this, event, startIndex, keyValue, eventOldVal, isEqualVal);\n        prevSupport = true;\n\n        if (k === key.length - 1) {\n          this.redoCollec.unshift({\n            value: this.element.value,\n            startIndex: this.element.selectionStart,\n            endIndex: this.element.selectionEnd\n          });\n        }\n\n        allowText = false;\n      } else {\n        startIndex = this.element.selectionStart;\n        preventUnsupportedValues.call(this, event, startIndex, initStartIndex, key, isCtrlKey, prevSupport);\n      }\n\n      if (k === key.length - 1 && !allowText) {\n        if (!Browser.isAndroid || Browser.isAndroid && startIndex < this.promptMask.length) {\n          this.redoCollec.unshift({\n            value: this.element.value,\n            startIndex: this.element.selectionStart,\n            endIndex: this.element.selectionEnd\n          });\n        }\n      }\n    } else {\n      if (key.length === 1 && !isCtrlKey && !isNullOrUndefined(event)) {\n        addMaskErrorClass.call(this);\n      }\n    }\n  }\n}\n\nfunction applySupportedValues(event, startIndex, keyValue, eventOldVal, isEqualVal) {\n  if (this.hiddenMask.length > this.promptMask.length) {\n    keyValue = changeToLowerUpperCase.call(this, keyValue, this.element.value);\n  }\n\n  if (!isEqualVal) {\n    var value = this.element.value;\n    var elementValue = value.substring(0, startIndex) + keyValue + value.substring(startIndex + 1, value.length);\n    setElementValue.call(this, elementValue);\n    this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n  }\n}\n\nfunction preventUnsupportedValues(event, sIdx, idx, key, ctrl, chkSupport) {\n  if (!this.maskKeyPress) {\n    var eventOldVal = void 0;\n    var value = this.element.value;\n\n    if (sIdx >= this.promptMask.length) {\n      setElementValue.call(this, value.substring(0, sIdx));\n    } else {\n      if (idx === sIdx) {\n        setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx + 1, value.length));\n      } else {\n        if (this.promptMask.length === this.element.value.length) {\n          setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx, value.length));\n        } else {\n          setElementValue.call(this, value.substring(0, idx) + value.substring(idx + 1, value.length));\n        }\n      }\n\n      this.element.selectionStart = this.element.selectionEnd = chkSupport || this.element.value[idx] !== this.promptChar ? sIdx : idx;\n    }\n\n    eventOldVal = this.element.value;\n    addMaskErrorClass.call(this);\n  }\n\n  if (key.length === 1 && !ctrl && !isNullOrUndefined(event)) {\n    addMaskErrorClass.call(this);\n  }\n}\n\nfunction addMaskErrorClass() {\n  var _this = this;\n\n  var parentElement = this.element.parentNode;\n  var timer = 200;\n\n  if (parentElement.classList.contains(INPUTGROUP) || parentElement.classList.contains(FLOATINPUT)) {\n    addClass([parentElement], ERROR);\n  } else {\n    addClass([this.element], ERROR);\n  }\n\n  if (this.isIosInvalid === true) {\n    timer = 400;\n  }\n\n  attributes(this.element, {\n    'aria-invalid': 'true'\n  });\n  setTimeout(function () {\n    if (!_this.maskKeyPress) {\n      removeMaskError.call(_this);\n    }\n  }, timer);\n}\n\nfunction removeMaskError() {\n  var parentElement = this.element.parentNode;\n\n  if (!isNullOrUndefined(parentElement)) {\n    removeClass([parentElement], ERROR);\n  }\n\n  removeClass([this.element], ERROR);\n  attributes(this.element, {\n    'aria-invalid': 'false'\n  });\n}\n/**\n * @hidden\n * Validates user input using masking elements '<' , '>' and '|'.\n */\n\n\nfunction changeToLowerUpperCase(key, value) {\n  var promptMask;\n  var i;\n  var j = 0;\n  var curVal = value;\n  var caseCount = 0;\n\n  for (i = 0; i < this.hiddenMask.length; i++) {\n    if (this.hiddenMask[i] === '\\\\') {\n      promptMask = curVal.substring(0, i) + '\\\\' + curVal.substring(i, curVal.length);\n    }\n\n    if (this.hiddenMask[i] === '>' || this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|') {\n      if (this.hiddenMask[i] !== curVal[i]) {\n        promptMask = curVal.substring(0, i) + this.hiddenMask[i] + curVal.substring(i, curVal.length);\n      }\n\n      ++caseCount;\n    }\n\n    if (promptMask) {\n      if (promptMask[i] === this.promptChar && i > this.element.selectionStart || this.element.value.indexOf(this.promptChar) < 0 && this.element.selectionStart + caseCount === i) {\n        caseCount = 0;\n        break;\n      }\n\n      curVal = promptMask;\n    }\n  }\n\n  while (i >= 0 && promptMask) {\n    if (i === 0 || promptMask[i - 1] !== '\\\\') {\n      var val = this.element.value;\n\n      if (promptMask[i] === '>') {\n        key = key.toUpperCase();\n        break;\n      } else if (promptMask[i] === '<') {\n        key = key.toLowerCase();\n        break;\n      } else if (promptMask[i] === '|') {\n        break;\n      }\n    }\n\n    --i;\n  }\n\n  return key;\n}\n/**\n * @hidden\n * To set updated values in the MaskedTextBox.\n */\n\n\nexport function setMaskValue(val) {\n  if (this.mask && val !== undefined && (this.prevValue === undefined || this.prevValue !== val)) {\n    this.maskKeyPress = true;\n    setElementValue.call(this, this.promptMask);\n\n    if (val !== '' && !(val === null && this.floatLabelType === 'Never' && this.placeholder)) {\n      this.element.selectionStart = 0;\n      this.element.selectionEnd = 0;\n    }\n\n    if (val !== null) {\n      for (var i = 0; i < val.length; i++) {\n        validateValue.call(this, val[i], false, null);\n      }\n    }\n\n    var newVal = strippedValue.call(this, this.element);\n    this.prevValue = newVal;\n    this.value = newVal;\n    triggerMaskChangeEvent.call(this, null, null);\n    this.maskKeyPress = false;\n    var labelElement = this.element.parentNode.querySelector('.e-float-text');\n\n    if (this.element.value === this.promptMask && this.floatLabelType === 'Auto' && this.placeholder && !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL) && !this.isFocus) {\n      removeClass([labelElement], TOPLABEL);\n      addClass([labelElement], BOTTOMLABEL);\n      setElementValue.call(this, '');\n    }\n  }\n\n  if (this.mask === null || this.mask === '' && this.value !== undefined) {\n    setElementValue.call(this, this.value);\n  }\n}\n/**\n * @hidden\n * To set updated values in the input element.\n */\n\nexport function setElementValue(val, element) {\n  if (!this.isFocus && this.floatLabelType === 'Auto' && this.placeholder && isNullOrUndefined(this.value)) {\n    val = '';\n  }\n\n  var value = strippedValue.call(this, element ? element : this.element, val);\n\n  if (value === null || value === '') {\n    Input.setValue(val, element ? element : this.element, this.floatLabelType, false);\n\n    if (this.showClearButton) {\n      this.inputObj.clearButton.classList.add('e-clear-icon-hide');\n    }\n  } else {\n    Input.setValue(val, element ? element : this.element, this.floatLabelType, this.showClearButton);\n  }\n}\n/**\n * @hidden\n * Provide mask support to input textbox through utility method.\n */\n\nexport function maskInput(args) {\n  var inputEle = getMaskInput(args);\n  applyMask.call(inputEle);\n  var val = strippedValue.call(this, this.element);\n  this.prevValue = val;\n  this.value = val;\n\n  if (args.mask) {\n    unwireEvents.call(inputEle);\n    wireEvents.call(inputEle);\n  }\n}\n\nfunction getMaskInput(args) {\n  addClass([args.element], UTILMASK);\n  var inputEle = {\n    element: args.element,\n    mask: args.mask,\n    promptMask: '',\n    hiddenMask: '',\n    escapeMaskValue: '',\n    promptChar: args.promptChar ? args.promptChar.length > 1 ? args.promptChar = args.promptChar[0] : args.promptChar : '_',\n    value: args.value ? args.value : null,\n    regExpCollec: regularExpressions,\n    customRegExpCollec: [],\n    customCharacters: args.customCharacters,\n    undoCollec: [],\n    redoCollec: [],\n    maskKeyPress: false,\n    prevValue: ''\n  };\n  createMask.call(inputEle);\n  return inputEle;\n}\n/**\n * @hidden\n * Gets raw value of the textbox which has been masked through utility method.\n */\n\n\nexport function getVal(args) {\n  return strippedValue.call(getUtilMaskEle(args), args.element);\n}\n/**\n * @hidden\n * Gets masked value of the textbox which has been masked through utility method.\n */\n\nexport function getMaskedVal(args) {\n  return unstrippedValue.call(getUtilMaskEle(args), args.element);\n}\n\nfunction getUtilMaskEle(args) {\n  var value = '';\n  var inputEle;\n\n  if (!isNullOrUndefined(args) && args.element.classList.contains(UTILMASK)) {\n    inputEle = getMaskInput(args);\n  }\n\n  return inputEle;\n}\n/**\n * @hidden\n * Arguments to perform undo and redo functionalities.\n */\n\n\nvar MaskUndo =\n/** @class */\nfunction () {\n  function MaskUndo() {}\n\n  return MaskUndo;\n}();\n\nexport { MaskUndo };\nvar maskUndo = new MaskUndo();","map":{"version":3,"names":["EventHandler","isNullOrUndefined","merge","attributes","addClass","removeClass","Browser","extend","Input","ERROR","INPUTGROUP","FLOATINPUT","UTILMASK","TOPLABEL","BOTTOMLABEL","regularExpressions","createMask","element","mask","splitMask","split","i","length","splitInnerMask","j","pushIntoRegExpCollec","call","chkSpace","customRegExpCollec","push","hiddenMask","promptChar","escapeMaskValue","promptMask","replace","customCharacters","RegExp","escapeNumber","match","substring","applyMask","setElementValue","setMaskValue","value","wireEvents","add","maskInputKeyDownHandler","maskInputKeyPressHandler","maskInputKeyUpHandler","maskInputHandler","maskInputFocusHandler","maskInputBlurHandler","maskInputPasteHandler","maskInputCutHandler","maskInputDropHandler","enabled","bindClearEvent","formElement","resetFormHandler","unwireEvents","remove","showClearButton","inputObj","clearButton","resetHandler","e","preventDefault","classList","contains","clear","event","redoCollec","unshift","startIndex","selectionStart","endIndex","selectionEnd","triggerMaskChangeEvent","setSelectionRange","tagName","initInputValue","unstrippedValue","strippedValue","maskValues","k","checkMask","maskValue","_callPasteHandler","regExpCollec","undefined","_this","eventArgs","maskedValue","container","trigger","isFocus","isDevice","info","version","delay","isIos","setTimeout","blurEventArgs","placeholder","floatLabelType","labelElement","parentNode","querySelector","readonly","sIndex_1","eIndex_1","oldValue_1","maskKeyPress","validateValue","i_1","preValue_1","sIndex_2","eIndex","undoCollec","value_1","isIE","ctrlKey","keyCode","removeMaskInputValues","addedValues","preEleVal","val","prevValue","startValue","collec","splice","mobileRemoveFunction","sIndex","autoFillMaskInputValues","isRemove","oldEventVal","type","isDeleted","initStartIndex","initEndIndex","curMask","parentElement","deleteEndIndex","multipleDel","preValue","index","oldValue","prompt_1","elementValue","code","key","String","fromCharCode","isIosInvalid","prevOnChange","isProtectedOnChange","changeEventArgs","isInitial","isInteraction","isInteracted","isAngular","preventChange","val_1","startIndex_1","oldVal","trim","isSpace","isAndroid","preventUnsupportedValues","removeMaskError","temp_1","mobileSwipeCheck","mobileValidation","isCtrlKey","allowText","eventOldVal","prevSupport","isEqualVal","keyValue","customValStr","customValArr","applySupportedValues","addMaskErrorClass","changeToLowerUpperCase","sIdx","idx","ctrl","chkSupport","timer","curVal","caseCount","indexOf","toUpperCase","toLowerCase","newVal","setValue","maskInput","args","inputEle","getMaskInput","getVal","getUtilMaskEle","getMaskedVal","MaskUndo","maskUndo"],"sources":["D:/Theme/package/node_modules/@syncfusion/ej2-inputs/src/maskedtextbox/base/mask-base.js"],"sourcesContent":["/**\n * MaskedTextBox base module\n */\nimport { EventHandler, isNullOrUndefined, merge, attributes, addClass, removeClass, Browser, extend } from '@syncfusion/ej2-base';\nimport { Input } from '../../input/input';\nvar ERROR = 'e-error';\nvar INPUTGROUP = 'e-input-group';\nvar FLOATINPUT = 'e-float-input';\nvar UTILMASK = 'e-utility-mask';\nvar TOPLABEL = 'e-label-top';\nvar BOTTOMLABEL = 'e-label-bottom';\n/**\n * @hidden\n * Built-in masking elements collection.\n */\nexport var regularExpressions = {\n    '0': '[0-9]',\n    '9': '[0-9 ]',\n    '#': '[0-9 +-]',\n    'L': '[A-Za-z]',\n    '?': '[A-Za-z ]',\n    '&': '[^\\x7f ]+',\n    'C': '[^\\x7f]+',\n    'A': '[A-Za-z0-9]',\n    'a': '[A-Za-z0-9 ]',\n};\n/**\n * @hidden\n * Generate required masking elements to the MaskedTextBox from user mask input.\n */\nexport function createMask() {\n    attributes(this.element, {\n        'role': 'textbox', 'autocomplete': 'off', 'autocorrect': 'off', 'autocapitalize': 'off',\n        'spellcheck': 'false', 'aria-live': 'assertive', 'aria-valuenow': ''\n    });\n    if (this.mask) {\n        var splitMask = this.mask.split(']');\n        for (var i = 0; i < splitMask.length; i++) {\n            if (splitMask[i][splitMask[i].length - 1] === '\\\\') {\n                splitMask[i] = splitMask[i] + ']';\n                var splitInnerMask = splitMask[i].split('[');\n                for (var j = 0; j < splitInnerMask.length; j++) {\n                    if (splitInnerMask[j][splitInnerMask[j].length - 1] === '\\\\') {\n                        splitInnerMask[j] = splitInnerMask[j] + '[';\n                    }\n                    pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n                }\n            }\n            else {\n                var splitInnerMask = splitMask[i].split('[');\n                if (splitInnerMask.length > 1) {\n                    var chkSpace = false;\n                    for (var j = 0; j < splitInnerMask.length; j++) {\n                        if (splitInnerMask[j] === '\\\\') {\n                            this.customRegExpCollec.push('[');\n                            this.hiddenMask += splitInnerMask[j] + '[';\n                        }\n                        else if (splitInnerMask[j] === '') {\n                            chkSpace = true;\n                        }\n                        else if ((splitInnerMask[j] !== '' && chkSpace) || j === splitInnerMask.length - 1) {\n                            this.customRegExpCollec.push('[' + splitInnerMask[j] + ']');\n                            this.hiddenMask += this.promptChar;\n                            chkSpace = false;\n                        }\n                        else {\n                            pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n                        }\n                    }\n                }\n                else {\n                    pushIntoRegExpCollec.call(this, splitInnerMask[0]);\n                }\n            }\n        }\n        this.escapeMaskValue = this.hiddenMask;\n        this.promptMask = this.hiddenMask.replace(/[09?LCAa#&]/g, this.promptChar);\n        if (!isNullOrUndefined(this.customCharacters)) {\n            for (var i = 0; i < this.promptMask.length; i++) {\n                if (!isNullOrUndefined(this.customCharacters[this.promptMask[i]])) {\n                    this.promptMask = this.promptMask.replace(new RegExp(this.promptMask[i], 'g'), this.promptChar);\n                }\n            }\n        }\n        var escapeNumber = 0;\n        if (this.hiddenMask.match(new RegExp(/\\\\/))) {\n            for (var i = 0; i < this.hiddenMask.length; i++) {\n                var j = 0;\n                if (i >= 1) {\n                    j = i;\n                }\n                escapeNumber = this.hiddenMask.length - this.promptMask.length;\n                j = j - escapeNumber;\n                if ((i > 0 && this.hiddenMask[i - 1] !== '\\\\') && (this.hiddenMask[i] === '>' ||\n                    this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|')) {\n                    this.promptMask = this.promptMask.substring(0, j) +\n                        this.promptMask.substring((i + 1) - escapeNumber, this.promptMask.length);\n                    this.escapeMaskValue = this.escapeMaskValue.substring(0, j) +\n                        this.escapeMaskValue.substring((i + 1) - escapeNumber, this.escapeMaskValue.length);\n                }\n                if (this.hiddenMask[i] === '\\\\') {\n                    this.promptMask = this.promptMask.substring(0, j) + this.hiddenMask[i + 1] +\n                        this.promptMask.substring((i + 2) - escapeNumber, this.promptMask.length);\n                    this.escapeMaskValue = this.escapeMaskValue.substring(0, j) + this.escapeMaskValue[i + 1] +\n                        this.escapeMaskValue.substring((i + 2) - escapeNumber, this.escapeMaskValue.length);\n                }\n            }\n        }\n        else {\n            this.promptMask = this.promptMask.replace(/[>|<]/g, '');\n            this.escapeMaskValue = this.hiddenMask.replace(/[>|<]/g, '');\n        }\n        attributes(this.element, { 'aria-invalid': 'false' });\n    }\n}\n/**\n * @hidden\n * Apply mask ability with masking elements to the MaskedTextBox.\n */\nexport function applyMask() {\n    setElementValue.call(this, this.promptMask);\n    setMaskValue.call(this, this.value);\n}\n/**\n * @hidden\n * To wire required events to the MaskedTextBox.\n */\nexport function wireEvents() {\n    EventHandler.add(this.element, 'keydown', maskInputKeyDownHandler, this);\n    EventHandler.add(this.element, 'keypress', maskInputKeyPressHandler, this);\n    EventHandler.add(this.element, 'keyup', maskInputKeyUpHandler, this);\n    EventHandler.add(this.element, 'input', maskInputHandler, this);\n    EventHandler.add(this.element, 'focus', maskInputFocusHandler, this);\n    EventHandler.add(this.element, 'blur', maskInputBlurHandler, this);\n    EventHandler.add(this.element, 'paste', maskInputPasteHandler, this);\n    EventHandler.add(this.element, 'cut', maskInputCutHandler, this);\n    EventHandler.add(this.element, 'drop', maskInputDropHandler, this);\n    if (this.enabled) {\n        bindClearEvent.call(this);\n        if (this.formElement) {\n            EventHandler.add(this.formElement, 'reset', resetFormHandler, this);\n        }\n    }\n}\n/**\n * @hidden\n * To unwire events attached to the MaskedTextBox.\n */\nexport function unwireEvents() {\n    EventHandler.remove(this.element, 'keydown', maskInputKeyDownHandler);\n    EventHandler.remove(this.element, 'keypress', maskInputKeyPressHandler);\n    EventHandler.remove(this.element, 'keyup', maskInputKeyUpHandler);\n    EventHandler.remove(this.element, 'input', maskInputHandler);\n    EventHandler.remove(this.element, 'focus', maskInputFocusHandler);\n    EventHandler.remove(this.element, 'blur', maskInputBlurHandler);\n    EventHandler.remove(this.element, 'paste', maskInputPasteHandler);\n    EventHandler.remove(this.element, 'cut', maskInputCutHandler);\n    if (this.formElement) {\n        EventHandler.remove(this.formElement, 'reset', resetFormHandler);\n    }\n}\n/**\n * @hidden\n * To bind required events to the MaskedTextBox clearButton.\n */\nexport function bindClearEvent() {\n    if (this.showClearButton) {\n        EventHandler.add(this.inputObj.clearButton, 'mousedown touchstart', resetHandler, this);\n    }\n}\nfunction resetHandler(e) {\n    e.preventDefault();\n    if (!this.inputObj.clearButton.classList.contains('e-clear-icon-hide')) {\n        clear.call(this, e);\n        this.value = '';\n    }\n}\nfunction clear(event) {\n    var value = this.element.value;\n    setElementValue.call(this, this.promptMask);\n    this.redoCollec.unshift({\n        value: this.promptMask, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n    });\n    triggerMaskChangeEvent.call(this, event, value);\n    this.element.setSelectionRange(0, 0);\n}\nfunction resetFormHandler() {\n    if (this.element.tagName === 'EJS-MASKEDTEXTBOX') {\n        setElementValue.call(this, this.promptMask);\n    }\n    else {\n        this.value = this.initInputValue;\n    }\n}\n/**\n * @hidden\n * To get masked value from the MaskedTextBox.\n */\nexport function unstrippedValue(element) {\n    return element.value;\n}\n/**\n * @hidden\n * To extract raw value from the MaskedTextBox.\n */\nexport function strippedValue(element, maskValues) {\n    var value = '';\n    var k = 0;\n    var checkMask = false;\n    var maskValue = (!isNullOrUndefined(maskValues)) ? maskValues : (!isNullOrUndefined(element) &&\n        !isNullOrUndefined(this)) ? element.value : maskValues;\n    if (maskValue !== this.promptMask) {\n        for (var i = 0; i < this.customRegExpCollec.length; i++) {\n            if (checkMask) {\n                checkMask = false;\n            }\n            if (this.customRegExpCollec[k] === '>' || this.customRegExpCollec[k] === '<' ||\n                this.customRegExpCollec[k] === '|' || this.customRegExpCollec[k] === '\\\\') {\n                --i;\n                checkMask = true;\n            }\n            if (!checkMask) {\n                if ((maskValue[i] !== this.promptChar) && (!isNullOrUndefined(this.customRegExpCollec[k]) &&\n                    ((this._callPasteHandler || !isNullOrUndefined(this.regExpCollec[this.customRegExpCollec[k]])) ||\n                        (this.customRegExpCollec[k].length > 2 && this.customRegExpCollec[k][0] === '[' &&\n                            this.customRegExpCollec[k][this.customRegExpCollec[k].length - 1] === ']') ||\n                        (!isNullOrUndefined(this.customCharacters) &&\n                            (!isNullOrUndefined(this.customCharacters[this.customRegExpCollec[k]]))))) && (maskValue !== '')) {\n                    value += maskValue[i];\n                }\n            }\n            ++k;\n        }\n    }\n    if (this.mask === null || this.mask === '' && this.value !== undefined) {\n        value = maskValue;\n    }\n    return value;\n}\nfunction pushIntoRegExpCollec(value) {\n    for (var k = 0; k < value.length; k++) {\n        this.hiddenMask += value[k];\n        if (value[k] !== '\\\\') {\n            this.customRegExpCollec.push(value[k]);\n        }\n    }\n}\nexport function maskInputFocusHandler(event) {\n    var _this = this;\n    var eventArgs = {\n        selectionStart: 0,\n        event: event,\n        value: this.value,\n        maskedValue: this.element.value,\n        container: this.inputObj.container,\n        selectionEnd: (this.promptMask.length > 0) ? this.promptMask.length : this.element.value.length,\n    };\n    this.trigger('focus', eventArgs, function (eventArgs) {\n        if (_this.mask) {\n            _this.isFocus = true;\n            if (_this.element.value === '') {\n                setElementValue.call(_this, _this.promptMask);\n            }\n            else {\n                setElementValue.call(_this, _this.element.value);\n            }\n            if (!Browser.isDevice && Browser.info.version === '11.0') {\n                _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n            }\n            else {\n                var delay = (Browser.isDevice && Browser.isIos) ? 450 : 0;\n                setTimeout(function () {\n                    _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n                }, delay);\n            }\n        }\n    });\n}\nexport function maskInputBlurHandler(event) {\n    this.blurEventArgs = {\n        event: event,\n        value: this.value,\n        maskedValue: this.element.value,\n        container: this.inputObj.container\n    };\n    this.trigger('blur', this.blurEventArgs);\n    if (this.mask) {\n        this.isFocus = false;\n        if (this.placeholder && this.element.value === this.promptMask && this.floatLabelType !== 'Always') {\n            setElementValue.call(this, '');\n            var labelElement = this.element.parentNode.querySelector('.e-float-text');\n            if (this.floatLabelType === 'Auto' && !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL)) {\n                removeClass([labelElement], TOPLABEL);\n            }\n        }\n    }\n}\nfunction maskInputPasteHandler(event) {\n    var _this = this;\n    if (this.mask && !this.readonly) {\n        var sIndex_1 = this.element.selectionStart;\n        var eIndex_1 = this.element.selectionEnd;\n        var oldValue_1 = this.element.value;\n        setElementValue.call(this, '');\n        this._callPasteHandler = true;\n        setTimeout(function () {\n            var value = _this.element.value.replace(/ /g, '');\n            if (_this.redoCollec.length > 0 && _this.redoCollec[0].value === _this.element.value) {\n                value = strippedValue.call(_this, _this.element);\n            }\n            setElementValue.call(_this, oldValue_1);\n            _this.element.selectionStart = sIndex_1;\n            _this.element.selectionEnd = eIndex_1;\n            var i = 0;\n            _this.maskKeyPress = true;\n            do {\n                validateValue.call(_this, value[i], false, null);\n                ++i;\n            } while (i < value.length);\n            _this.maskKeyPress = false;\n            _this._callPasteHandler = false;\n            if (_this.element.value === oldValue_1) {\n                var i_1 = 0;\n                _this.maskKeyPress = true;\n                do {\n                    validateValue.call(_this, value[i_1], false, null);\n                    ++i_1;\n                } while (i_1 < value.length);\n                _this.maskKeyPress = false;\n            }\n            else {\n                triggerMaskChangeEvent.call(_this, event, oldValue_1);\n            }\n        }, 1);\n    }\n}\nfunction maskInputCutHandler(event) {\n    var _this = this;\n    if (this.mask && !this.readonly) {\n        var preValue_1 = this.element.value;\n        var sIndex_2 = this.element.selectionStart;\n        var eIndex = this.element.selectionEnd;\n        this.undoCollec.push({ value: this.element.value, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd });\n        var value_1 = this.element.value.substring(0, sIndex_2) + this.promptMask.substring(sIndex_2, eIndex) +\n            this.element.value.substring(eIndex);\n        setTimeout(function () {\n            setElementValue.call(_this, value_1);\n            _this.element.selectionStart = _this.element.selectionEnd = sIndex_2;\n            if (_this.element.value !== preValue_1) {\n                triggerMaskChangeEvent.call(_this, event, null);\n            }\n        }, 0);\n    }\n}\nexport function maskInputDropHandler(event) {\n    event.preventDefault();\n}\nfunction maskInputHandler(event) {\n    if (Browser.isIE === true && this.element.value === '' && this.floatLabelType === 'Never') {\n        return;\n    }\n    var eventArgs = { ctrlKey: false, keyCode: 229 };\n    // tslint:disable-next-line\n    extend(event, eventArgs);\n    if (this.mask) {\n        if (this.element.value === '') {\n            this.redoCollec.unshift({\n                value: this.promptMask, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n            });\n        }\n        if (this.element.value.length === 1) {\n            this.element.value = this.element.value + this.promptMask;\n            this.element.setSelectionRange(1, 1);\n        }\n        if (!this._callPasteHandler) {\n            removeMaskInputValues.call(this, event);\n        }\n        if (this.element.value.length > this.promptMask.length) {\n            var startIndex = this.element.selectionStart;\n            var addedValues = this.element.value.length - this.promptMask.length;\n            var value = this.element.value.substring(startIndex - addedValues, startIndex);\n            this.maskKeyPress = false;\n            var i = 0;\n            do {\n                validateValue.call(this, value[i], event.ctrlKey, event);\n                ++i;\n            } while (i < value.length);\n            if (this.element.value !== this.preEleVal) {\n                triggerMaskChangeEvent.call(this, event, null);\n            }\n        }\n        var val = strippedValue.call(this, this.element);\n        this.prevValue = val;\n        this.value = val;\n        if (val === '') {\n            setElementValue.call(this, this.promptMask);\n            this.element.setSelectionRange(0, 0);\n        }\n    }\n}\nfunction maskInputKeyDownHandler(event) {\n    if (this.mask && !this.readonly) {\n        var value = this;\n        if (event.keyCode !== 229) {\n            if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n                event.preventDefault();\n            }\n            removeMaskInputValues.call(this, event);\n        }\n        var startValue = this.element.value;\n        if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n            var collec = void 0;\n            if (event.keyCode === 90 && this.undoCollec.length > 0 && startValue !== this.undoCollec[this.undoCollec.length - 1].value) {\n                collec = this.undoCollec[this.undoCollec.length - 1];\n                this.redoCollec.unshift({\n                    value: this.element.value, startIndex: this.element.selectionStart,\n                    endIndex: this.element.selectionEnd\n                });\n                setElementValue.call(this, collec.value);\n                this.element.selectionStart = collec.startIndex;\n                this.element.selectionEnd = collec.endIndex;\n                this.undoCollec.splice(this.undoCollec.length - 1, 1);\n            }\n            else if (event.keyCode === 89 && this.redoCollec.length > 0 && startValue !== this.redoCollec[0].value) {\n                collec = this.redoCollec[0];\n                this.undoCollec.push({\n                    value: this.element.value, startIndex: this.element.selectionStart,\n                    endIndex: this.element.selectionEnd\n                });\n                setElementValue.call(this, collec.value);\n                this.element.selectionStart = collec.startIndex;\n                this.element.selectionEnd = collec.endIndex;\n                this.redoCollec.splice(0, 1);\n            }\n        }\n    }\n}\nexport function mobileRemoveFunction() {\n    var collec;\n    var sIndex = this.element.selectionStart;\n    var eIndex = this.element.selectionEnd;\n    if (this.redoCollec.length > 0) {\n        collec = this.redoCollec[0];\n        setElementValue.call(this, collec.value);\n        if ((collec.startIndex - sIndex) === 1) {\n            this.element.selectionStart = collec.startIndex;\n            this.element.selectionEnd = collec.endIndex;\n        }\n        else {\n            this.element.selectionStart = sIndex + 1;\n            this.element.selectionEnd = eIndex + 1;\n        }\n    }\n    else {\n        setElementValue.call(this, this.promptMask);\n        this.element.selectionStart = this.element.selectionEnd = sIndex;\n    }\n}\nfunction autoFillMaskInputValues(isRemove, oldEventVal, event) {\n    if (event.type === 'input') {\n        isRemove = false;\n        oldEventVal = this.element.value;\n        setElementValue.call(this, this.promptMask);\n        setMaskValue.call(this, oldEventVal);\n    }\n    return isRemove;\n}\nfunction removeMaskInputValues(event) {\n    var isRemove = false;\n    var oldEventVal;\n    var isDeleted = false;\n    if (this.element.value.length < this.promptMask.length) {\n        isRemove = true;\n        oldEventVal = this.element.value;\n        isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n        mobileRemoveFunction.call(this);\n    }\n    if (this.element.value.length >= this.promptMask.length && event.type === 'input') {\n        isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n    }\n    var initStartIndex = this.element.selectionStart;\n    var initEndIndex = this.element.selectionEnd;\n    var startIndex = this.element.selectionStart;\n    var endIndex = this.element.selectionEnd;\n    var maskValue = this.hiddenMask.replace(/[>|\\\\<]/g, '');\n    var curMask = maskValue[startIndex - 1];\n    var parentElement = this.element.parentNode;\n    var deleteEndIndex = this.element.selectionEnd;\n    if (isRemove || event.keyCode === 8 || event.keyCode === 46) {\n        this.undoCollec.push({ value: this.element.value, startIndex: this.element.selectionStart, endIndex: endIndex });\n        var multipleDel = false;\n        var preValue = this.element.value;\n        if (startIndex > 0 || ((event.keyCode === 8 || event.keyCode === 46) && startIndex < this.element.value.length\n            && ((this.element.selectionEnd - startIndex) !== this.element.value.length))) {\n            var index = startIndex;\n            if (startIndex !== endIndex) {\n                startIndex = endIndex;\n                if (event.keyCode === 46) {\n                    multipleDel = true;\n                }\n            }\n            else if (event.keyCode === 46) {\n                ++index;\n            }\n            else {\n                --index;\n            }\n            for (var k = startIndex; (event.keyCode === 8 || isRemove || multipleDel) ? k > index : k < index; (event.keyCode === 8 || isRemove || multipleDel) ? k-- : k++) {\n                for (var i = startIndex; (event.keyCode === 8 || isRemove || multipleDel) ? i > 0 : i < this.element.value.length; (event.keyCode === 8 || isRemove || multipleDel) ? i-- : i++) {\n                    var sIndex = void 0;\n                    if (((event.keyCode === 8 || multipleDel) && ((initStartIndex !== initEndIndex && initStartIndex !== startIndex) ||\n                        (initStartIndex === initEndIndex))) || isRemove) {\n                        curMask = maskValue[i - 1];\n                        sIndex = startIndex - 1;\n                    }\n                    else {\n                        curMask = maskValue[i];\n                        sIndex = startIndex;\n                        ++startIndex;\n                    }\n                    var oldValue = this.element.value[sIndex];\n                    if ((isNullOrUndefined(this.regExpCollec[curMask]) && (!isNullOrUndefined(this.customCharacters)\n                        && isNullOrUndefined(this.customCharacters[curMask]))\n                        && ((this.hiddenMask[sIndex] !== this.promptChar && this.customRegExpCollec[sIndex][0] !== '['\n                            && this.customRegExpCollec[sIndex][this.customRegExpCollec[sIndex].length - 1] !== ']')))\n                        || (this.promptMask[sIndex] !== this.promptChar && isNullOrUndefined(this.customCharacters))) {\n                        this.element.selectionStart = this.element.selectionEnd = sIndex;\n                        event.preventDefault();\n                        if (event.keyCode === 46 && !multipleDel) {\n                            ++this.element.selectionStart;\n                        }\n                    }\n                    else {\n                        var value = this.element.value;\n                        var prompt_1 = this.promptChar;\n                        var elementValue = value.substring(0, sIndex) + prompt_1 + value.substring(startIndex, value.length);\n                        setElementValue.call(this, elementValue);\n                        event.preventDefault();\n                        if (event.keyCode === 46 && !multipleDel) {\n                            sIndex++;\n                        }\n                        this.element.selectionStart = this.element.selectionEnd = sIndex;\n                        isDeleted = true;\n                    }\n                    startIndex = this.element.selectionStart;\n                    if ((!isDeleted && event.keyCode === 8) || multipleDel || (!isDeleted && !(event.keyCode === 46))) {\n                        sIndex = startIndex - 1;\n                    }\n                    else {\n                        sIndex = startIndex;\n                        isDeleted = false;\n                    }\n                    oldValue = this.element.value[sIndex];\n                    if (((initStartIndex !== initEndIndex) && (this.element.selectionStart === initStartIndex))\n                        || (this.promptMask[sIndex] === this.promptChar) || ((oldValue !== this.promptMask[sIndex]) &&\n                        (this.promptMask[sIndex] !== this.promptChar) && !isNullOrUndefined(this.customCharacters))) {\n                        break;\n                    }\n                }\n            }\n        }\n        if (event.keyCode === 46 && multipleDel && isDeleted) {\n            this.element.selectionStart = this.element.selectionEnd = deleteEndIndex;\n        }\n        if (this.element.selectionStart === 0 && (this.element.selectionEnd === this.element.value.length)) {\n            setElementValue.call(this, this.promptMask);\n            event.preventDefault();\n            this.element.selectionStart = this.element.selectionEnd = startIndex;\n        }\n        this.redoCollec.unshift({\n            value: this.element.value, startIndex: this.element.selectionStart,\n            endIndex: this.element.selectionEnd\n        });\n        if (this.element.value !== preValue) {\n            triggerMaskChangeEvent.call(this, event, oldEventVal);\n        }\n    }\n}\nfunction maskInputKeyPressHandler(event) {\n    if (this.mask && !this.readonly) {\n        var oldValue = this.element.value;\n        if ((!event.ctrlKey) || (event.ctrlKey && event.code !== 'KeyA' && event.code !== 'KeyY'\n            && event.code !== 'KeyZ' && event.code !== 'KeyX' && event.code !== 'KeyC' && event.code !== 'KeyV')) {\n            this.maskKeyPress = true;\n            var key = event.key;\n            if (key === 'Spacebar') {\n                key = String.fromCharCode(event.keyCode);\n            }\n            if (!key) {\n                this.isIosInvalid = true;\n                validateValue.call(this, String.fromCharCode(event.keyCode), event.ctrlKey, event);\n                event.preventDefault();\n                this.isIosInvalid = false;\n            }\n            else if (key && key.length === 1) {\n                validateValue.call(this, key, event.ctrlKey, event);\n                event.preventDefault();\n            }\n            if (event.keyCode === 32 && key === ' ' && this.promptChar === ' ') {\n                this.element.selectionStart = this.element.selectionEnd = this.element.selectionStart - key.length;\n            }\n        }\n        if (this.element.value !== oldValue) {\n            triggerMaskChangeEvent.call(this, event, oldValue);\n        }\n    }\n}\nfunction triggerMaskChangeEvent(event, oldValue) {\n    var prevOnChange = this.isProtectedOnChange;\n    if (!isNullOrUndefined(this.changeEventArgs) && !this.isInitial) {\n        var eventArgs = {};\n        this.changeEventArgs = { value: this.element.value, maskedValue: this.element.value, isInteraction: false, isInteracted: false };\n        if (this.mask) {\n            this.changeEventArgs.value = strippedValue.call(this, this.element);\n        }\n        if (!isNullOrUndefined(event)) {\n            this.changeEventArgs.isInteracted = true;\n            this.changeEventArgs.isInteraction = true;\n            this.changeEventArgs.event = event;\n        }\n        this.isProtectedOnChange = true;\n        this.value = this.changeEventArgs.value;\n        this.isProtectedOnChange = prevOnChange;\n        merge(eventArgs, this.changeEventArgs);\n        /* istanbul ignore next */\n        if (this.isAngular && this.preventChange) {\n            this.preventChange = false;\n        }\n        else {\n            this.trigger('change', eventArgs);\n        }\n    }\n    this.preEleVal = this.element.value;\n    this.prevValue = strippedValue.call(this, this.element);\n    attributes(this.element, { 'aria-valuenow': this.element.value });\n}\nfunction maskInputKeyUpHandler(event) {\n    if (this.mask && !this.readonly) {\n        var collec = void 0;\n        if (!this.maskKeyPress && event.keyCode === 229) {\n            var oldEventVal = void 0;\n            if (this.element.value.length === 1) {\n                this.element.value = this.element.value + this.promptMask;\n                this.element.setSelectionRange(1, 1);\n            }\n            if (this.element.value.length > this.promptMask.length) {\n                var startIndex = this.element.selectionStart;\n                var addedValues = this.element.value.length - this.promptMask.length;\n                var val_1 = this.element.value.substring(startIndex - addedValues, startIndex);\n                if (this.undoCollec.length > 0) {\n                    collec = this.undoCollec[this.undoCollec.length - 1];\n                    var startIndex_1 = this.element.selectionStart;\n                    oldEventVal = collec.value;\n                    var oldVal = collec.value.substring(startIndex_1 - addedValues, startIndex_1);\n                    collec = this.redoCollec[0];\n                    val_1 = val_1.trim();\n                    var isSpace = Browser.isAndroid && val_1 === '';\n                    if (!isSpace && oldVal !== val_1 && collec.value.substring(startIndex_1 - addedValues, startIndex_1) !== val_1) {\n                        validateValue.call(this, val_1, event.ctrlKey, event);\n                    }\n                    else if (isSpace) {\n                        preventUnsupportedValues.call(this, event, startIndex_1 - 1, this.element.selectionEnd - 1, val_1, event.ctrlKey, false);\n                    }\n                }\n                else {\n                    oldEventVal = this.promptMask;\n                    validateValue.call(this, val_1, event.ctrlKey, event);\n                }\n                this.maskKeyPress = false;\n                triggerMaskChangeEvent.call(this, event, oldEventVal);\n            }\n        }\n        else {\n            removeMaskError.call(this);\n        }\n        var val = strippedValue.call(this, this.element);\n        if (!((this.element.selectionStart === 0) && (this.promptMask === this.element.value) && val === '')\n            || (val === '' && this.value !== val)) {\n            this.prevValue = val;\n            this.value = val;\n        }\n    }\n    else {\n        triggerMaskChangeEvent.call(this, event);\n    }\n    if (this.element.selectionStart === 0 && this.element.selectionEnd === 0) {\n        // tslint:disable-next-line\n        var temp_1 = this.element;\n        setTimeout(function () {\n            temp_1.setSelectionRange(0, 0);\n        }, 0);\n    }\n}\nfunction mobileSwipeCheck(key) {\n    if (key.length > 1 && ((this.promptMask.length + key.length) < this.element.value.length)) {\n        var elementValue = this.redoCollec[0].value.substring(0, this.redoCollec[0].startIndex) + key +\n            this.redoCollec[0].value.substring(this.redoCollec[0].startIndex, this.redoCollec[0].value.length);\n        setElementValue.call(this, elementValue);\n        this.element.selectionStart = this.element.selectionEnd = this.redoCollec[0].startIndex + key.length;\n    }\n    this.element.selectionStart = this.element.selectionStart - key.length;\n    this.element.selectionEnd = this.element.selectionEnd - key.length;\n}\nfunction mobileValidation(key) {\n    if (!this.maskKeyPress) {\n        mobileSwipeCheck.call(this, key);\n    }\n}\nfunction validateValue(key, isCtrlKey, event) {\n    mobileValidation.call(this, key);\n    if (isNullOrUndefined(this) || isNullOrUndefined(key)) {\n        return;\n    }\n    var startIndex = this.element.selectionStart;\n    var initStartIndex = startIndex;\n    var endIndex = this.element.selectionEnd;\n    var curMask;\n    var allowText = false;\n    var value = this.element.value;\n    var eventOldVal;\n    var prevSupport = false;\n    var isEqualVal = false;\n    for (var k = 0; k < key.length; k++) {\n        var keyValue = key[k];\n        startIndex = this.element.selectionStart;\n        endIndex = this.element.selectionEnd;\n        if (!this.maskKeyPress && initStartIndex === startIndex) {\n            startIndex = startIndex + k;\n        }\n        if ((!this.maskKeyPress || startIndex < this.promptMask.length)) {\n            for (var i = startIndex; i < this.promptMask.length; i++) {\n                var maskValue = this.escapeMaskValue;\n                curMask = maskValue[startIndex];\n                if (this.hiddenMask[startIndex] === '\\\\' && this.hiddenMask[startIndex + 1] === key) {\n                    isEqualVal = true;\n                }\n                if ((isNullOrUndefined(this.regExpCollec[curMask]) && (isNullOrUndefined(this.customCharacters)\n                    || (!isNullOrUndefined(this.customCharacters) && isNullOrUndefined(this.customCharacters[curMask])))\n                    && ((this.hiddenMask[startIndex] !== this.promptChar && this.customRegExpCollec[startIndex][0] !== '['\n                        && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] !== ']')))\n                    || ((this.promptMask[startIndex] !== this.promptChar) && isNullOrUndefined(this.customCharacters))\n                    || (this.promptChar === curMask && this.escapeMaskValue === this.mask)) {\n                    this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n                    startIndex = this.element.selectionStart;\n                    curMask = this.hiddenMask[startIndex];\n                }\n            }\n            if (!isNullOrUndefined(this.customCharacters) && !isNullOrUndefined(this.customCharacters[curMask])) {\n                var customValStr = this.customCharacters[curMask];\n                var customValArr = customValStr.split(',');\n                for (var i = 0; i < customValArr.length; i++) {\n                    if (keyValue.match(new RegExp('[' + customValArr[i] + ']'))) {\n                        allowText = true;\n                        break;\n                    }\n                }\n            }\n            else if (!isNullOrUndefined(this.regExpCollec[curMask]) && keyValue.match(new RegExp(this.regExpCollec[curMask]))\n                && this.promptMask[startIndex] === this.promptChar) {\n                allowText = true;\n            }\n            else if (this.promptMask[startIndex] === this.promptChar && this.customRegExpCollec[startIndex][0] === '['\n                && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] === ']'\n                && keyValue.match(new RegExp(this.customRegExpCollec[startIndex]))) {\n                allowText = true;\n            }\n            if ((!this.maskKeyPress || startIndex < this.hiddenMask.length) && allowText) {\n                if (k === 0) {\n                    if (this.maskKeyPress) {\n                        this.undoCollec.push({ value: value, startIndex: startIndex, endIndex: startIndex });\n                    }\n                    else {\n                        var sIndex = this.element.selectionStart;\n                        var eIndex = this.element.selectionEnd;\n                        if (this.redoCollec.length > 0) {\n                            eventOldVal = this.redoCollec[0].value;\n                            setElementValue.call(this, eventOldVal);\n                            this.undoCollec.push(this.redoCollec[0]);\n                        }\n                        else {\n                            this.undoCollec.push({ value: this.promptMask, startIndex: startIndex, endIndex: startIndex });\n                            eventOldVal = this.promptMask;\n                            setElementValue.call(this, eventOldVal);\n                        }\n                        this.element.selectionStart = sIndex;\n                        this.element.selectionEnd = eIndex;\n                    }\n                }\n                startIndex = this.element.selectionStart;\n                applySupportedValues.call(this, event, startIndex, keyValue, eventOldVal, isEqualVal);\n                prevSupport = true;\n                if (k === key.length - 1) {\n                    this.redoCollec.unshift({\n                        value: this.element.value, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n                    });\n                }\n                allowText = false;\n            }\n            else {\n                startIndex = this.element.selectionStart;\n                preventUnsupportedValues.call(this, event, startIndex, initStartIndex, key, isCtrlKey, prevSupport);\n            }\n            if (k === key.length - 1 && !allowText) {\n                if (!Browser.isAndroid || (Browser.isAndroid && startIndex < this.promptMask.length)) {\n                    this.redoCollec.unshift({\n                        value: this.element.value, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n                    });\n                }\n            }\n        }\n        else {\n            if (key.length === 1 && !isCtrlKey && !isNullOrUndefined(event)) {\n                addMaskErrorClass.call(this);\n            }\n        }\n    }\n}\nfunction applySupportedValues(event, startIndex, keyValue, eventOldVal, isEqualVal) {\n    if (this.hiddenMask.length > this.promptMask.length) {\n        keyValue = changeToLowerUpperCase.call(this, keyValue, this.element.value);\n    }\n    if (!isEqualVal) {\n        var value = this.element.value;\n        var elementValue = value.substring(0, startIndex) + keyValue + value.substring(startIndex + 1, value.length);\n        setElementValue.call(this, elementValue);\n        this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n    }\n}\nfunction preventUnsupportedValues(event, sIdx, idx, key, ctrl, chkSupport) {\n    if (!this.maskKeyPress) {\n        var eventOldVal = void 0;\n        var value = this.element.value;\n        if (sIdx >= this.promptMask.length) {\n            setElementValue.call(this, value.substring(0, sIdx));\n        }\n        else {\n            if (idx === sIdx) {\n                setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx + 1, value.length));\n            }\n            else {\n                if (this.promptMask.length === this.element.value.length) {\n                    setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx, value.length));\n                }\n                else {\n                    setElementValue.call(this, value.substring(0, idx) + value.substring(idx + 1, value.length));\n                }\n            }\n            this.element.selectionStart = this.element.selectionEnd = (chkSupport ||\n                this.element.value[idx] !== this.promptChar) ? sIdx : idx;\n        }\n        eventOldVal = this.element.value;\n        addMaskErrorClass.call(this);\n    }\n    if (key.length === 1 && !ctrl && !isNullOrUndefined(event)) {\n        addMaskErrorClass.call(this);\n    }\n}\nfunction addMaskErrorClass() {\n    var _this = this;\n    var parentElement = this.element.parentNode;\n    var timer = 200;\n    if (parentElement.classList.contains(INPUTGROUP) || parentElement.classList.contains(FLOATINPUT)) {\n        addClass([parentElement], ERROR);\n    }\n    else {\n        addClass([this.element], ERROR);\n    }\n    if (this.isIosInvalid === true) {\n        timer = 400;\n    }\n    attributes(this.element, { 'aria-invalid': 'true' });\n    setTimeout(function () {\n        if (!_this.maskKeyPress) {\n            removeMaskError.call(_this);\n        }\n    }, timer);\n}\nfunction removeMaskError() {\n    var parentElement = this.element.parentNode;\n    if (!isNullOrUndefined(parentElement)) {\n        removeClass([parentElement], ERROR);\n    }\n    removeClass([this.element], ERROR);\n    attributes(this.element, { 'aria-invalid': 'false' });\n}\n/**\n * @hidden\n * Validates user input using masking elements '<' , '>' and '|'.\n */\nfunction changeToLowerUpperCase(key, value) {\n    var promptMask;\n    var i;\n    var j = 0;\n    var curVal = value;\n    var caseCount = 0;\n    for (i = 0; i < this.hiddenMask.length; i++) {\n        if (this.hiddenMask[i] === '\\\\') {\n            promptMask = curVal.substring(0, i) + '\\\\' + curVal.substring(i, curVal.length);\n        }\n        if (this.hiddenMask[i] === '>' || this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|') {\n            if (this.hiddenMask[i] !== curVal[i]) {\n                promptMask = curVal.substring(0, i) + this.hiddenMask[i] + curVal.substring(i, curVal.length);\n            }\n            ++caseCount;\n        }\n        if (promptMask) {\n            if (((promptMask[i] === this.promptChar) && (i > this.element.selectionStart)) ||\n                (this.element.value.indexOf(this.promptChar) < 0 && (this.element.selectionStart + caseCount) === i)) {\n                caseCount = 0;\n                break;\n            }\n            curVal = promptMask;\n        }\n    }\n    while (i >= 0 && promptMask) {\n        if (i === 0 || promptMask[i - 1] !== '\\\\') {\n            var val = this.element.value;\n            if (promptMask[i] === '>') {\n                key = key.toUpperCase();\n                break;\n            }\n            else if (promptMask[i] === '<') {\n                key = key.toLowerCase();\n                break;\n            }\n            else if (promptMask[i] === '|') {\n                break;\n            }\n        }\n        --i;\n    }\n    return key;\n}\n/**\n * @hidden\n * To set updated values in the MaskedTextBox.\n */\nexport function setMaskValue(val) {\n    if (this.mask && val !== undefined && (this.prevValue === undefined || this.prevValue !== val)) {\n        this.maskKeyPress = true;\n        setElementValue.call(this, this.promptMask);\n        if (val !== '' && !(val === null && this.floatLabelType === 'Never' && this.placeholder)) {\n            this.element.selectionStart = 0;\n            this.element.selectionEnd = 0;\n        }\n        if (val !== null) {\n            for (var i = 0; i < val.length; i++) {\n                validateValue.call(this, val[i], false, null);\n            }\n        }\n        var newVal = strippedValue.call(this, this.element);\n        this.prevValue = newVal;\n        this.value = newVal;\n        triggerMaskChangeEvent.call(this, null, null);\n        this.maskKeyPress = false;\n        var labelElement = this.element.parentNode.querySelector('.e-float-text');\n        if (this.element.value === this.promptMask && this.floatLabelType === 'Auto' && this.placeholder &&\n            !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL) && !this.isFocus) {\n            removeClass([labelElement], TOPLABEL);\n            addClass([labelElement], BOTTOMLABEL);\n            setElementValue.call(this, '');\n        }\n    }\n    if (this.mask === null || this.mask === '' && this.value !== undefined) {\n        setElementValue.call(this, this.value);\n    }\n}\n/**\n * @hidden\n * To set updated values in the input element.\n */\nexport function setElementValue(val, element) {\n    if (!this.isFocus && this.floatLabelType === 'Auto' && this.placeholder && isNullOrUndefined(this.value)) {\n        val = '';\n    }\n    var value = strippedValue.call(this, (element ? element : this.element), val);\n    if (value === null || value === '') {\n        Input.setValue(val, (element ? element : this.element), this.floatLabelType, false);\n        if (this.showClearButton) {\n            this.inputObj.clearButton.classList.add('e-clear-icon-hide');\n        }\n    }\n    else {\n        Input.setValue(val, (element ? element : this.element), this.floatLabelType, this.showClearButton);\n    }\n}\n/**\n * @hidden\n * Provide mask support to input textbox through utility method.\n */\nexport function maskInput(args) {\n    var inputEle = getMaskInput(args);\n    applyMask.call(inputEle);\n    var val = strippedValue.call(this, this.element);\n    this.prevValue = val;\n    this.value = val;\n    if (args.mask) {\n        unwireEvents.call(inputEle);\n        wireEvents.call(inputEle);\n    }\n}\nfunction getMaskInput(args) {\n    addClass([args.element], UTILMASK);\n    var inputEle = {\n        element: args.element,\n        mask: args.mask,\n        promptMask: '',\n        hiddenMask: '',\n        escapeMaskValue: '',\n        promptChar: args.promptChar ? (args.promptChar.length > 1) ? args.promptChar = args.promptChar[0]\n            : args.promptChar : '_',\n        value: args.value ? args.value : null,\n        regExpCollec: regularExpressions,\n        customRegExpCollec: [],\n        customCharacters: args.customCharacters,\n        undoCollec: [],\n        redoCollec: [],\n        maskKeyPress: false,\n        prevValue: ''\n    };\n    createMask.call(inputEle);\n    return inputEle;\n}\n/**\n * @hidden\n * Gets raw value of the textbox which has been masked through utility method.\n */\nexport function getVal(args) {\n    return strippedValue.call(getUtilMaskEle(args), args.element);\n}\n/**\n * @hidden\n * Gets masked value of the textbox which has been masked through utility method.\n */\nexport function getMaskedVal(args) {\n    return unstrippedValue.call(getUtilMaskEle(args), args.element);\n}\nfunction getUtilMaskEle(args) {\n    var value = '';\n    var inputEle;\n    if (!isNullOrUndefined(args) && args.element.classList.contains(UTILMASK)) {\n        inputEle = getMaskInput(args);\n    }\n    return inputEle;\n}\n/**\n * @hidden\n * Arguments to perform undo and redo functionalities.\n */\nvar MaskUndo = /** @class */ (function () {\n    function MaskUndo() {\n    }\n    return MaskUndo;\n}());\nexport { MaskUndo };\nvar maskUndo = new MaskUndo();\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}