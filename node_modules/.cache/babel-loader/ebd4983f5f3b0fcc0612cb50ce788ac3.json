{"ast":null,"code":"var Mexp = require('./lexer.js');\n\nMexp.prototype.toPostfix = function () {\n  'use strict';\n\n  var post = [],\n      elem,\n      popped,\n      prep,\n      pre,\n      ele;\n  var stack = [{\n    value: \"(\",\n    type: 4,\n    pre: 0\n  }];\n  var arr = this.value;\n\n  for (var i = 1; i < arr.length; i++) {\n    if (arr[i].type === 1 || arr[i].type === 3 || arr[i].type === 13) {\n      //if token is number,constant,or n(which is also a special constant in our case)\n      if (arr[i].type === 1) arr[i].value = Number(arr[i].value);\n      post.push(arr[i]);\n    } else if (arr[i].type === 4) {\n      stack.push(arr[i]);\n    } else if (arr[i].type === 5) {\n      while ((popped = stack.pop()).type !== 4) {\n        post.push(popped);\n      }\n    } else if (arr[i].type === 11) {\n      while ((popped = stack.pop()).type !== 4) {\n        post.push(popped);\n      }\n\n      stack.push(popped);\n    } else {\n      elem = arr[i];\n      pre = elem.pre;\n      ele = stack[stack.length - 1];\n      prep = ele.pre;\n      var flag = ele.value == 'Math.pow' && elem.value == 'Math.pow';\n      if (pre > prep) stack.push(elem);else {\n        while (prep >= pre && !flag || flag && pre < prep) {\n          popped = stack.pop();\n          ele = stack[stack.length - 1];\n          post.push(popped);\n          prep = ele.pre;\n          flag = elem.value == 'Math.pow' && ele.value == 'Math.pow';\n        }\n\n        stack.push(elem);\n      }\n    }\n  }\n\n  return new Mexp(post);\n};\n\nmodule.exports = Mexp;","map":{"version":3,"names":["Mexp","require","prototype","toPostfix","post","elem","popped","prep","pre","ele","stack","value","type","arr","i","length","Number","push","pop","flag","module","exports"],"sources":["D:/Theme/package/node_modules/math-expression-evaluator/src/postfix.js"],"sourcesContent":["\r\nvar Mexp = require('./lexer.js');\r\n\r\nMexp.prototype.toPostfix = function () {\r\n\t'use strict';\r\n\tvar post = [], elem, popped, prep, pre, ele;\r\n\tvar stack = [{ value: \"(\", type: 4, pre: 0 }];\r\n\tvar arr = this.value;\r\n\tfor (var i = 1; i < arr.length; i++) {\r\n\t\tif (arr[i].type === 1 || arr[i].type === 3 || arr[i].type === 13) {\t//if token is number,constant,or n(which is also a special constant in our case)\r\n\t\t\tif (arr[i].type === 1)\r\n\t\t\t\tarr[i].value = Number(arr[i].value);\r\n\t\t\tpost.push(arr[i]);\r\n\t\t}\r\n\t\telse if (arr[i].type === 4) {\r\n\t\t\tstack.push(arr[i]);\r\n\t\t}\r\n\t\telse if (arr[i].type === 5) {\r\n\t\t\twhile ((popped = stack.pop()).type !== 4) {\r\n\t\t\t\tpost.push(popped);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (arr[i].type === 11) {\r\n\t\t\twhile ((popped = stack.pop()).type !== 4) {\r\n\t\t\t\tpost.push(popped);\r\n\t\t\t}\r\n\t\t\tstack.push(popped);\r\n\t\t}\r\n\t\telse {\r\n\t\t\telem = arr[i];\r\n\t\t\tpre = elem.pre;\r\n\t\t\tele = stack[stack.length - 1];\r\n\t\t\tprep = ele.pre;\r\n\t\t\tvar flag = ele.value == 'Math.pow' && elem.value == 'Math.pow';\r\n\t\t\tif (pre > prep) stack.push(elem);\r\n\t\t\telse {\r\n\t\t\t\twhile (prep >= pre && !flag || flag && pre < prep) {\r\n\t\t\t\t\tpopped = stack.pop();\r\n\t\t\t\t\tele = stack[stack.length - 1];\r\n\t\t\t\t\tpost.push(popped);\r\n\t\t\t\t\tprep = ele.pre;\r\n\t\t\t\t\tflag = elem.value == 'Math.pow' && ele.value == 'Math.pow';\r\n\t\t\t\t}\r\n\t\t\t\tstack.push(elem);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn new Mexp(post);\r\n};\r\nmodule.exports = Mexp;"],"mappings":"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"},"metadata":{},"sourceType":"script"}