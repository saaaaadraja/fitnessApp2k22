{"ast":null,"code":"import { PdfArray } from './../primitives/pdf-array';\nimport { PdfReferenceHolder } from './../primitives/pdf-reference';\nimport { DictionaryProperties } from './../input-output/pdf-dictionary-properties';\nimport { SizeF, RectangleF, PointF } from './../drawing/pdf-drawing';\nimport { PdfStringLayouter } from './../graphics/fonts/string-layouter';\nimport { PdfColorSpace } from './../graphics/enum';\n/**\n * `PdfAnnotationCollection` class represents the collection of 'PdfAnnotation' objects.\n * @private\n */\n\nvar PdfAnnotationCollection =\n/** @class */\nfunction () {\n  function PdfAnnotationCollection(page) {\n    // Constants\n\n    /**\n     * `Error` constant message.\n     * @private\n     */\n    this.alreadyExistsAnnotationError = 'This annotatation had been already added to page';\n    /**\n     * `Error` constant message.\n     * @private\n     */\n\n    this.missingAnnotationException = 'Annotation is not contained in collection.';\n    /**\n     * Specifies the Internal variable to store fields of `PdfDictionaryProperties`.\n     * @private\n     */\n\n    this.dictionaryProperties = new DictionaryProperties();\n    /**\n     * Array of the `annotations`.\n     * @private\n     */\n\n    this.internalAnnotations = new PdfArray();\n    /**\n     * privte `list` for the annotations.\n     * @private\n     */\n\n    this.lists = [];\n\n    if (typeof page !== 'undefined') {\n      this.page = page;\n    }\n  }\n\n  Object.defineProperty(PdfAnnotationCollection.prototype, \"annotations\", {\n    /**\n     * Gets the `PdfAnnotation` object at the specified index. Read-Only.\n     * @private\n     */\n    get: function () {\n      return this.internalAnnotations;\n    },\n    set: function (value) {\n      this.internalAnnotations = value;\n    },\n    enumerable: true,\n    configurable: true\n  }); // Public methods\n\n  /**\n   * `Adds` a new annotation to the collection.\n   * @private\n   */\n\n  PdfAnnotationCollection.prototype.add = function (annotation) {\n    // this.SetPrint(annotation);\n    this.doAdd(annotation);\n  };\n  /**\n   * `Adds` a Annotation to collection.\n   * @private\n   */\n\n  /* tslint:disable */\n\n\n  PdfAnnotationCollection.prototype.doAdd = function (annotation) {\n    if (typeof annotation.destination !== 'undefined') {\n      var layout = new PdfStringLayouter();\n      var layoutResult = layout.layout(annotation.text, annotation.font, annotation.stringFormat, new SizeF(annotation.bounds.width, 0), false, new SizeF(0, 0));\n      var lastPosition = annotation.bounds.y;\n\n      if (layoutResult.lines.length === 1) {\n        var size = annotation.font.measureString(layoutResult.lines[0].text);\n        annotation.bounds = new RectangleF(new PointF(annotation.bounds.x, lastPosition), size);\n        annotation.text = layoutResult.lines[0].text; //Draw Annotation Text.\n\n        this.page.graphics.drawString(annotation.text, annotation.font, null, annotation.brush, annotation.bounds.x, annotation.bounds.y, annotation.bounds.width, annotation.bounds.height, null); //Add annotation to dictionary.\n\n        annotation.setPage(this.page);\n        this.setColor(annotation);\n        this.internalAnnotations.add(new PdfReferenceHolder(annotation));\n        this.lists.push(annotation);\n      } else {\n        for (var i = 0; i < layoutResult.lines.length; i++) {\n          var size = annotation.font.measureString(layoutResult.lines[i].text);\n\n          if (i === 0) {\n            annotation.bounds = new RectangleF(annotation.bounds.x, lastPosition, size.width, size.height);\n            annotation.text = layoutResult.lines[i].text; //Draw Annotation Text.\n\n            this.page.graphics.drawString(annotation.text, annotation.font, null, annotation.brush, annotation.bounds.x, lastPosition, size.width, size.height, null); //Add annotation to dictionary.\n\n            annotation.setPage(this.page);\n            this.setColor(annotation);\n            this.internalAnnotations.add(new PdfReferenceHolder(annotation));\n            this.lists.push(annotation); //Update y for drawing next line of the text.\n\n            lastPosition += annotation.bounds.height;\n          } else {\n            var annot = annotation.clone();\n            annot.bounds = new RectangleF(new PointF(annotation.bounds.x, lastPosition), size);\n            annot.text = layoutResult.lines[i].text; //Draw Annotation Text.\n\n            this.page.graphics.drawString(annot.text, annot.font, null, annot.brush, annot.bounds.x, annot.bounds.y, annot.bounds.width, annot.bounds.height, null); //Add annotation to dictionary.\n\n            annot.setPage(this.page);\n            this.setColor(annot);\n            this.internalAnnotations.add(new PdfReferenceHolder(annot));\n            this.lists.push(annot); //Update y for drawing next line of the text.\n\n            lastPosition += annot.bounds.height;\n          }\n        }\n      }\n    } else {\n      annotation.setPage(this.page);\n      this.internalAnnotations.add(new PdfReferenceHolder(annotation));\n      return this.lists.push(annotation);\n    }\n  };\n  /* tslint:enable */\n\n  /**\n   * `Set a color of an annotation`.\n   * @private\n   */\n\n\n  PdfAnnotationCollection.prototype.setColor = function (annotation) {\n    var cs = PdfColorSpace.Rgb;\n    var colours = annotation.color.toArray(cs);\n    annotation.dictionary.items.setValue(this.dictionaryProperties.c, colours);\n  };\n\n  Object.defineProperty(PdfAnnotationCollection.prototype, \"element\", {\n    // IPdfWrapper Members\n\n    /**\n     * Gets the `Element` representing this object.\n     * @private\n     */\n    get: function () {\n      return this.internalAnnotations;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return PdfAnnotationCollection;\n}();\n\nexport { PdfAnnotationCollection };","map":{"version":3,"names":["PdfArray","PdfReferenceHolder","DictionaryProperties","SizeF","RectangleF","PointF","PdfStringLayouter","PdfColorSpace","PdfAnnotationCollection","page","alreadyExistsAnnotationError","missingAnnotationException","dictionaryProperties","internalAnnotations","lists","Object","defineProperty","prototype","get","set","value","enumerable","configurable","add","annotation","doAdd","destination","layout","layoutResult","text","font","stringFormat","bounds","width","lastPosition","y","lines","length","size","measureString","x","graphics","drawString","brush","height","setPage","setColor","push","i","annot","clone","cs","Rgb","colours","color","toArray","dictionary","items","setValue","c"],"sources":["D:/Theme/package/node_modules/@syncfusion/ej2-pdf-export/src/implementation/annotations/annotation-collection.js"],"sourcesContent":["import { PdfArray } from './../primitives/pdf-array';\nimport { PdfReferenceHolder } from './../primitives/pdf-reference';\nimport { DictionaryProperties } from './../input-output/pdf-dictionary-properties';\nimport { SizeF, RectangleF, PointF } from './../drawing/pdf-drawing';\nimport { PdfStringLayouter } from './../graphics/fonts/string-layouter';\nimport { PdfColorSpace } from './../graphics/enum';\n/**\n * `PdfAnnotationCollection` class represents the collection of 'PdfAnnotation' objects.\n * @private\n */\nvar PdfAnnotationCollection = /** @class */ (function () {\n    function PdfAnnotationCollection(page) {\n        // Constants\n        /**\n         * `Error` constant message.\n         * @private\n         */\n        this.alreadyExistsAnnotationError = 'This annotatation had been already added to page';\n        /**\n         * `Error` constant message.\n         * @private\n         */\n        this.missingAnnotationException = 'Annotation is not contained in collection.';\n        /**\n         * Specifies the Internal variable to store fields of `PdfDictionaryProperties`.\n         * @private\n         */\n        this.dictionaryProperties = new DictionaryProperties();\n        /**\n         * Array of the `annotations`.\n         * @private\n         */\n        this.internalAnnotations = new PdfArray();\n        /**\n         * privte `list` for the annotations.\n         * @private\n         */\n        this.lists = [];\n        if (typeof page !== 'undefined') {\n            this.page = page;\n        }\n    }\n    Object.defineProperty(PdfAnnotationCollection.prototype, \"annotations\", {\n        /**\n         * Gets the `PdfAnnotation` object at the specified index. Read-Only.\n         * @private\n         */\n        get: function () {\n            return this.internalAnnotations;\n        },\n        set: function (value) {\n            this.internalAnnotations = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Public methods\n    /**\n     * `Adds` a new annotation to the collection.\n     * @private\n     */\n    PdfAnnotationCollection.prototype.add = function (annotation) {\n        // this.SetPrint(annotation);\n        this.doAdd(annotation);\n    };\n    /**\n     * `Adds` a Annotation to collection.\n     * @private\n     */\n    /* tslint:disable */\n    PdfAnnotationCollection.prototype.doAdd = function (annotation) {\n        if (typeof annotation.destination !== 'undefined') {\n            var layout = new PdfStringLayouter();\n            var layoutResult = layout.layout(annotation.text, annotation.font, annotation.stringFormat, new SizeF((annotation.bounds.width), 0), false, new SizeF(0, 0));\n            var lastPosition = annotation.bounds.y;\n            if (layoutResult.lines.length === 1) {\n                var size = annotation.font.measureString(layoutResult.lines[0].text);\n                annotation.bounds = new RectangleF(new PointF(annotation.bounds.x, lastPosition), size);\n                annotation.text = layoutResult.lines[0].text;\n                //Draw Annotation Text.\n                this.page.graphics.drawString(annotation.text, annotation.font, null, annotation.brush, annotation.bounds.x, annotation.bounds.y, annotation.bounds.width, annotation.bounds.height, null);\n                //Add annotation to dictionary.\n                annotation.setPage(this.page);\n                this.setColor(annotation);\n                this.internalAnnotations.add(new PdfReferenceHolder(annotation));\n                this.lists.push(annotation);\n            }\n            else {\n                for (var i = 0; i < layoutResult.lines.length; i++) {\n                    var size = annotation.font.measureString(layoutResult.lines[i].text);\n                    if (i === 0) {\n                        annotation.bounds = new RectangleF(annotation.bounds.x, lastPosition, size.width, size.height);\n                        annotation.text = layoutResult.lines[i].text;\n                        //Draw Annotation Text.\n                        this.page.graphics.drawString(annotation.text, annotation.font, null, annotation.brush, annotation.bounds.x, lastPosition, size.width, size.height, null);\n                        //Add annotation to dictionary.\n                        annotation.setPage(this.page);\n                        this.setColor(annotation);\n                        this.internalAnnotations.add(new PdfReferenceHolder(annotation));\n                        this.lists.push(annotation);\n                        //Update y for drawing next line of the text.\n                        lastPosition += annotation.bounds.height;\n                    }\n                    else {\n                        var annot = annotation.clone();\n                        annot.bounds = new RectangleF(new PointF(annotation.bounds.x, lastPosition), size);\n                        annot.text = layoutResult.lines[i].text;\n                        //Draw Annotation Text.\n                        this.page.graphics.drawString(annot.text, annot.font, null, annot.brush, annot.bounds.x, annot.bounds.y, annot.bounds.width, annot.bounds.height, null);\n                        //Add annotation to dictionary.\n                        annot.setPage(this.page);\n                        this.setColor(annot);\n                        this.internalAnnotations.add(new PdfReferenceHolder(annot));\n                        this.lists.push(annot);\n                        //Update y for drawing next line of the text.\n                        lastPosition += annot.bounds.height;\n                    }\n                }\n            }\n        }\n        else {\n            annotation.setPage(this.page);\n            this.internalAnnotations.add(new PdfReferenceHolder(annotation));\n            return this.lists.push(annotation);\n        }\n    };\n    /* tslint:enable */\n    /**\n     * `Set a color of an annotation`.\n     * @private\n     */\n    PdfAnnotationCollection.prototype.setColor = function (annotation) {\n        var cs = PdfColorSpace.Rgb;\n        var colours = annotation.color.toArray(cs);\n        annotation.dictionary.items.setValue(this.dictionaryProperties.c, colours);\n    };\n    Object.defineProperty(PdfAnnotationCollection.prototype, \"element\", {\n        // IPdfWrapper Members\n        /**\n         * Gets the `Element` representing this object.\n         * @private\n         */\n        get: function () {\n            return this.internalAnnotations;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return PdfAnnotationCollection;\n}());\nexport { PdfAnnotationCollection };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}